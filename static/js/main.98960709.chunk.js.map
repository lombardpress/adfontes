{"version":3,"sources":["actions/actions.jsx","vendor/behaviors.js","components/Search.jsx","components/Quotation.jsx","components/QuotationList.jsx","components/FocusedQuotation.jsx","components/CanonicalQuotation.jsx","components/CanonicalQuotationListItem.jsx","components/CanonicalQuotationList.jsx","components/ManifestationQuotationListItem.jsx","components/ManifestationQuotationList.jsx","components/Paragraph.jsx","components/BarChart.jsx","components/Images.jsx","components/FullText.jsx","components/TodoApp.js","components/Main.jsx","index.js","reducers/searchReducer.jsx","reducers/chartReducer.jsx","reducers/imagesReducer.jsx","reducers/quotationsReducer.jsx","reducers/focusedQuotationReducer.jsx","reducers/canonicalQuotationReducer.jsx","reducers/canonicalQuotationsReducer.jsx","reducers/manifestationQuotationsReducer.jsx","reducers/paragraphReducer.jsx","reducers/sourceParagraphReducer.jsx","reducers/fullTextReducer.jsx","store/configureStore.jsx","vendor/CETEI.js"],"names":["sparqlEndpoint","sourceUnion","subjectQueryTerm","objectQueryTerm","join","clearSearchParameters","type","setSearchParameters","searchParameters","startSearchWorksFetch","completeSearchWorksFetch","listOfWorks","fetchSearchWorksList","dispatch","getState","state","workGroupSparql","search","workGroup","expressionAuthorTypeSparql","expressionAuthorType","authorSparql","expressionAuthor","query","axios","get","params","then","res","searchWorks","data","results","bindings","map","result","expression","value","expressionShortId","expressionTitle","workGroupTitle","author","authorTitle","startQuotationAuthorsFetch","completeQuotationAuthorsFetch","authors","fetchQuotationAuthors","quotationAuthorTypeSparql","quotationAuthorType","quotationAuthorDateSparql","quotationAuthorDateAfter","quotationAuthorDateBefore","quotationAuthorDateAfterSparqlFilter","quotationAuthorDateBeforeSparqlFilter","authorShortId","startExpressionAuthorsFetch","completeExpressionAuthorsFetch","fetchExpressionAuthors","expressionAuthorDateSparql","expressionAuthorDateAfter","expressionAuthorDateBefore","expressionAuthorDateAfterSparqlFilter","expressionAuthorDateBeforeSparqlFilter","startQuotationWorksListFetch","completeQuotationWorksListFetch","quotationWorksList","fetchQuotationWorksList","quotationWorkGroupSparql","quotationWorkGroup","quotationAuthorSparql","quotationAuthor","startQuotationWorkPartsFetch","completeQuotationWorkPartsFetch","parts","fetchQuotationWorkParts","quotationWorkPart","quotationWork","grandparent","grandparent_title","parent","parent_title","child","child_title","startExpressionPartsFetch","completeExpressionPartsFetch","fetchExpressionParts","currentNode","expressionPart","expressionId","grandparent_level","parent_level","child_level","startQuotationExpressionTypeFetch","completeQuotationExpressionTypeFetch","quotationExpressionTypes","fetchQuotationExpressionTypes","quotationExpressionType","quotationExpressionTypeShortId","quotationExpressionTypeTitle","startExpressionTypeFetch","completeExpressionTypeFetch","expressionTypes","fetchExpressionTypes","expressionType","expressionTypeShortId","expressionTypeTitle","startWorkGroupsFetch","completeWorkGroupsFetch","workGroups","fetchWorkGroups","workGroupShortId","startAuthorTypesFetch","completeAuthorTypesFetch","authorTypes","fetchAuthorTypes","authorType","authorTypeShortId","authorTypeTitle","toggleGraphDisplay","current","startChartFetch","completeChartFetch","count","fetchChart","level","parseInt","expressionLevel","searchText","expressionWorkGroupSparql","expressionAuthorSparql","expressionAuthorCoreSparql","searchShortId","quotationAuthorCoreSparql","quotationWorkSparql","structureElementTypeSparql","structureElementType","ref","reftitle","toggleImagesDisplay","startImagesFetch","completeImagesFetch","images","fetchImages","paragraph","manifestation_id","url","addQuotations","quotations","clearQuotations","startQuotationsFetch","clearQuotationsFocus","completeQuotationsFetch","fetchQuotations","expressionIdSparql","quotationExpressionTypeSparql","expressionTypeSparql","changeQuotationsFocus","id","clearFocusedQuotation","createFocusedQuotation","quotation","createCanonicalQuotation","clearCanonicalQuotation","changeCanonicalQuotationsFocus","clearCanonicalQuotationsFocus","clearCanonicalQuotations","startCanonicalQuotationsFetch","completeCanonicalQuotationsFetch","canonicalQuotations","changeManifestationQuotationsFocus","clearManifestationQuotationsFocus","clearManifestationQuotations","startManifestationQuotationsFetch","completeManifestationQuotationsFetch","manifestationQuotations","fetchManifestationQuotations","undefined","focusedQuotation","clearParagraph","startParagraphFetch","completeParagraphFetch","fetchParagraph","quotationId","idType","hasXML","replace","res2","expression_id","manifestations","hasManifestations","hasDefaultManifestation","transcription_id","hasDefaultTranscription","transcription_item_file","hasDocument","paragraph_text","fetchReview","catch","err","console","log","startReviewFetch","completeReviewFetch","review","reviewUrl","clearSourceParagraph","startSourceParagraphFetch","completeSourceParagraphFetch","sourceParagraph","fetchSourceParagraph","source","startSourceParagraphReviewFetch","completeSourceParagraphReviewFetch","fetchSourceParagraphReview","toggleFullTextDisplay","clearFullText","startFullTextFetch","completeFullTextFetch","text","fetchFullText","xml_url","expression_item","manifestation_item","transcription_item","test","elt","content","Image","src","this","rw","getAttribute","hasAttribute","width","height","dl","document","createElement","Array","from","children","nodeType","Node","ELEMENT_NODE","localName","dt","innerHTML","appendChild","dd","table","firstElementChild","head","remove","caption","querySelectorAll","row","tr","attributes","attr","setAttribute","name","parentElement","replaceChild","cell","td","pre","serialize","module","exports","connect","require","actions","Search","props","handleSetSearchText","bind","handleOnShowQuotationsWithoutAssociation","handleRunQuery","handleGraph","handleClearFilters","e","refs","preventDefault","split","chart","visible","_this","displayWorkGroupsList","onSubmit","onClick","Group","Label","Control","as","onChange","placeholder","onBlur","quotationAuthors","work","quotationWorkParts","part","grandparentid","displayQuotationWorkPartsGrandparent","parentid","displayQuotationWorkPartsParent","childShortId","displayQuotationWorkParts","expressionAuthors","expressionParts","displayExpressionPartsGrandparent","displayExpressionPartsParent","displayExpressionParts","href","React","Component","Quotation","handleOnClick","isInstanceOf","newFocusedQuotationObject","canonicalQuotationObject","find","topPos","getElementById","offsetTop","$","animate","scrollTop","selfTopPos","alert","className","title","refText","citation","target","QuotationList","length","idx","quotationClass","includes","refType","classes","key","FocusedQuotation","CanonicalQuotation","canonicalQuotation","displayQuotation","displayQuotationId","CanonicalQuotationListItem","quotationObject","CanonicalQuotationList","fetchCanonicalQuotations","focused","ManifestationQuotationListItem","handleToggleShowImage","handleToggleShowCitation","handleImageWrapperWraperClick","imageSize","imageFocus","showImage","showCitation","setState","prevState","isManifestationOf","isManifestationOfObject","canonicalTranscription","newManifestations","manifestation","manifestationTitle","transcription","focusedManifestation","tresourceid","ManifestationQuotationList","alt","style","Paragraph","handleShowImages","handleShowFullText","runQueryForSource","addTEICustom","fullText","htmlText","cetei","makeHTML5","quoteid","pop","querySelector","childNodes","emptyTextNode","createTextNode","sourceId","transcription_id_expanded","constructor","m","showFullTextToggle","d3","BarChart","createBarChart","prevProps","selectAll","select","filter","d","i","countArray","margin","colors","scale","linear","domain","range","yScale","max","xScale","ordinal","rangeBands","tooltip","append","node","enter","rangeBand","on","transition","html","item","event","pageX","pageY","left","top","delay","duration","ease","vGuideScale","vAxis","svg","axis","orient","ticks","vGuide","fill","stroke","hAxis","tickValues","hGuide","Images","handleToggleImage","image","imageUrl","showImages","FullText","handleToggleFullText","textInfo","sourceid","TodoApp","quotationDisplay","size","barGraphDisplay","imagesDisplay","fullTextDisplay","Main","store","configure","subscribe","ReactDOM","render","searchReducer","action","chartReducer","imagesReducer","quotationsReducer","quotation_text","toplevel_expression_title","author_title","reverse","updatedState","focusedQuotationReducer","canonicalQuotationReducer","canonicalQuotationsReducer","manifestationQuotationsReducer","paragraphReducer","sourceParagraphReducer","fullTextReducer","redux","thunk","default","initialState","reducer","combineReducers","createStore","compose","applyMiddleware","window","devToolsExtension","f","behaviors","CETEI","base","els","hasStyle","prefixes","location","push","supportsShadowDom","createShadowRoot","attachShadow","TEI_url","callback","perElementFn","startsWith","indexOf","Promise","resolve","reject","client","XMLHttpRequest","open","send","onload","status","response","statusText","onerror","reason","TEI","TEI_dom","DOMParser","parseFromString","doc","domToHTML5","registerTEIElements","_fromTEI","dom","convertEl","el","newElement","copy","namespaceURI","tagName","importNode","att","rule","textContent","cloneNode","documentElement","registerElement","registerAll","fallback","done","getElementsByTagName","shadow","shadowCSS","bhvs","root_el","Set","getElementsByTagNameNS","x","add","strings","span","str","replacements","re","exec","call","ceteicean","_template","_insert","fn","isArray","decorator","self","_appendShadow","nodeName","_appendBasic","mode","addShadowStyle","hideContent","names","proto","Object","create","HTMLElement","prototype","getHandler","createdCallback","prefixedName","error","getFallback","match","urls","stripElt","PROCESSING_INSTRUCTION_NODE","nodeValue","COMMENT_NODE","hidden","localStorage","setItem","scrollY","getItem","scrollTo","unload","savePosition","load","restorePosition"],"mappings":"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","file":"static/js/main.98960709.chunk.js","sourcesContent":["import axios from 'axios';\n\nconst sparqlEndpoint = \"https://sparql-docker.scta.info/ds/query\"\n//const sparqlEndpoint = \"http://sparql-staging.scta.info/ds/query\"\n//const sparqlEndpoint = \"http://localhost:3030/ds/query\"\n\nconst sourceUnion = (subjectQueryTerm=\"?quotation\", objectQueryTerm=\"?source\") => {\n      return [\n        \"{\",\n         subjectQueryTerm + \" <http://scta.info/property/source> \" +  objectQueryTerm + \" .\",\n        \"FILTER (!isBlank(\" + objectQueryTerm + \")) .\",\n        \"}\",\n        \"UNION\",\n        \"{\",\n        subjectQueryTerm + \" <http://scta.info/property/source> ?bn .\",\n        \"?bn <http://scta.info/property/source> \" +  objectQueryTerm + \" .\",\n        \"}\"].join('');\n      }\n\n///search actions\n//===============\nexport var clearSearchParameters = () => {\n  return {\n    type: \"CLEAR_SEARCH_PARAMETERS\",\n  };\n};\nexport var setSearchParameters = (searchParameters) => {\n  return {\n    type: \"SET_SEARCH_PARAMETERS\",\n    searchParameters\n  };\n};\nexport var startSearchWorksFetch = () => {\n  return{\n    type: \"START_SEARCH_WORKS_FETCH\"\n  };\n};\nexport var completeSearchWorksFetch = (listOfWorks) => {\n  return{\n    type: \"COMPLETE_SEARCH_WORKS_FETCH\",\n    listOfWorks\n  };\n};\nexport var fetchSearchWorksList = () =>{\n  return (dispatch, getState) => {\n    var state = getState();\n    var workGroupSparql = \"\"\n    if (state.search.searchParameters.workGroup){\n      workGroupSparql = [\n      \"<http://scta.info/resource/\" + state.search.searchParameters.workGroup + \"> <http://scta.info/property/hasExpression> ?expression .\"\n      ].join('');\n    }\n    let expressionAuthorTypeSparql = \"\"\n    if (state.search.searchParameters.expressionAuthorType){\n      expressionAuthorTypeSparql = [\n      \"?expression <http://www.loc.gov/loc.terms/relators/AUT> ?expressionAuthor . \",\n      \"?expressionAuthor <http://scta.info/property/personType> <http://scta.info/resource/\" + state.search.searchParameters.expressionAuthorType + \"> .\"\n      ].join('');\n    }\n\n    var authorSparql = \"\"\n    if (state.search.searchParameters.expressionAuthor){\n      authorSparql = [\n      \"?expression <http://www.loc.gov/loc.terms/relators/AUT> <http://scta.info/resource/\" + state.search.searchParameters.expressionAuthor + \"> .\"\n      ].join('');\n    }\n    var query = [\n        \"SELECT ?type ?expression ?expressionShortId ?expressionTitle ?author ?authorTitle ?workGroup ?workGroupTitle\",\n        \"WHERE { \",\n          \"?expression a <http://scta.info/resource/expression> .\",\n          \"?expression a ?type .\",\n          \"?expression <http://scta.info/property/level> '1' . \",\n          expressionAuthorTypeSparql,\n          workGroupSparql,\n          authorSparql,\n          \"?expression <http://scta.info/property/shortId> ?expressionShortId .\",\n          \"?expression <http://scta.info/property/shortId> ?expressionShortId .\",\n          \"?expression <http://purl.org/dc/elements/1.1/title> ?expressionTitle .\",\n          \"?expression <http://www.loc.gov/loc.terms/relators/AUT> ?author . \",\n          \"?author <http://purl.org/dc/elements/1.1/title> ?authorTitle .\",\n          \"?expression <http://purl.org/dc/terms/isPartOf> ?workGroup .\",\n          \"?workGroup <http://purl.org/dc/elements/1.1/title> ?workGroupTitle .\",\n          \"}\",\n        \"ORDER BY ?expressionTitle\"].join('');\n\n  dispatch(startSearchWorksFetch());\n  axios.get(sparqlEndpoint, {params: {\"query\" : query, \"output\": \"json\"}}).then(function(res){\n    var results = res.data.results.bindings;\n    var searchWorks = results.map((result) => {\n      var workInfo = {\n          expression: result.expression.value,\n          expressionShortId: result.expressionShortId ? result.expressionShortId.value : \"\",\n          expressionTitle: result.expressionTitle.value,\n          workGroup: result.workGroup ? result.workGroup.value : \"\",\n          workGroupTitle: result.workGroupTitle ? result.workGroupTitle.value : \"\",\n          author: result.author ? result.author.value : \"\",\n          authorTitle: result.author ? result.authorTitle.value : \"\",\n          type: result.type.value\n\n        }\n        return workInfo\n\n      });\n      dispatch(completeSearchWorksFetch(searchWorks));\n    });\n  }\n};\n\n//Begin Quotations Authors Fetch\nexport var startQuotationAuthorsFetch = () => {\n  return{\n    type: \"START_QUOTATION_AUTHORS_FETCH\"\n  };\n};\nexport var completeQuotationAuthorsFetch = (authors) => {\n  return{\n    type: \"COMPLETE_QUOTATION_AUTHORS_FETCH\",\n    authors\n  };\n};\nexport var fetchQuotationAuthors = () =>{\n  return (dispatch, getState) => {\n    var state = getState();\n    let quotationAuthorTypeSparql = \"\";\n    if (state.search.searchParameters.quotationAuthorType){\n\n      quotationAuthorTypeSparql = [\n      \"?author <http://scta.info/property/personType> <http://scta.info/resource/\" + state.search.searchParameters.quotationAuthorType + \"> .\"\n      ].join('');\n    }\n    // Begin Author date sparql filters\n    let quotationAuthorDateSparql = \"\";\n    if (state.search.searchParameters.quotationAuthorDateAfter || state.search.searchParameters.quotationAuthorDateBefore){\n      quotationAuthorDateSparql = \"?author <http://scta.info/property/dateOfBirth> ?dateOfBirth .\"\n    }\n    let quotationAuthorDateAfterSparqlFilter = \"\";\n    if (state.search.searchParameters.quotationAuthorDateAfter){\n      quotationAuthorDateAfterSparqlFilter = \"FILTER (?dateOfBirth >= '\" + state.search.searchParameters.quotationAuthorDateAfter + \"').\"\n    }\n    let quotationAuthorDateBeforeSparqlFilter = \"\";\n    if (state.search.searchParameters.quotationAuthorDateBefore){\n      quotationAuthorDateBeforeSparqlFilter = \"FILTER (?dateOfBirth <= '\" + state.search.searchParameters.quotationAuthorDateBefore + \"').\"\n    }\n    // END author date sparql filter\n    var query = [\n        \"SELECT DISTINCT ?author ?authorTitle ?authorShortId \",\n        \"WHERE { \",\n        \"?author a <http://scta.info/resource/person> .\",\n        quotationAuthorTypeSparql,\n        quotationAuthorDateSparql,\n        \"?resource a <http://scta.info/resource/expression> .\",\n        \"?resource <http://scta.info/property/level> '1' .\",\n        \"?resource <http://www.loc.gov/loc.terms/relators/AUT> ?author .\",\n        \"?author <http://scta.info/property/shortId> ?authorShortId .\",\n        \"?author <http://purl.org/dc/elements/1.1/title> ?authorTitle .\",\n        quotationAuthorDateAfterSparqlFilter,\n        quotationAuthorDateBeforeSparqlFilter,\n        \"}\",\n        \"ORDER BY ?authorTitle\"].join('');\n  dispatch(startQuotationAuthorsFetch());\n  axios.get(sparqlEndpoint, {params: {\"query\" : query, \"output\": \"json\"}}).then(function(res){\n    var results = res.data.results.bindings;\n    var authors = results.map((result) => {\n        var authorInfo = {\n          author: result.author.value,\n          authorShortId: result.authorShortId.value,\n          authorTitle: result.authorTitle.value,\n        }\n        return authorInfo\n\n      });\n      dispatch(completeQuotationAuthorsFetch(authors));\n    });\n  }\n};\n// End Quotation Authors Fetch\n// Begin Expression Authors Fetch\nexport var startExpressionAuthorsFetch = () => {\n  return{\n    type: \"START_EXPRESSION_AUTHORS_FETCH\"\n  };\n};\nexport var completeExpressionAuthorsFetch = (authors) => {\n  return{\n    type: \"COMPLETE_EXPRESSION_AUTHORS_FETCH\",\n    authors\n  };\n};\nexport var fetchExpressionAuthors = () =>{\n  return (dispatch, getState) => {\n    var state = getState();\n    let expressionAuthorTypeSparql = \"\";\n    if (state.search.searchParameters.expressionAuthorType){\n\n      expressionAuthorTypeSparql = [\n      \"?author <http://scta.info/property/personType> <http://scta.info/resource/\" + state.search.searchParameters.expressionAuthorType + \"> .\"\n      ].join('');\n    }\n\n    // Begin expression author filter\n    let expressionAuthorDateSparql = \"\";\n    if (state.search.searchParameters.expressionAuthorDateAfter || state.search.searchParameters.expressionAuthorDateBefore){\n      expressionAuthorDateSparql = \"?author <http://scta.info/property/dateOfBirth> ?dateOfBirth .\"\n    }\n\n    let expressionAuthorDateAfterSparqlFilter = \"\";\n    if (state.search.searchParameters.expressionAuthorDateAfter){\n      expressionAuthorDateAfterSparqlFilter = \"FILTER (?dateOfBirth >= '\" + state.search.searchParameters.expressionAuthorDateAfter + \"').\"\n    }\n\n    let expressionAuthorDateBeforeSparqlFilter = \"\";\n    if (state.search.searchParameters.expressionAuthorDateBefore){\n      expressionAuthorDateBeforeSparqlFilter = \"FILTER (?dateOfBirth <= '\" + state.search.searchParameters.expressionAuthorDateBefore + \"').\"\n    }\n    // End expression author filter\n    var query = [\n        \"SELECT DISTINCT ?author ?authorTitle ?authorShortId \",\n        \"WHERE { \",\n        \"?author a <http://scta.info/resource/person> .\",\n        expressionAuthorTypeSparql,\n        expressionAuthorDateSparql,\n        \"?resource a <http://scta.info/resource/expression> .\",\n        \"?resource <http://scta.info/property/level> '1' .\",\n        \"?resource <http://www.loc.gov/loc.terms/relators/AUT> ?author .\",\n        \"?author <http://scta.info/property/shortId> ?authorShortId .\",\n        \"?author <http://purl.org/dc/elements/1.1/title> ?authorTitle .\",\n        expressionAuthorDateAfterSparqlFilter,\n        expressionAuthorDateBeforeSparqlFilter,\n        \"}\",\n        \"ORDER BY ?authorTitle\"].join('');\n\n  dispatch(startExpressionAuthorsFetch());\n  axios.get(sparqlEndpoint, {params: {\"query\" : query, \"output\": \"json\"}}).then(function(res){\n    var results = res.data.results.bindings;\n    var authors = results.map((result) => {\n        var authorInfo = {\n          author: result.author.value,\n          authorShortId: result.authorShortId.value,\n          authorTitle: result.authorTitle.value,\n        }\n        return authorInfo\n\n      });\n      dispatch(completeExpressionAuthorsFetch(authors));\n    });\n  }\n};\n// END Expression Authors Actions\nexport var startQuotationWorksListFetch = () => {\n  return{\n    type: \"START_QUOTATION_WORKS_LIST_FETCH\"\n  };\n};\nexport var completeQuotationWorksListFetch = (quotationWorksList) => {\n  return{\n    type: \"COMPLETE_QUOTATION_WORKS_LIST_FETCH\",\n    quotationWorksList\n  };\n};\nexport var fetchQuotationWorksList = () =>{\n  return (dispatch, getState) => {\n    var state = getState();\n    var quotationWorkGroupSparql = \"\"\n    if (state.search.searchParameters.quotationWorkGroup){\n      quotationWorkGroupSparql = [\n      \"<http://scta.info/resource/\" + state.search.searchParameters.quotationWorkGroup + \"> <http://scta.info/property/hasExpression> ?expression .\"\n      ].join('');\n    }\n    var quotationAuthorSparql = \"\"\n    if (state.search.searchParameters.quotationAuthor){\n      quotationAuthorSparql = [\n      \"?expression <http://www.loc.gov/loc.terms/relators/AUT> <http://scta.info/resource/\" + state.search.searchParameters.quotationAuthor + \"> .\"\n      ].join('');\n    }\n    let quotationAuthorTypeSparql = \"\"\n    if (state.search.searchParameters.quotationAuthorType){\n      quotationAuthorTypeSparql = [\n      \"?expression <http://www.loc.gov/loc.terms/relators/AUT> ?quotationAuthor . \",\n      \"?quotationAuthor <http://scta.info/property/personType> <http://scta.info/resource/\" + state.search.searchParameters.quotationAuthorType + \"> .\"\n      ].join('');\n    }\n    var query = [\n        \"SELECT ?type ?expression ?expressionShortId ?expressionTitle ?author ?authorTitle ?workGroup ?workGroupTitle\",\n        \"WHERE { \",\n        \"?expression a <http://scta.info/resource/expression> .\",\n        \"?expression a ?type .\",\n        \"?expression <http://scta.info/property/level> '1' . \",\n        quotationAuthorTypeSparql,\n        quotationWorkGroupSparql,\n        quotationAuthorSparql,\n        \"?expression <http://scta.info/property/shortId> ?expressionShortId .\",\n        \"?expression <http://purl.org/dc/elements/1.1/title> ?expressionTitle .\",\n        \"OPTIONAL { \",\n        \"?expression <http://www.loc.gov/loc.terms/relators/AUT> ?author . \",\n        \"?author <http://purl.org/dc/elements/1.1/title> ?authorTitle .\",\n        \"}\",\n        \"?expression <http://purl.org/dc/terms/isPartOf> ?workGroup .\",\n        \"?workGroup <http://purl.org/dc/elements/1.1/title> ?workGroupTitle .\",\n        \"}\",\n        \"ORDER BY ?expressionTitle\"].join('');\n\n  dispatch(startQuotationWorksListFetch());\n  axios.get(sparqlEndpoint, {params: {\"query\" : query, \"output\": \"json\"}}).then(function(res){\n    var results = res.data.results.bindings;\n    var quotationWorksList = results.map((result) => {\n      var quotationWorkInfo = {\n          expression: result.expression.value,\n          expressionShortId: result.expressionShortId ? result.expressionShortId.value : \"\",\n          expressionTitle: result.expressionTitle.value,\n          workGroup: result.workGroup ? result.workGroup.value : \"\",\n          workGroupTitle: result.workGroupTitle ? result.workGroupTitle.value : \"\",\n          author: result.author ? result.author.value : \"\",\n          authorTitle: result.author ? result.authorTitle.value : \"\",\n          type: result.type.value\n\n        }\n        return quotationWorkInfo\n      });\n      dispatch(completeQuotationWorksListFetch(quotationWorksList));\n    });\n  }\n};\nexport var startQuotationWorkPartsFetch = () => {\n  return{\n    type: \"START_QUOTATION_WORK_PARTS_FETCH\"\n  };\n};\nexport var completeQuotationWorkPartsFetch = (parts) => {\n  return{\n    type: \"COMPLETE_QUOTATION_WORK_PARTS_FETCH\",\n    parts\n  };\n};\nexport var fetchQuotationWorkParts = () =>{\n  return (dispatch, getState) => {\n    var state = getState();\n    var currentNode = \"\";\n    if (state.search.searchParameters.quotationWorkPart != \"\"){\n      currentNode = state.search.searchParameters.quotationWorkPart;\n    }\n    else if (state.search.searchParameters.quotationWork != \"\"){\n      currentNode = state.search.searchParameters.quotationWork;\n    }\n    else{\n      currentNode = \"\";\n    }\n\n    var query = [\n        \"SELECT ?grandparent ?grandparent_title ?parent_title ?parent ?child ?child_title \",\n        \"WHERE { \",\n        \"BIND(<http://scta.info/resource/\" + currentNode + \"> AS ?parent)\",\n        \"OPTIONAL {\",\n          \"?parent <http://purl.org/dc/elements/1.1/title> ?parent_title\",\n        \"}\",\n        \"OPTIONAL {\",\n        \"?parent <http://purl.org/dc/terms/hasPart> ?child .\",\n        \"?child <http://purl.org/dc/elements/1.1/title> ?child_title .\",\n        //\"MINUS{?child <http://scta.info/property/structureType> <http://scta.info/resource/structureDivision> .}\",\n        \"}\",\n        \"OPTIONAL {\",\n        \"?parent <http://purl.org/dc/terms/isPartOf> ?grandparent .\",\n        //\"?grandparent <http://scta.info/property/structureType> <http://scta.info/resource/structureCollection> .\",\n        \"?grandparent <http://purl.org/dc/elements/1.1/title> ?grandparent_title\",\n        \"}\",\n        \"}\"\n        ].join('');\n    //conditional here prevents running query if the node is blank\n    //if (currentNode){\n    dispatch(startQuotationWorkPartsFetch());\n    axios.get(sparqlEndpoint, {params: {\"query\" : query, \"output\": \"json\"}}).then(function(res){\n      var results = res.data.results.bindings;\n      var parts = results.map((result) => {\n          var partInfo = {\n            grandparent: result.grandparent ? result.grandparent.value : \"\",\n            grandparent_title: result.grandparent_title ? result.grandparent_title.value : \"\",\n            parent: result.parent.value,\n            parent_title: result.parent_title ? result.parent_title.value : \"\",\n            child: result.child ? result.child.value : \"\",\n            child_title: result.child_title ? result.child_title.value : \"\"\n          }\n          return partInfo\n\n        });\n        dispatch(completeQuotationWorkPartsFetch(parts));\n      });\n    //}\n  }\n};\n\nexport var startExpressionPartsFetch = () => {\n  return{\n    type: \"START_EXPRESSION_PARTS_FETCH\"\n  };\n};\nexport var completeExpressionPartsFetch = (parts) => {\n  return{\n    type: \"COMPLETE_EXPRESSION_PARTS_FETCH\",\n    parts\n  };\n};\nexport var fetchExpressionParts = () =>{\n  return (dispatch, getState) => {\n    var state = getState();\n    var currentNode = \"\";\n    if (state.search.searchParameters.expressionPart != \"\"){\n      currentNode = state.search.searchParameters.expressionPart;\n    }\n    else if (state.search.searchParameters.expressionId != \"\"){\n      currentNode = state.search.searchParameters.expressionId;\n    }\n    else{\n      currentNode = \"\";\n    }\n    var query = [\n        \"SELECT ?grandparent ?grandparent_title ?grandparent_level ?parent_title ?parent ?parent_level ?child ?child_level ?child_title \",\n        \"WHERE { \",\n        \"BIND(<http://scta.info/resource/\" + currentNode + \"> AS ?parent)\",\n        \"OPTIONAL {\",\n          \"?parent <http://purl.org/dc/elements/1.1/title> ?parent_title .\",\n          \"?parent <http://scta.info/property/level> ?parent_level .\",\n        \"}\",\n        \"OPTIONAL {\",\n        \"?parent <http://purl.org/dc/terms/hasPart> ?child .\",\n        \"?child <http://purl.org/dc/elements/1.1/title> ?child_title .\",\n        \"?child <http://scta.info/property/level> ?child_level .\",\n        //\"MINUS{?child <http://scta.info/property/structureType> <http://scta.info/resource/structureDivision> .}\",\n        \"}\",\n        \"OPTIONAL {\",\n        \"?parent <http://purl.org/dc/terms/isPartOf> ?grandparent .\",\n        //\"?grandparent <http://scta.info/property/structureType> <http://scta.info/resource/structureCollection> .\",\n        \"?grandparent <http://purl.org/dc/elements/1.1/title> ?grandparent_title .\",\n        \"?grandparent <http://scta.info/property/level> ?grandparent_level .\",\n        \"}\",\n        \"}\"\n        ].join('');\n  //conditional prevents running query if current node is blank\n  if (currentNode){\n    dispatch(startExpressionPartsFetch());\n    axios.get(sparqlEndpoint, {params: {\"query\" : query, \"output\": \"json\"}}).then(function(res){\n      var results = res.data.results.bindings;\n      var parts = results.map((result) => {\n          var partInfo = {\n            grandparent: result.grandparent ? result.grandparent.value : \"\",\n            grandparent_title: result.grandparent_title ? result.grandparent_title.value : \"\",\n            grandparent_level: result.grandparent_level ? result.grandparent_level.value : \"\",\n            parent: result.parent.value,\n            parent_title: result.parent_title ? result.parent_title.value : \"\",\n            parent_level: result.parent_level ? result.parent_level.value : \"\",\n            child: result.child ? result.child.value : \"\",\n            child_title: result.child_title ? result.child_title.value : \"\",\n            child_level: result.child_level ? result.child_level.value : \"\",\n          }\n          return partInfo\n\n        });\n        dispatch(completeExpressionPartsFetch(parts));\n      });\n    }\n  }\n};\n\nexport var startQuotationExpressionTypeFetch = () => {\n  return{\n    type: \"START_QUOTATION_EXPRESSION_TYPE_FETCH\"\n  };\n};\nexport var completeQuotationExpressionTypeFetch = (quotationExpressionTypes) => {\n  return{\n    type: \"COMPLETE_QUOTATION_EXPRESSION_TYPE_FETCH\",\n    quotationExpressionTypes\n  };\n};\nexport var fetchQuotationExpressionTypes = () =>{\n  return (dispatch, getState) => {\n    var state = getState();\n    var query = [\n        \"SELECT ?quotationExpressionType ?quotationExpressionTypeTitle ?quotationExpressionTypeShortId \",\n        \"WHERE { \",\n        \"?quotationExpressionType a <http://scta.info/resource/expressionType> .\",\n        \"?quotationExpressionType <http://scta.info/property/shortId> ?quotationExpressionTypeShortId .\",\n        \"?quotationExpressionType <http://purl.org/dc/elements/1.1/title> ?quotationExpressionTypeTitle .\",\n        \"}\",\n        \"ORDER BY ?quotationExpressionTypeTitle\"].join('');\n\n  dispatch(startQuotationExpressionTypeFetch());\n  axios.get(sparqlEndpoint, {params: {\"query\" : query, \"output\": \"json\"}}).then(function(res){\n    var results = res.data.results.bindings;\n\n    var quotationExpressionTypes = results.map((result) => {\n      var quotationExpressionTypeInfo = {\n          quotationExpressionType: result.quotationExpressionType.value,\n          quotationExpressionTypeShortId: result.quotationExpressionTypeShortId.value,\n          quotationExpressionTypeTitle: result.quotationExpressionTypeTitle.value\n        }\n        return quotationExpressionTypeInfo\n      });\n      dispatch(completeQuotationExpressionTypeFetch(quotationExpressionTypes));\n    });\n  }\n};\n\n\nexport var startExpressionTypeFetch = () => {\n  return{\n    type: \"START_EXPRESSION_TYPE_FETCH\"\n  };\n};\nexport var completeExpressionTypeFetch = (expressionTypes) => {\n  return{\n    type: \"COMPLETE_EXPRESSION_TYPE_FETCH\",\n    expressionTypes\n  };\n};\nexport var fetchExpressionTypes = () =>{\n  return (dispatch, getState) => {\n    var state = getState();\n    var query = [\n        \"SELECT ?expressionType ?expressionTypeTitle ?expressionTypeShortId \",\n        \"WHERE { \",\n        \"?expressionType a <http://scta.info/resource/expressionType> .\",\n        \"?expressionType <http://scta.info/property/shortId> ?expressionTypeShortId .\",\n        \"?expressionType <http://purl.org/dc/elements/1.1/title> ?expressionTypeTitle .\",\n        \"}\",\n        \"ORDER BY ?expressionTypeTitle\"].join('');\n\n  dispatch(startExpressionTypeFetch());\n  axios.get(sparqlEndpoint, {params: {\"query\" : query, \"output\": \"json\"}}).then(function(res){\n    var results = res.data.results.bindings;\n    var expressionTypes = results.map((result) => {\n      var expressionTypeInfo = {\n          expressionType: result.expressionType.value,\n          expressionTypeShortId: result.expressionTypeShortId.value,\n          expressionTypeTitle: result.expressionTypeTitle.value\n        }\n        return expressionTypeInfo\n      });\n      dispatch(completeExpressionTypeFetch(expressionTypes));\n    });\n  }\n};\nexport var startWorkGroupsFetch = () => {\n  return{\n    type: \"START_WORK_GROUPS_FETCH\"\n  };\n};\nexport var completeWorkGroupsFetch = (workGroups) => {\n  return{\n    type: \"COMPLETE_WORK_GROUPS_FETCH\",\n    workGroups\n  };\n};\nexport var fetchWorkGroups = () =>{\n  return (dispatch, getState) => {\n    var state = getState();\n    var query = [\n        \"SELECT ?workGroup ?workGroupShortId ?workGroupTitle \",\n        \"WHERE { \",\n        \"?workGroup a <http://scta.info/resource/workGroup> .\",\n        \"?workGroup <http://scta.info/property/shortId> ?workGroupShortId .\",\n        \"?workGroup <http://purl.org/dc/elements/1.1/title> ?workGroupTitle .\",\n        \"}\",\n        \"ORDER BY ?workGroupTitle\"].join('');\n  dispatch(startWorkGroupsFetch());\n  axios.get(sparqlEndpoint, {params: {\"query\" : query, \"output\": \"json\"}}).then(function(res){\n    var results = res.data.results.bindings;\n    var workGroups = results.map((result) => {\n      var workGroupInfo = {\n          workGroup: result.workGroup.value,\n          workGroupShortId: result.workGroupShortId.value,\n          workGroupTitle: result.workGroupTitle.value\n        }\n        return workGroupInfo\n      });\n      dispatch(completeWorkGroupsFetch(workGroups));\n    });\n  }\n};\n// Author types fetch\n\nexport var startAuthorTypesFetch = () => {\n  return{\n    type: \"START_AUTHOR_TYPES_FETCH\"\n  };\n};\nexport var completeAuthorTypesFetch = (authorTypes) => {\n  return{\n    type: \"COMPLETE_AUTHOR_TYPES_FETCH\",\n    authorTypes\n  };\n};\nexport var fetchAuthorTypes = () =>{\n  return (dispatch, getState) => {\n    var state = getState();\n    var query = [\n      \"SELECT ?authorType ?authorTypeTitle ?authorTypeShortId \",\n      \"WHERE { \",\n      \"?authorType a <http://scta.info/resource/personType> .\",\n      \"?authorType <http://scta.info/property/shortId> ?authorTypeShortId .\",\n      \"?authorType <http://purl.org/dc/elements/1.1/title> ?authorTypeTitle .\",\n      \"}\",\n      \"ORDER BY ?authorTypeTitle\"].join('');\n  dispatch(startAuthorTypesFetch());\n  axios.get(sparqlEndpoint, {params: {\"query\" : query, \"output\": \"json\"}}).then(function(res){\n    var results = res.data.results.bindings;\n    var authorTypes = results.map((result) => {\n      var authorTypeInfo = {\n          authorType: result.authorType.value,\n          authorTypeShortId: result.authorTypeShortId.value,\n          authorTypeTitle: result.authorTypeTitle.value\n        }\n        return authorTypeInfo\n      });\n      dispatch(completeAuthorTypesFetch(authorTypes));\n    });\n  }\n};\n\n\n\n///Chart Actions\nexport var toggleGraphDisplay = (current) => {\n  return{\n    type: \"TOGGLE_GRAPH_DISPLAY\",\n    current\n  };\n}\nexport var startChartFetch = () => {\n  return{\n    type: \"START_CHART_FETCH\"\n  };\n};\nexport var completeChartFetch = (count) => {\n  return{\n    type: \"COMPLETE_CHART_FETCH\",\n    count\n  };\n};\nexport var fetchChart = () =>{\n  return (dispatch, getState) => {\n    var state = getState();\n    var level = parseInt(state.search.searchParameters.expressionLevel)\n    if (level === 1){\n      level = 2;\n    }\n    var searchText = state.search.searchParameters.searchText || \"\";\n\n    let expressionWorkGroupSparql = \"\";\n    if (state.search.searchParameters.workGroup){\n      const workGroup = state.search.searchParameters.workGroup;\n      expressionWorkGroupSparql = [\n        \"?ref <http://purl.org/dc/terms/isPartOf> <http://scta.info/resource/\" + workGroup + \">  . \"\n      ].join('');\n    }\n\n// BEGIN Expression author queries\n    let expressionAuthorTypeSparql = \"\"\n    if (state.search.searchParameters.expressionAuthorType){\n      expressionAuthorTypeSparql = \"?author <http://scta.info/property/personType> <http://scta.info/resource/\" + state.search.searchParameters.expressionAuthorType + \"> .\"\n    }\n\n    //Begin expression author date filter for expression author\n    let expressionAuthorDateSparql = \"\";\n    if (state.search.searchParameters.expressionAuthorDateAfter || state.search.searchParameters.expressionAuthorDateBefore){\n      expressionAuthorDateSparql = \"?author <http://scta.info/property/dateOfBirth> ?expressionAuthorDateOfBirth .\"\n    }\n    let expressionAuthorDateAfterSparqlFilter = \"\";\n    if (state.search.searchParameters.expressionAuthorDateAfter){\n      expressionAuthorDateAfterSparqlFilter = \"FILTER (?expressionAuthorDateOfBirth >= '\" + state.search.searchParameters.expressionAuthorDateAfter + \"').\"\n    }\n    let expressionAuthorDateBeforeSparqlFilter = \"\";\n    if (state.search.searchParameters.expressionAuthorDateBefore){\n        expressionAuthorDateBeforeSparqlFilter = \"FILTER (?expressionAuthorDateOfBirth <= '\" + state.search.searchParameters.expressionAuthorDateBefore + \"').\"\n    }\n    //END expression author date filter for expression author\n\n    var expressionAuthorSparql = \"\";\n    if (state.search.searchParameters.expressionAuthor){\n      expressionAuthorSparql = \"?ref <http://www.loc.gov/loc.terms/relators/AUT> <http://scta.info/resource/\" + state.search.searchParameters.expressionAuthor + \"> .\"\n    }\n\n    var expressionAuthorCoreSparql = [\n      \"?ref <http://www.loc.gov/loc.terms/relators/AUT> ?author . \",\n      expressionAuthorTypeSparql,\n      expressionAuthorDateSparql,\n      expressionAuthorSparql\n    ].join('');\n// End expression author queries\n\n//BEGIN Quotation Author Queries\n      var quotationAuthorTypeSparql = \"\";\n      if (state.search.searchParameters.quotationAuthorType){\n        var searchShortId = state.search.searchParameters.quotationAuthorType;\n        quotationAuthorTypeSparql = \"?quotationAuthor <http://scta.info/property/personType> <http://scta.info/resource/\" + searchShortId + \">  . \";\n      }\n\n      //Begin quotation author date filter for expression author\n      let quotationAuthorDateSparql = \"\";\n      if (state.search.searchParameters.quotationAuthorDateAfter || state.search.searchParameters.quotationAuthorDateBefore){\n        quotationAuthorDateSparql =\n            \"?quotationAuthor <http://scta.info/property/dateOfBirth> ?quotationAuthorDateOfBirth .\"\n      }\n      let quotationAuthorDateAfterSparqlFilter = \"\";\n      if (state.search.searchParameters.quotationAuthorDateAfter){\n        quotationAuthorDateAfterSparqlFilter = \"FILTER (?quotationAuthorDateOfBirth >= '\" + state.search.searchParameters.quotationAuthorDateAfter + \"').\"\n      }\n      let quotationAuthorDateBeforeSparqlFilter = \"\";\n      if (state.search.searchParameters.quotationAuthorDateBefore){\n          quotationAuthorDateBeforeSparqlFilter = \"FILTER (?quotationAuthorDateOfBirth <= '\" + state.search.searchParameters.quotationAuthorDateBefore + \"').\"\n      }\n      //END quotation author date filter for expression author\n\n      var quotationAuthorSparql = \"\";\n      if (state.search.searchParameters.quotationAuthor){\n        var searchShortId = (state.search.searchParameters.quotationAuthor);\n        quotationAuthorSparql = \"?source_toplevel_expression <http://www.loc.gov/loc.terms/relators/AUT> <http://scta.info/resource/\" + searchShortId + \">  . \"\n      }\n      var quotationAuthorCoreSparql = \"\"\n      if (state.search.searchParameters.quotationAuthorDateAfter\n        || state.search.searchParameters.quotationAuthorDateBefore\n        || state.search.searchParameters.quotationAuthor\n        || state.search.searchParameters.quotationAuthorType\n      ){\n        var quotationAuthorCoreSparql = [\n            sourceUnion(\"?element\"),\n            \"?source <http://scta.info/property/isPartOfTopLevelExpression> ?source_toplevel_expression . \",\n            \"?source_toplevel_expression <http://www.loc.gov/loc.terms/relators/AUT> ?quotationAuthor . \",\n            quotationAuthorTypeSparql,\n            quotationAuthorDateSparql,\n            quotationAuthorSparql\n        ].join('');\n      }\n\n// END Quotation Author Queries for Quotations List\n\n\n\n    var quotationWorkGroupSparql = \"\";\n    if (state.search.searchParameters.quotationWorkGroup){\n      var searchShortId = (state.search.searchParameters.quotationWorkGroup);\n      quotationWorkGroupSparql = [\n          sourceUnion(\"?element\"),\n          \"?source <http://scta.info/property/isPartOfTopLevelExpression> ?source_toplevel_expression . \",\n          \"<http://scta.info/resource/\" + state.search.searchParameters.quotationWorkGroup + \"> <http://scta.info/property/hasExpression> ?source_toplevel_expression .\"\n      ].join('');\n    }\n\n\n    var quotationWorkSparql = \"\";\n    if (state.search.searchParameters.quotationWork || state.search.searchParameters.quotationWorkPart){\n      var searchShortId = (state.search.searchParameters.quotationWorkPart) ? state.search.searchParameters.quotationWorkPart : state.search.searchParameters.quotationWork\n      quotationWorkSparql = [\n        \"\\n#check for quotation whose source is a member the search expression\\n\",\n        \"{\",\n          sourceUnion(\"?element\"),\n          \"?source <http://scta.info/property/isMemberOf> <http://scta.info/resource/\" + searchShortId + \"> .\",\n        \"}\",\n        \"UNION\",\n        \"\\n#check for quotation whose source is the search expression\\n\",\n        \"{\",\n          sourceUnion(\"?element\", \"<http://scta.info/resource/\" + searchShortId + \">\"),\n        \"}\",\n    ].join('');\n    }\n\n    //BEGIN condition for choosing ref quote or combo\n        var structureElementTypeSparql = \"\";\n        if (state.search.searchParameters.structureElementType === \"structureElementRef\"){\n          structureElementTypeSparql = [\n            \"{?element <http://scta.info/property/structureElementType> <http://scta.info/resource/structureElementRef> .}\",\n            \"MINUS\",\n            \"{?element <http://scta.info/property/isReferenceTo> ?isReferenceTo . }\",\n            ].join('');\n        }\n        else if (state.search.searchParameters.structureElementType === \"structureElementRefDup\"){\n          structureElementTypeSparql = \"?element <http://scta.info/property/structureElementType> <http://scta.info/resource/structureElementRef> .\"\n        }\n        else if (state.search.searchParameters.structureElementType === \"structureElementQuote\"){\n          structureElementTypeSparql = \"?element <http://scta.info/property/structureElementType> <http://scta.info/resource/structureElementQuote> .\"\n        }\n        else if (state.search.searchParameters.structureElementType === \"allDup\"){\n          structureElementTypeSparql = [\n            \"{?element <http://scta.info/property/structureElementType> <http://scta.info/resource/structureElementQuote> .}\",\n            \"UNION\",\n            \"{?element <http://scta.info/property/structureElementType> <http://scta.info/resource/structureElementRef> . }\"\n          ].join('');\n        }\n        else{\n          structureElementTypeSparql = [\n            \"{?element <http://scta.info/property/structureElementType> <http://scta.info/resource/structureElementQuote> .}\",\n            \"UNION\",\n            \"{{?element <http://scta.info/property/structureElementType> <http://scta.info/resource/structureElementRef> .}\",\n            \"MINUS\",\n            \"{?element <http://scta.info/property/isReferenceTo> ?isReferenceTo . }\",\n\n            \"}\"\n          ].join('');\n        }\n    //END condition for choosing ref quote or combo\n\n\n\n    //var expressionId = state.search.searchParameters.expressionPart ? state.search.searchParameters.expressionPart : state.search.searchParameters.expressionId\n    if (state.search.searchParameters.expressionId){\n      // query for quote frequency within a given expression\n      var expressionId = state.search.searchParameters.expressionId\n      var query = [\n        \"SELECT ?ref ?reftitle ?totalOrderNumber (count(?element) as ?count) \",\n        \"WHERE {\",\n        \"?ref a <http://scta.info/resource/expression> .\",\n        \"?ref <http://scta.info/property/isMemberOf> <http://scta.info/resource/\" + expressionId + \"> .\",\n        \"?ref <http://scta.info/property/level> '\" + level + \"' .\",\n        \"?ref <http://purl.org/dc/elements/1.1/title> ?reftitle .\",\n        \"OPTIONAL {\",\n        \"?ref <http://scta.info/property/totalOrderNumber> ?totalOrderNumber .\",\n        \"}\",\n        \"OPTIONAL {\",\n        \"?element <http://scta.info/property/isMemberOf> ?ref .\",\n        //\"?element <http://scta.info/property/structureElementType> <http://scta.info/resource/structureElementQuote> .\",\n        structureElementTypeSparql,\n        \"?element <http://scta.info/property/structureElementText> ?quotation_text .\",\n        quotationAuthorCoreSparql,\n        quotationWorkGroupSparql,\n        quotationWorkSparql,\n        \"}\",\n        quotationAuthorDateBeforeSparqlFilter,\n        quotationAuthorDateAfterSparqlFilter,\n        \"FILTER (REGEX(STR(?quotation_text), '\" + searchText + \"', 'i')) .\",\n        \"}\",\n        \"group by ?ref ?reftitle ?totalOrderNumber \",\n        \"ORDER BY ?totalOrderNumber \"\n      ].join('');\n    }\n    else {\n      // query for quote frequency across top level expressions\n      var query = [\n        \"SELECT ?ref ?reftitle ?totalOrderNumber (count(?element) as ?count) \",\n        \"WHERE {\",\n        \"?ref a <http://scta.info/resource/expression> .\",\n        \"?ref <http://scta.info/property/level> '1' .\",\n        expressionWorkGroupSparql,\n        expressionAuthorCoreSparql,\n        \"?ref <http://purl.org/dc/elements/1.1/title> ?reftitle .\",\n        \"OPTIONAL {\",\n        \"?ref <http://scta.info/property/totalOrderNumber> ?totalOrderNumber .\",\n        \"}\",\n        \"OPTIONAL {\",\n        \"?element <http://scta.info/property/isMemberOf> ?ref .\",\n        //\"?element <http://scta.info/property/structureElementType> <http://scta.info/resource/structureElementQuote> .\",\n        structureElementTypeSparql,\n        \"?element <http://scta.info/property/structureElementText> ?quotation_text .\",\n        quotationAuthorCoreSparql,\n        quotationWorkGroupSparql,\n        quotationWorkSparql,\n        \"}\",\n        quotationAuthorDateBeforeSparqlFilter,\n        quotationAuthorDateAfterSparqlFilter,\n        expressionAuthorDateBeforeSparqlFilter,\n        expressionAuthorDateAfterSparqlFilter,\n        \"FILTER (REGEX(STR(?quotation_text), '\" + searchText + \"', 'i')) .\",\n        \"}\",\n        \"group by ?ref ?reftitle ?totalOrderNumber \",\n        \"ORDER BY ?totalOrderNumber \"\n      ].join('');\n    }\n\n  dispatch(startChartFetch());\n  axios.get(sparqlEndpoint, {params: {\"query\" : query, \"output\": \"json\"}}).then(function(res){\n    var results = res.data.results.bindings;\n    var count = results.map((result) => {\n        return {\n          \"item\": result.ref ? result.ref.value : \"\",\n          \"title\": result.reftitle ? result.reftitle.value : \"\",\n          \"count\": result.count ? result.count.value : \"\"\n        }\n      });\n      dispatch(completeChartFetch(count));\n    });\n  }\n};\n\n///Chart Actions\nexport var toggleImagesDisplay = (current) => {\n  return{\n    type: \"TOGGLE_IMAGES_DISPLAY\",\n    current\n  };\n}\nexport var startImagesFetch = () => {\n  return{\n    type: \"START_IMAGES_FETCH\"\n  };\n};\nexport var completeImagesFetch = (images) => {\n  return{\n    type: \"COMPLETE_IMAGES_FETCH\",\n    images\n  };\n};\nexport var fetchImages = () =>{\n  return (dispatch, getState) => {\n    var state = getState();\n    var manifestation_id = state.paragraph.manifestation_id\n    var query = [\n      \"SELECT ?url \",\n      \"WHERE { \",\n      \"<\" + manifestation_id + \"> <http://scta.info/property/isOnSurface> ?surface .\",\n      \"?surface <http://scta.info/property/hasISurface> ?isurface .\",\n      \"?isurface <http://scta.info/property/hasCanvas> ?canvas .\",\n      \"?canvas <http://iiif.io/api/presentation/2#hasImageAnnotations> ?anno .\",\n      \"?canvas <http://iiif.io/api/presentation/2#hasImageAnnotations> ?anno .\",\n      \"?anno <http://www.w3.org/1999/02/22-rdf-syntax-ns#first> ?imgres .\",\n      \"?imgres <http://www.w3.org/ns/oa#hasBody> ?body .\",\n      \"?body <http://rdfs.org/sioc/services#has_service> ?url .\",\n      \"}\"\n    ].join('');\n\n  dispatch(startImagesFetch());\n  axios.get(sparqlEndpoint, {params: {\"query\" : query, \"output\": \"json\"}}).then(function(res){\n    var results = res.data.results.bindings;\n    var images = results.map((result) => {\n        return {\n          \"url\": result.url.value,\n        }\n      });\n      dispatch(completeImagesFetch(images));\n    });\n  }\n};\n\n\n// Quotation Actions\n// ==================\nexport var addQuotations = (quotations) => {\n  return{\n    type: \"ADD_QUOTATIONS\",\n    quotations\n  };\n};\nexport var clearQuotations = () => {\n  return{\n    type: \"CLEAR_QUOTATIONS\"\n  };\n};\nexport var startQuotationsFetch = () => {\n  return{\n    type: \"START_QUOTATIONS_FETCH\"\n  };\n};\nexport var clearQuotationsFocus = () => {\n  return{\n    type: \"CLEAR_QUOTATIONS_FOCUS\"\n  };\n};\nexport var completeQuotationsFetch = (quotations) => {\n  return{\n    type: \"COMPLETE_QUOTATIONS_FETCH\",\n    quotations\n  };\n};\nexport var fetchQuotations = () =>{\n  return (dispatch, getState) => {\n    var state = getState();\n    var searchText = state.search.searchParameters.searchText || \"\";\n    var expressionIdSparql = \"\";\n    if (state.search.searchParameters.expressionId || state.search.searchParameters.expressionPart){\n      var searchShortId = (state.search.searchParameters.expressionPart) ? state.search.searchParameters.expressionPart : state.search.searchParameters.expressionId\n      var expressionIdSparql = [\n      \"?quotation <http://scta.info/property/isMemberOf> <http://scta.info/resource/\" + searchShortId + \"> .\"\n      ].join('');\n\n    }\n// BEGIN Expression author queries\n    let expressionAuthorTypeSparql = \"\"\n    if (state.search.searchParameters.expressionAuthorType){\n      expressionAuthorTypeSparql = \"?author <http://scta.info/property/personType> <http://scta.info/resource/\" + state.search.searchParameters.expressionAuthorType + \"> .\"\n    }\n\n    //Begin expression author date filter for expression author\n    let expressionAuthorDateSparql = \"\";\n    if (state.search.searchParameters.expressionAuthorDateAfter || state.search.searchParameters.expressionAuthorDateBefore){\n      expressionAuthorDateSparql = \"?author <http://scta.info/property/dateOfBirth> ?dateOfBirth .\"\n    }\n    let expressionAuthorDateAfterSparqlFilter = \"\";\n    if (state.search.searchParameters.expressionAuthorDateAfter){\n      expressionAuthorDateAfterSparqlFilter = \"FILTER (?dateOfBirth >= '\" + state.search.searchParameters.expressionAuthorDateAfter + \"').\"\n    }\n    let expressionAuthorDateBeforeSparqlFilter = \"\";\n    if (state.search.searchParameters.expressionAuthorDateBefore){\n        expressionAuthorDateBeforeSparqlFilter = \"FILTER (?dateOfBirth <= '\" + state.search.searchParameters.expressionAuthorDateBefore + \"').\"\n    }\n    //END expression author date filter for expression author\n\n    var authorSparql = \"\";\n    if (state.search.searchParameters.expressionAuthor){\n      authorSparql = \"?toplevel_expression <http://www.loc.gov/loc.terms/relators/AUT> <http://scta.info/resource/\" + state.search.searchParameters.expressionAuthor + \"> .\"\n    }\n\n    var expressionAuthorCoreSparql = [\n      \"?toplevel_expression <http://www.loc.gov/loc.terms/relators/AUT> ?author . \",\n      expressionAuthorTypeSparql,\n      expressionAuthorDateSparql,\n      authorSparql,\n      \"?author <http://purl.org/dc/elements/1.1/title> ?author_title . \"\n      ].join('');\n// End expression author queries\n\n\n//BEGIN Quotation Author Queries\n    var quotationAuthorTypeSparql = \"\";\n    if (state.search.searchParameters.quotationAuthorType){\n      var searchShortId = state.search.searchParameters.quotationAuthorType;\n      quotationAuthorTypeSparql = \"?quotationAuthor <http://scta.info/property/personType> <http://scta.info/resource/\" + searchShortId + \">  . \";\n    }\n\n    //Begin quotation author date filter for expression author\n    let quotationAuthorDateSparql = \"\";\n    if (state.search.searchParameters.quotationAuthorDateAfter || state.search.searchParameters.quotationAuthorDateBefore){\n      quotationAuthorDateSparql =\n          \"?quotationAuthor <http://scta.info/property/dateOfBirth> ?quotationAuthorDateOfBirth .\"\n    }\n    let quotationAuthorDateAfterSparqlFilter = \"\";\n    if (state.search.searchParameters.quotationAuthorDateAfter){\n      quotationAuthorDateAfterSparqlFilter = \"FILTER (?quotationAuthorDateOfBirth >= '\" + state.search.searchParameters.quotationAuthorDateAfter + \"').\"\n    }\n    let quotationAuthorDateBeforeSparqlFilter = \"\";\n    if (state.search.searchParameters.quotationAuthorDateBefore){\n        quotationAuthorDateBeforeSparqlFilter = \"FILTER (?quotationAuthorDateOfBirth <= '\" + state.search.searchParameters.quotationAuthorDateBefore + \"').\"\n    }\n    //END quotation author date filter for expression author\n\n    var quotationAuthorSparql = \"\";\n    if (state.search.searchParameters.quotationAuthor){\n      var searchShortId = (state.search.searchParameters.quotationAuthor);\n      quotationAuthorSparql = \"?source_toplevel_expression <http://www.loc.gov/loc.terms/relators/AUT> <http://scta.info/resource/\" + searchShortId + \">  . \"\n    }\n    var quotationAuthorCoreSparql = \"\"\n    if (state.search.searchParameters.quotationAuthorDateAfter\n      || state.search.searchParameters.quotationAuthorDateBefore\n      || state.search.searchParameters.quotationAuthor\n      || state.search.searchParameters.quotationAuthorType\n    ){\n    var quotationAuthorCoreSparql = [\n        sourceUnion(),\n        \"?source <http://scta.info/property/isPartOfTopLevelExpression> ?source_toplevel_expression . \",\n        \"?source_toplevel_expression <http://www.loc.gov/loc.terms/relators/AUT> ?quotationAuthor . \",\n        quotationAuthorTypeSparql,\n        quotationAuthorDateSparql,\n        quotationAuthorSparql\n    ].join('');\n    }\n\n// END Quotation Author Queries for Quotations List\n\n    var quotationWorkGroupSparql = \"\";\n    if (state.search.searchParameters.quotationWorkGroup){\n      var searchShortId = (state.search.searchParameters.quotationWorkGroup);\n      quotationWorkGroupSparql = [\n          sourceUnion(),\n          \"?source <http://scta.info/property/isPartOfTopLevelExpression> ?source_toplevel_expression . \",\n          \"<http://scta.info/resource/\" + state.search.searchParameters.quotationWorkGroup + \"> <http://scta.info/property/hasExpression> ?source_toplevel_expression .\"\n      ].join('');\n    }\n\n\n    //NEW QUERY\n    var quotationWorkSparql = \"\";\n    if (state.search.searchParameters.quotationWork || state.search.searchParameters.quotationWorkPart){\n      var searchShortId = (state.search.searchParameters.quotationWorkPart) ? state.search.searchParameters.quotationWorkPart : state.search.searchParameters.quotationWork\n      quotationWorkSparql = [\n        \"\\n#check for quotation whose source is a member the search expression\\n\",\n        \"{\",\n          //\"?quotation <http://scta.info/property/source> ?source .\",\n          sourceUnion(),\n          \"?source <http://scta.info/property/isMemberOf> <http://scta.info/resource/\" + searchShortId + \"> .\",\n        \"}\",\n        \"UNION\",\n        \"\\n#check for quotation whose source is the search expression\\n\",\n        \"{\",\n          sourceUnion(\"?quotation\", \"<http://scta.info/resource/\" + searchShortId + \">\"),\n          //\"?quotation <http://scta.info/property/source> <http://scta.info/resource/\" + searchShortId + \"> .\",\n        \"}\"\n    ].join('');\n    }\n\n    \n    //NEW QUERY\n    let quotationExpressionTypeSparql = \"\";\n    if (state.search.searchParameters.quotationExpressionType){\n      \n\n      const quotationExpressionTypeShortId = state.search.searchParameters.quotationExpressionType;\n      quotationExpressionTypeSparql = [\n        \"\\n#check for quotation whose source is a member the search expression\\n\",\n        \"{\",\n          sourceUnion(),\n          \"?source <http://scta.info/property/isMemberOf> ?memberOf .\",\n          \"?memberOf <http://scta.info/property/expressionType> <http://scta.info/resource/\" + quotationExpressionTypeShortId + \"> .\",\n        \"}\",\n        \"UNION\",\n        \"\\n#check for quotation whose source is the search expression\\n\",\n        \"{\",\n          sourceUnion(),\n          \"?source <http://scta.info/property/expressionType> <http://scta.info/resource/\" + quotationExpressionTypeShortId + \"> .\",\n        \"}\"\n    ].join('');\n    \n    }\n\n    var workGroupSparql = \"\";\n    if (state.search.searchParameters.workGroup){\n      workGroupSparql = [\n      \"<http://scta.info/resource/\" + state.search.searchParameters.workGroup + \"> <http://scta.info/property/hasExpression> ?toplevel_expression .\",\n      ].join('');\n    }\n\n    var expressionTypeSparql = \"\";\n    if (state.search.searchParameters.expressionType){\n      expressionTypeSparql = [\n        \"?quotation <http://scta.info/property/isMemberOf> ?expressionIsmemberOf .\",\n        \"?expressionIsmemberOf <http://scta.info/property/expressionType> <http://scta.info/resource/\" + state.search.searchParameters.expressionType + \"> .\",\n      ].join('');\n    }\n//BEGIN condition for choosing ref quote or combo\n    var structureElementTypeSparql = \"\";\n    if (state.search.searchParameters.structureElementType === \"structureElementRef\"){\n      structureElementTypeSparql = [\n        \"{?quotation <http://scta.info/property/structureElementType> <http://scta.info/resource/structureElementRef> .}\",\n        \"MINUS\",\n        \"{?quotation <http://scta.info/property/isReferenceTo> ?isReferenceTo . }\",\n        ].join('');\n    }\n    else if (state.search.searchParameters.structureElementType === \"structureElementRefDup\"){\n      structureElementTypeSparql = \"?quotation <http://scta.info/property/structureElementType> <http://scta.info/resource/structureElementRef> .\"\n    }\n    else if (state.search.searchParameters.structureElementType === \"structureElementQuote\"){\n      structureElementTypeSparql = \"?quotation <http://scta.info/property/structureElementType> <http://scta.info/resource/structureElementQuote> .\"\n    }\n    else if (state.search.searchParameters.structureElementType === \"allDup\"){\n      structureElementTypeSparql = [\n        \"{?quotation <http://scta.info/property/structureElementType> <http://scta.info/resource/structureElementQuote> .}\",\n        \"UNION\",\n        \"{?quotation <http://scta.info/property/structureElementType> <http://scta.info/resource/structureElementRef> . }\"\n      ].join('');\n    }\n    else{\n      structureElementTypeSparql = [\n        \"{?quotation <http://scta.info/property/structureElementType> <http://scta.info/resource/structureElementQuote> .}\",\n        \"UNION\",\n        \"{{?quotation <http://scta.info/property/structureElementType> <http://scta.info/resource/structureElementRef> .}\",\n        \"MINUS\",\n        \"{?quotation <http://scta.info/property/isReferenceTo> ?isReferenceTo . }\",\n\n        \"}\"\n      ].join('');\n    }\n//END condition for choosing ref quote or combo\n    var query = \"\"\n      var query = [\n          \"SELECT ?quotation ?source ?isInstanceOf ?quotation_text ?toplevel_expression_title ?author_title ?citation ?ref ?refText ?refType \",\n          \"WHERE {\",\n          structureElementTypeSparql,\n          \"?quotation <http://scta.info/property/structureElementType> ?refType . \",\n          \"?quotation a <http://scta.info/resource/expression> .\",\n          sourceUnion(),\n          expressionIdSparql,\n          quotationAuthorCoreSparql,\n          quotationWorkGroupSparql,\n          quotationWorkSparql,\n          quotationExpressionTypeSparql,\n          \"?quotation <http://scta.info/property/structureElementText> ?quotation_text .\",\n          \"?quotation <http://scta.info/property/isPartOfTopLevelExpression> ?toplevel_expression . \",\n          expressionTypeSparql,\n          workGroupSparql,\n          authorSparql,\n          \"?toplevel_expression <http://purl.org/dc/elements/1.1/title> ?toplevel_expression_title . \",\n          expressionAuthorCoreSparql,\n          \"OPTIONAL {\",\n            \"?quotation <http://scta.info/property/citation> ?citation . \",\n          \"}\",\n          \"OPTIONAL {\",\n            \"?ref <http://scta.info/property/isReferenceTo> ?quotation . \",\n            \"?ref <http://scta.info/property/structureElementText> ?refText . \",\n          \"}\",\n          expressionAuthorDateAfterSparqlFilter,\n          expressionAuthorDateBeforeSparqlFilter,\n          quotationAuthorDateAfterSparqlFilter,\n          quotationAuthorDateBeforeSparqlFilter,\n          \"FILTER (REGEX(STR(?quotation_text), '\" + searchText + \"', 'i')) .\",\n          \"}\",\n          \"ORDER BY ?quotation_text \",\n          \"LIMIT 100\"\n        ].join('');\n    dispatch(startQuotationsFetch());\n    axios.get(sparqlEndpoint, {params: {\"query\" : query, \"output\": \"json\"}}).then(function(res){\n      var results = res.data.results.bindings\n\n      dispatch(completeQuotationsFetch(results));\n    });\n  };\n}\n\n// Focused Quotation actions\nexport var changeQuotationsFocus = (id) => {\n  return{\n    type: \"CHANGE_QUOTATIONS_FOCUS\",\n    id\n  }\n}\n\nexport var clearFocusedQuotation = () => {\n  return{\n    type: \"CLEAR_FOCUSED_QUOTATION\"\n  }\n}\n\nexport var createFocusedQuotation = (quotation) => {\n  return{\n    type: \"CREATE_FOCUSED_QUOTATION\",\n    quotation\n  };\n};\n\n// Canonical Quotation\nexport var createCanonicalQuotation = (quotation) => {\n  return{\n    type: \"CREATE_CANONICAL_QUOTATION\",\n    quotation\n  };\n};\nexport var clearCanonicalQuotation = () => {\n  return{\n    type: \"CLEAR_CANONICAL_QUOTATION\"\n  };\n};\n\n\n// CanonicalQuotations (plural) Actions\nexport var changeCanonicalQuotationsFocus = (id) => {\n  return{\n    type: \"CHANGE_CANONICAL_QUOTATIONS_FOCUS\",\n    id\n  }\n}\nexport var clearCanonicalQuotationsFocus = () =>{\n  return{\n    type: \"CLEAR_CANONICAL_QUOTATIONS_FOCUS\",\n  }\n}\nexport var clearCanonicalQuotations = () => {\n  return{\n    type: \"CLEAR_CANONICAL_QUOTATIONS\"\n  };\n};\nexport var startCanonicalQuotationsFetch = () => {\n  return{\n    type: \"START_CANONICAL_QUOTATIONS_FETCH\"\n  };\n};\nexport var completeCanonicalQuotationsFetch = (canonicalQuotations) => {\n  return{\n    type: \"COMPLETE_CANONICAL_QUOTATIONS_FETCH\",\n    canonicalQuotations\n  };\n};\n\n\n//maifestation Quotations Actions\n// CanonicalQuotations (plural) Actions\nexport var changeManifestationQuotationsFocus = (id) => {\n  return{\n    type: \"CHANGE_MANIFESTATION_QUOTATIONS_FOCUS\",\n    id\n  }\n}\nexport var clearManifestationQuotationsFocus = () =>{\n  return{\n    type: \"CLEAR_MANIFESTATION_QUOTATIONS_FOCUS\",\n  }\n}\nexport var clearManifestationQuotations = () => {\n  return{\n    type: \"CLEAR_MANIFESTATION_QUOTATIONS\"\n  };\n};\nexport var startManifestationQuotationsFetch = () => {\n  return{\n    type: \"START_MANIFESTATION_QUOTATIONS_FETCH\"\n  };\n};\nexport var completeManifestationQuotationsFetch = (manifestationQuotations) => {\n  return{\n    type: \"COMPLETE_MANIFESTATION_QUOTATIONS_FETCH\",\n    manifestationQuotations\n  };\n};\nexport var fetchManifestationQuotations = () =>{\n  return (dispatch, getState) => {\n    var state = getState();\n    var searchText = state.search.searchParameters.searchText || \"\";\n\n    var query = \"\"\n\n    if (state.focusedQuotation.id != undefined){\n      var expressionQuotationId = state.focusedQuotation.id;\n      query = [\n            \"SELECT ?quotation ?isManifestationOf ?quotation_text ?canonicalTranscription \",\n            \"WHERE {\",\n            \"<\" + expressionQuotationId + \"> <http://scta.info/property/hasManifestation> ?quotation .\",\n            \"?quotation <http://scta.info/property/isManifestationOf> ?isManifestationOf .\",\n            \"?quotation <http://scta.info/property/structureElementText> ?quotation_text .\",\n            \"OPTIONAL\",\n            \"{\",\n              \"?quotation <http://scta.info/property/hasCanonicalTranscription> ?canonicalTranscription .\",\n            \"}\",\n            \"}\"\n          ].join('');\n    }\n    else{\n      query = [\n          \"SELECT ?quotation ?isManifestationOf ?quotation_text ?canonicalTranscription \",\n          \"WHERE {\",\n          \"?quotation <http://scta.info/property/structureElementType> <http://scta.info/resource/structureElementQuote> .\",\n          \"?quotation a <http://scta.info/resource/manifestation> .\",\n          \"?quotation <http://scta.info/property/isManifestationOf> ?isManifestationOf .\",\n          \"?quotation <http://scta.info/property/structureElementText> ?quotation_text .\",\n          \"OPTIONAL\",\n          \"{\",\n            \"?quotation <http://scta.info/property/hasCanonicalTranscription> ?canonicalTranscription .\",\n          \"}\",\n          \"FILTER (REGEX(STR(?quotation_text), '\" + searchText + \"', 'i')) .\",\n          \"}\",\n          \"ORDER BY ?isInstanceOf \",\n          \"LIMIT 100\"\n        ].join('');\n      }\n\n    dispatch(startManifestationQuotationsFetch());\n    axios.get(sparqlEndpoint, {params: {\"query\" : query, \"output\": \"json\"}}).then(function(res){\n      var results = res.data.results.bindings\n\n      dispatch(completeManifestationQuotationsFetch(results));\n    });\n  };\n}\n\n//paragraph actions\n\nexport var clearParagraph = () => {\n  return{\n    type: \"CLEAR_PARAGRAPH\"\n  };\n};\n\nexport var startParagraphFetch = () => {\n  return{\n    type: \"START_PARAGRAPH_FETCH\"\n  };\n};\nexport var completeParagraphFetch = (paragraph) => {\n  return{\n    type: \"COMPLETE_PARAGRAPH_FETCH\",\n    paragraph\n  };\n};\nexport var fetchParagraph = () =>{\n  return (dispatch, getState) => {\n    var state = getState();\n\n    if (state.focusedQuotation){\n      var quotationId = state.focusedQuotation.id;\n      //var expressionQuotationId = quotationid;\n      var query = \"\";\n      var idType = state.focusedQuotation.type\n\n      if (idType === \"expression\"){\n        query = [\n          \"CONSTRUCT\",\n          \"{\",\n            \"?expression_paragraph <http://scta.info/property/hasDefaultManifestation> ?manifestation_paragraph ;\",\n            \"<http://scta.info/property/hasManifestations> ?manifestations ;\",\n            \"<http://scta.info/property/hasDefaultTranscription> ?transcription_paragraph ;\",\n            \"<http://scta.info/property/isPartOfStructureItem> ?transcription_item ;\",\n            \"<http://scta.info/property/hasDocument> ?transcription_item_file ;\",\n            \"<http://scta.info/property/hasXML> ?xml_url .\",\n          \"}\",\n          \"WHERE { \",\n            \"<\" + quotationId + \"> <http://scta.info/property/isPartOfStructureBlock> ?expression_paragraph .\",\n            \"?expression_paragraph <http://scta.info/property/hasCanonicalManifestation> ?manifestation_paragraph .\",\n            \"?expression_paragraph <http://scta.info/property/hasManifestation> ?manifestations .\",\n            \"?manifestation_paragraph <http://scta.info/property/isManifestationOf> ?expression_paragraph .\",\n            \"?manifestation_paragraph <http://scta.info/property/hasCanonicalTranscription> ?transcription_paragraph .\",\n            \"?transcription_paragraph <http://scta.info/property/isPartOfStructureItem> ?transcription_item .\",\n            \"?transcription_item <http://scta.info/property/hasDocument> ?transcription_item_file .\",\n            \"?transcription_paragraph <http://scta.info/property/hasXML> ?xml_url .\",\n          \"}\"\n          ].join('');\n        }\n      else if (idType === \"manifestation\"){\n        query = [\n          \"CONSTRUCT\",\n          \"{\",\n            \"?expression_paragraph <http://scta.info/property/hasDefaultManifestation> ?manifestation_paragraph ;\",\n             \"<http://scta.info/property/hasManifestations> ?manifestations ;\",\n             \"<http://scta.info/property/hasDefaultTranscription> ?transcription_paragraph ;\",\n             \"<http://scta.info/property/isPartOfStructureItem> ?transcription_item ;\",\n             \"<http://scta.info/property/hasDocument> ?transcription_item_file ;\",\n             \"<http://scta.info/property/hasXML> ?xml_url .\",\n          \"}\",\n          \"WHERE { \",\n            \"<\" + quotationId + \"> <http://scta.info/property/isPartOfStructureBlock> ?manifestation_paragraph . \",\n            \"?manifestation_paragraph <http://scta.info/property/isManifestationOf> ?expression_paragraph .\",\n            \"?expression_paragraph <http://scta.info/property/hasManifestation> ?manifestations .\",\n            \"?manifestation_paragraph <http://scta.info/property/hasCanonicalTranscription> ?transcription_paragraph .\",\n            \"?transcription_paragraph <http://scta.info/property/isPartOfStructureItem> ?transcription_item .\",\n            \"?transcription_item <http://scta.info/property/hasDocument> ?transcription_item_file .\",\n            \"?transcription_paragraph <http://scta.info/property/hasXML> ?xml_url .\",\n          \"}\"\n        ].join('');\n      }\n\n      dispatch(startParagraphFetch());\n      axios.get(sparqlEndpoint, {params: {\"query\" : query, \"output\": \"json\"}}).then(function(res){\n        var results = res.data\n        if (results.hasXML){\n          axios.get(results.hasXML.replace(\"http://\", \"https://\")).then(function(res2){\n            var paragraph = {\n              expression_id: results[\"@id\"],\n              manifestations: results.hasManifestations,\n              manifestation_id: results.hasDefaultManifestation,\n              transcription_id: results.hasDefaultTranscription,\n              transcription_item_file: results.hasDocument.replace(\"http://\", \"https://\"),\n              paragraph_text: res2.data\n            }\n            dispatch(completeParagraphFetch(paragraph));\n            dispatch(fetchReview());\n          });\n        }\n      }).catch((err) => {\n        console.log(\"error:\", err)\n      })\n      ;\n    };\n  };\n};\nexport var startReviewFetch = () => {\n  return{\n    type: \"START_REVIEW_FETCH\"\n  };\n};\nexport var completeReviewFetch = (review) => {\n  return{\n    type: \"COMPLETE_REVIEW_FETCH\",\n    review\n  };\n};\nexport var fetchReview = () =>{\n  return (dispatch, getState) => {\n    var state = getState();\n\n    if (state.paragraph.transcription_item_file){\n      var url = state.paragraph.transcription_item_file;\n      var reviewUrl = \"https://dll-review-registry.scta.info/api/v1/reviews?url=\" + url + \"&society=MAA\";\n      dispatch(startReviewFetch());\n      axios.get(reviewUrl).then(function(res){\n        var review = res.data[0];\n        dispatch(completeReviewFetch(review));\n      });\n    };\n  };\n};\n\n//Source Paragraph Actions\n\nexport var clearSourceParagraph = () => {\n  return{\n    type: \"CLEAR_SOURCE_PARAGRAPH\"\n  };\n};\n\nexport var startSourceParagraphFetch = () => {\n  return{\n    type: \"START_SOURCE_PARAGRAPH_FETCH\"\n  };\n};\nexport var completeSourceParagraphFetch = (sourceParagraph) => {\n  return{\n    type: \"COMPLETE_SOURCE_PARAGRAPH_FETCH\",\n    sourceParagraph\n  };\n};\nexport var fetchSourceParagraph = () =>{\n  return (dispatch, getState) => {\n    var state = getState();\n\n    if (state.focusedQuotation){\n      var sourceParagraphid = state.focusedQuotation.source;\n      //var expressionQuotationId = quotationid;\n      var query = [\n        \"CONSTRUCT\",\n        \"{\",\n          \"?expression_paragraph <http://scta.info/property/hasDefaultManifestation> ?manifestation_paragraph ;\",\n           \"<http://scta.info/property/hasManifestations> ?manifestations ;\",\n           \"<http://scta.info/property/hasDefaultTranscription> ?transcription_paragraph ;\",\n           \"<http://scta.info/property/isPartOfStructureItem> ?transcription_item ;\",\n           \"<http://scta.info/property/hasDocument> ?transcription_item_file ;\",\n           \"<http://scta.info/property/hasXML> ?xml_url .\",\n        \"}\",\n          \"WHERE { \",\n          \"BIND(<\" + sourceParagraphid + \"> as ?expression_paragraph) .\",\n          \"?expression_paragraph <http://scta.info/property/hasCanonicalManifestation> ?manifestation_paragraph .\",\n          \"?expression_paragraph <http://scta.info/property/hasManifestation> ?manifestations .\",\n          \"?manifestation_paragraph <http://scta.info/property/hasCanonicalTranscription> ?transcription_paragraph .\",\n          \"?transcription_paragraph <http://scta.info/property/isPartOfStructureItem> ?transcription_item .\",\n          \"?transcription_item <http://scta.info/property/hasDocument> ?transcription_item_file .\",\n          \"?transcription_paragraph <http://scta.info/property/hasXML> ?xml_url .\",\n          \"}\"\n        ].join('');\n\n      dispatch(startSourceParagraphFetch());\n      axios.get(sparqlEndpoint, {params: {\"query\" : query, \"output\": \"json\"}}).then(function(res){\n        var results = res.data\n        if (results.hasXML){\n          axios.get(results.hasXML.replace(\"http://\", \"https://\")).then(function(res2){\n            var sourceParagraph = {\n              expression_id: results[\"@id\"],\n              manifestations: results.hasManifestations,\n              manifestation_id: results.hasDefaultManifestation,\n              transcription_id: results.hasDefaultTranscription,\n              transcription_item_file: results.hasDocument.replace(\"http://\", \"https://\"),\n              paragraph_text: res2.data\n            }\n            console.log(\"sourceP\", sourceParagraph)\n            dispatch(completeSourceParagraphFetch(sourceParagraph));\n          //dispatch(fetchSourceParagraphReview());\n          });\n        }\n      });\n    };\n  };\n};\nexport var startSourceParagraphReviewFetch = () => {\n  return{\n    type: \"START_SOURCE_PARAGRAPH_REVIEW_FETCH\"\n  };\n};\nexport var completeSourceParagraphReviewFetch = (review) => {\n  return{\n    type: \"COMPLETE_SOURCE_PARAGRAPH_FETCH\",\n    review\n  };\n};\nexport var fetchSourceParagraphReview = () =>{\n  return (dispatch, getState) => {\n    var state = getState();\n\n    if (state.sourceParagraph.transcription_item_file){\n      var url = state.sourceParagraph.transcription_item_file;\n      var reviewUrl = \"https://dll-review-registry.scta.info/api/v1/reviews?url=\" + url + \"&society=MAA\";\n      dispatch(startSourceParagraphFetch());\n      axios.get(reviewUrl).then(function(res){\n        var review = res.data[0];\n        dispatch(completeSourceParagraphReviewFetch(review));\n      });\n    };\n  };\n};\n\n// Full text actions\n\n//paragraph actions\n\nexport var toggleFullTextDisplay = (current) => {\n  return{\n    type: \"TOGGLE_FULL_TEXT_DISPLAY\",\n    current\n  };\n}\nexport var clearFullText = () => {\n  return{\n    type: \"CLEAR_FULL_TEXT\"\n  };\n};\n\nexport var startFullTextFetch = () => {\n  return{\n    type: \"START_FULL_TEXT_FETCH\"\n  };\n};\nexport var completeFullTextFetch = (text) => {\n  return{\n    type: \"COMPLETE_FULL_TEXT_FETCH\",\n    text\n  };\n};\nexport var fetchFullText = (source=false) =>{\n  return (dispatch, getState) => {\n    var state = getState();\n    var query = \"\";\n    if (state.focusedQuotation){\n      var quotationId = state.focusedQuotation.id;\n      //var expressionQuotationId = quotationid;\n      var idType = state.focusedQuotation.type\n\n      if (source === true){\n        query = [\n          \"SELECT ?expression_item ?manifestation_item ?transcription_item ?xml_url ?transcription_item_file \",\n          \"WHERE { \",\n          \"BIND(<\" + state.focusedQuotation.source + \"> AS ?expression_block) .\",\n          \"?expression_block <http://scta.info/property/isPartOfStructureItem> ?expression_item .\",\n          \"?expression_item <http://scta.info/property/hasCanonicalManifestation> ?manifestation_item .\",\n          \"?manifestation_item <http://scta.info/property/hasCanonicalTranscription> ?transcription_item .\",\n          \"?transcription_item <http://scta.info/property/hasDocument> ?transcription_item_file .\",\n          \"?transcription_item <http://scta.info/property/hasXML> ?xml_url .\",\n          \"}\"\n        ].join('');\n      }\n      else if (idType === \"expression\"){\n        query = [\n            \"SELECT ?expression_item ?manifestation_item ?transcription_item ?xml_url ?transcription_item_file \",\n            \"WHERE { \",\n            \"<\" + quotationId + \"> <http://scta.info/property/isPartOfStructureBlock> ?expression_block .\",\n            \"?expression_block <http://scta.info/property/isPartOfStructureItem> ?expression_item .\",\n            \"?expression_item <http://scta.info/property/hasCanonicalManifestation> ?manifestation_item .\",\n            \"?manifestation_item <http://scta.info/property/hasCanonicalTranscription> ?transcription_item .\",\n            \"?transcription_item <http://scta.info/property/hasDocument> ?transcription_item_file .\",\n            \"?transcription_item <http://scta.info/property/hasXML> ?xml_url .\",\n            \"}\"\n          ].join('');\n        }\n      else if (idType === \"manifestation\"){\n        query = [\n            \"SELECT ?expression_item ?manifestation_item ?transcription_item ?xml_url ?transcription_item_file \",\n            \"WHERE { \",\n            \"<\" + quotationId + \"> <http://scta.info/property/isPartOfStructureBlock> ?manifestation_block . \",\n            \"?manifestation_block <http://scta.info/property/isPartOfStructureItem> ?manifestation_item .\",\n            \"?manifestation_item <http://scta.info/property/isManifestationOf> ?expression_item .\",\n            \"?manifestation_item <http://scta.info/property/hasCanonicalTranscription> ?transcription_item .\",\n            \"?transcription_item <http://scta.info/property/hasDocument> ?transcription_item_file .\",\n            \"?transcription_item <http://scta.info/property/hasXML> ?xml_url .\",\n            \"}\"\n          ].join('');\n      }\n      dispatch(startFullTextFetch());\n      axios.get(sparqlEndpoint, {params: {\"query\" : query, \"output\": \"json\"}}).then(function(res){\n        var results = res.data.results.bindings[0];\n        axios.get(results.xml_url.value.replace(\"http://\", \"https://\")).then(function(res2){\n          var text = {\n            expression_id: results.expression_item.value,\n            manifestation_id: results.manifestation_item.value,\n            transcription_id: results.transcription_item.value,\n            transcription_item_file: results.transcription_item_file ? results.transcription_item_file.value.replace(\"http://\", \"https://\") : \"\",\n            text: res2.data\n          }\n          dispatch(completeFullTextFetch(text));\n          dispatch(fetchReview());\n        });\n      });\n    };\n  };\n};\n","var test =  {\n  \"handlers\": {\n    \"eg\": [\"<pre>\",\"</pre>\"],\n    // inserts a link inside <ptr> using the @target; the link in the\n    // @href is piped through the rw (rewrite) function before insertion\n    \"ptr\": [\"<a href=\\\"$rw@target\\\">$@target</a>\"],\n    // wraps the content of the <ref> in an HTML link\n    //\"ref\": [\"<a href=\\\"$rw@target\\\">\",\"</a>\"],\n    \"graphic\": function(elt) {\n      let content = new Image();\n      content.src = this.rw(elt.getAttribute(\"url\"));\n      if (elt.hasAttribute(\"width\")) {\n        content.width = elt.getAttribute(\"width\").replace(/[^.0-9]/g, \"\");\n      }\n      if (elt.hasAttribute(\"height\")) {\n        content.height = elt.getAttribute(\"height\").replace(/[^.0-9]/g, \"\");\n      }\n      return content;\n    },\n    \"list\": function(elt) {\n      if (elt.hasAttribute(\"type\") && elt.getAttribute(\"type\") == \"gloss\") {\n        let dl = document.createElement(\"dl\");\n        for (let child of Array.from(elt.children)) {\n          if (child.nodeType == Node.ELEMENT_NODE) {\n            if (child.localName == \"tei-label\") {\n              let dt = document.createElement(\"dt\");\n              dt.innerHTML = child.innerHTML;\n              dl.appendChild(dt);\n            }\n            if (child.localName == \"tei-item\") {\n              let dd = document.createElement(\"dd\");\n              dd.innerHTML = child.innerHTML;\n              dl.appendChild(dd);\n            }\n          }\n        }\n        return dl;\n      } else {\n        return null;\n      }\n    },\n    \"table\": function(elt) {\n      let table = document.createElement(\"table\");\n      table.innerHTML = elt.innerHTML;\n      if (table.firstElementChild.localName == \"tei-head\") {\n        let head = table.firstElementChild;\n        head.remove();\n        let caption = document.createElement(\"caption\");\n        caption.innerHTML = head.innerHTML;\n        table.appendChild(caption);\n      }\n      for (let row of Array.from(table.querySelectorAll(\"tei-row\"))) {\n        let tr = document.createElement(\"tr\");\n        tr.innerHTML = row.innerHTML;\n        for (let attr of Array.from(row.attributes)) {\n          tr.setAttribute(attr.name, attr.value);\n        }\n        row.parentElement.replaceChild(tr, row);\n      }\n      for (let cell of Array.from(table.querySelectorAll(\"tei-cell\"))) {\n        let td = document.createElement(\"td\");\n        if (cell.hasAttribute(\"cols\")) {\n          td.setAttribute(\"colspan\", cell.getAttribute(\"cols\"));\n        }\n        td.innerHTML = cell.innerHTML;\n        for (let attr of Array.from(cell.attributes)) {\n          td.setAttribute(attr.name, attr.value);\n        }\n        cell.parentElement.replaceChild(td, cell);\n      }\n      return table;\n    },\n    \"egXML\": function(elt) {\n      let pre = document.createElement(\"pre\");\n      pre.innerHTML = this.serialize(elt, true);\n      return pre;\n    }\n  }\n}\nmodule.exports = test;\n","import React from 'react';\nimport Form from 'react-bootstrap/Form';\nimport Button from 'react-bootstrap/Button';\nvar {connect} = require('react-redux');\nvar actions = require('../actions/actions');\n\nclass Search extends React.Component{\n  constructor(props){\n    super(props)\n    this.handleSetSearchText = this.handleSetSearchText.bind(this)\n    this.handleOnShowQuotationsWithoutAssociation = this.handleOnShowQuotationsWithoutAssociation.bind(this)\n    this.handleRunQuery = this.handleRunQuery.bind(this)\n    this.handleGraph = this.handleGraph.bind(this)\n    this.handleClearFilters = this.handleClearFilters.bind(this)\n  }\n  handleSetSearchText(e){\n    var {dispatch, search} = this.props;\n    var searchText = this.refs.searchText.value;\n    var searchParameters = {\n      ...this.props.search.searchParameters,\n      searchText\n    }\n    dispatch(actions.setSearchParameters(searchParameters));\n  }\n  handleOnShowQuotationsWithoutAssociation(e){\n\t\te.preventDefault();\n\t\tvar {dispatch, search} = this.props;\n    //var searchText = this.refs.searchText.value;\n    var quotationWorkGroup = this.refs.quotationWorkGroup.value;\n    var quotationExpressionType = this.refs.quotationExpressionType.value;\n    var quotationWork = this.refs.quotationWork.value;\n    var quotationWorkPart = this.refs.quotationWorkPart.value\n    var expressionId = this.refs.expressionId.value;\n    var expressionPart = this.refs.expressionPart.value ? this.refs.expressionPart.value.split(\"/\")[0] : this.refs.expressionPart.value\n    var expressionLevel = this.refs.expressionPart.value ? this.refs.expressionPart.value.split(\"/\")[1] : 1 ;\n    var expressionAuthor = this.refs.expressionAuthor.value;\n    var expressionAuthorType = this.refs.expressionAuthorType.value;\n    var quotationAuthor = this.refs.quotationAuthor.value;\n    var quotationAuthorType = this.refs.quotationAuthorType.value;\n    var expressionType = this.refs.expressionType.value;\n    var workGroup = this.refs.workGroup.value;\n    var quotationAuthorDateAfter = this.refs.quotationAuthorDateAfter.value;\n    var quotationAuthorDateBefore = this.refs.quotationAuthorDateBefore.value;\n    var expressionAuthorDateAfter = this.refs.expressionAuthorDateAfter.value;\n    var expressionAuthorDateBefore = this.refs.expressionAuthorDateBefore.value;\n    var structureElementType = this.refs.structureElementType.value;\n\n    //var retainCanonical = this.refs.retainCanonical.checked;\n    var searchParameters = {\n      //searchText,\n      expressionId,\n      expressionPart,\n      expressionLevel,\n      expressionAuthor,\n      quotationAuthor,\n      quotationExpressionType,\n      quotationWork,\n      quotationWorkPart,\n      quotationWorkGroup,\n      quotationAuthorType,\n      expressionAuthorType,\n      expressionType,\n      workGroup,\n      quotationAuthorDateAfter,\n      quotationAuthorDateBefore,\n      expressionAuthorDateAfter,\n      expressionAuthorDateBefore,\n      structureElementType\n\n    }\n\n    dispatch(actions.setSearchParameters(searchParameters));\n    //search filters options update\n    dispatch(actions.fetchQuotationWorkParts());\n    dispatch(actions.fetchExpressionParts());\n    dispatch(actions.fetchSearchWorksList());\n    dispatch(actions.fetchQuotationWorksList());\n    dispatch(actions.fetchQuotationAuthors());\n    dispatch(actions.fetchExpressionAuthors());\n    //fetch expression types, should adjust based on types that would apply for a select work group author or expression\n    // there are no filters for this yet\n    //dispatch(actions.fetchExpressionTypes());\n\n    // actually quotation query Actions\n    // comment these out, if you want to add search button and turn off automatic\n    // on change search <button id=\"runQuery\" onClick={this.handleRunQuery}>Search</button>\n\n      // if (!retainCanonical) dispatch(actions.clearCanonicalQuotation());\n  \t\t// dispatch(actions.clearFocusedQuotation());\n  \t\t// dispatch(actions.clearParagraph());\n  \t\t// if (!retainCanonical) dispatch(actions.fetchCanonicalQuotations());\n  \t\t// dispatch(actions.fetchQuotations());\n  \t\t// dispatch(actions.clearManifestationQuotations());\n      // dispatch(actions.fetchChart());\n    }\n  handleRunQuery(e){\n\t\te.preventDefault();\n    var {dispatch, search} = this.props;\n\t\t// var searchText = this.refs.searchText.value;\n    // var quotationWorkGroup = this.refs.quotationWorkGroup.value;\n    // var quotationWork = this.refs.quotationWork.value;\n    // var quotationWorkPart = this.refs.quotationWorkPart.value\n    // var expressionId = this.refs.expressionId.value;\n    // var expressionPart = this.refs.expressionPart.value ? this.refs.expressionPart.value.split(\"/\")[0] : this.refs.expressionPart.value\n    // var expressionLevel = this.refs.expressionPart.value ? this.refs.expressionPart.value.split(\"/\")[1] : 1 ;\n    // var expressionAuthor = this.refs.expressionAuthor.value;\n    // var expressionAuthorType = this.refs.expressionAuthorType.value;\n    // var quotationAuthor = this.refs.quotationAuthor.value;\n    // var quotationAuthorType = this.refs.quotationAuthorType.value;\n    // var expressionType = this.refs.expressionType.value;\n    // var quotationExpressionType = this.refs.quotationExpressionType.value;\n    // var workGroup = this.refs.workGroup.value;\n\n    //var retainCanonical = this.refs.retainCanonical.checked;\n    var retainCanonical = false;\n    // var searchParameters = {\n    //   searchText,\n    //   expressionId,\n    //   expressionPart,\n    //   expressionLevel,\n    //   expressionAuthor,\n    //   quotationAuthor,\n    //   quotationExpressionType,\n    //   quotationWork,\n    //   quotationWorkPart,\n    //   quotationWorkGroup,\n    //   quotationAuthorType,\n    //   expressionAuthorType,\n    //   expressionType,\n    //   workGroup\n    // }\n\n    \n    //TODO: delete; because canonical is not used any more\n\n    // if (!retainCanonical) dispatch(actions.clearCanonicalQuotation());\n\t\t\n    dispatch(actions.clearFocusedQuotation());\n    dispatch(actions.clearManifestationQuotations());\n\t\tdispatch(actions.clearParagraph());\n    dispatch(actions.clearSourceParagraph());\n\t\t\n    //TODO: delete; because canonical is not used any more\n    //if (!retainCanonical) dispatch(actions.fetchCanonicalQuotations());\n\t\t\n    dispatch(actions.fetchQuotations());\n\t\tdispatch(actions.fetchChart());\n\t}\n  handleClearFilters(e){\n    e.preventDefault();\n    var {dispatch, search} = this.props;\n    dispatch(actions.clearSearchParameters());\n    dispatch(actions.clearCanonicalQuotations());\n    dispatch(actions.clearQuotations());\n    dispatch(actions.fetchQuotationWorkParts());\n    dispatch(actions.fetchExpressionParts());\n    //dispatch(actions.fetchCanonicalQuotations());\n    dispatch(actions.fetchQuotationAuthors());\n    dispatch(actions.fetchExpressionAuthors());\n    dispatch(actions.fetchSearchWorksList());\n    //store.dispatch(actions.fetchExpressionTypes());\n    dispatch(actions.fetchQuotationWorksList());\n    dispatch(actions.fetchWorkGroups());\n    dispatch(actions.fetchAuthorTypes());\n    //dispatch(actions.fetchManifestationQuotations(searchText, quotationType, expressionId));\n    dispatch(actions.clearManifestationQuotations());\n    dispatch(actions.clearParagraph());\n    dispatch(actions.clearSourceParagraph());\n    this.refs.quotationAuthorDateAfter.value = \"\";\n    this.refs.quotationAuthorDateBefore.value = \"\";\n    this.refs.expressionAuthorDateAfter.value = \"\";\n    this.refs.expressionAuthorDateBefore.value = \"\";\n    this.refs.searchText.value = \"\";\n\n\n\n  }\n  handleGraph(e){\n\t\te.preventDefault();\n\t\tvar {dispatch} = this.props;\n\t\tdispatch(actions.toggleGraphDisplay(this.props.chart.visible));\n\t}\n\trender(){\n    var _this = this;\n    function displaySearchWorksList(){\n      var searchWorks = _this.props.search.searchWorks;\n      return searchWorks.map((work) => {\n        return(\n          <option value={work.expressionShortId}>{work.expressionTitle}</option>\n          )\n        }\n      )\n    }\n    function displayQuotationWorksList(){\n      var quotationWorksList = _this.props.search.quotationWorksList;\n      return quotationWorksList.map((work) => {\n        var id = work.expressionShortId ? work.expressionShortId : work.expression.split(\"http://scta.info/resource/\")[1];\n        return(\n          <option value={id}>{work.expressionTitle}</option>\n          )\n        }\n      )\n    }\n    function displayQuotationWorkPartsParent(){\n      var quotationWorkParts = _this.props.search.quotationWorkParts;\n      if (quotationWorkParts){\n        var part = quotationWorkParts[0];\n        if (part){\n          var parentid = part.parent.split(\"http://scta.info/resource/\")[1];\n          return(\n            <option value={parentid}>Current: {part.parent_title}</option>\n          )\n        }\n      }\n    }\n    function displayQuotationWorkPartsGrandparent(){\n      var quotationWorkParts = _this.props.search.quotationWorkParts;\n      if (quotationWorkParts){\n        var part = quotationWorkParts[0];\n        if (part){\n          var grandparentid = part.grandparent.split(\"http://scta.info/resource/\")[1];\n          if (grandparentid != undefined){\n            return(\n              <option value={grandparentid}>Up: {part.grandparent_title}</option>\n            )\n          }\n        }\n      }\n    }\n    function displayQuotationWorkParts(){\n      var quotationWorkParts = _this.props.search.quotationWorkParts;\n      if (quotationWorkParts){\n        return quotationWorkParts.map((part) => {\n          var id = part.childShortId ? part.childShortId : part.child.split(\"http://scta.info/resource/\")[1];\n          if (part.child){\n            return(\n              <option value={id}>{part.child_title}</option>\n              )\n            }\n          }\n        )\n      }\n    }\n    function displayExpressionPartsParent(){\n      var expressionParts = _this.props.search.expressionParts;\n      if (expressionParts){\n        var part = expressionParts[0];\n        if (part){\n          var parentid = part.parent.split(\"http://scta.info/resource/\")[1];\n          return(\n            <option value={parentid+ \"/\" + part.parent_level}>Current: {part.parent_title}</option>\n          )\n        }\n      }\n    }\n    function displayExpressionPartsGrandparent(){\n      var expressionParts = _this.props.search.expressionParts;\n      if (expressionParts){\n        var part = expressionParts[0];\n        if (part){\n          var grandparentid = part.grandparent.split(\"http://scta.info/resource/\")[1];\n          if (grandparentid != undefined){\n            return(\n              <option value={grandparentid + \"/\" + part.grandparent_level}>Up: {part.grandparent_title}</option>\n            )\n          }\n        }\n      }\n    }\n    function displayExpressionParts(){\n      var expressionParts = _this.props.search.expressionParts;\n      if (expressionParts){\n        return expressionParts.map((part) => {\n          var id = part.childShortId ? part.childShortId : part.child.split(\"http://scta.info/resource/\")[1];\n          if (part.child){\n            return(\n              <option value={id + \"/\" + part.child_level}>{part.child_title}</option>\n              )\n            }\n          }\n        )\n      }\n    }\n\n    function displayQuotationAuthorsList(){\n      var authors = _this.props.search.quotationAuthors;\n      return authors.map((author) => {\n        return(\n          <option value={author.authorShortId}>{author.authorTitle}</option>\n          )\n        }\n      )\n    }\n    function displayExpressionAuthorsList(){\n      var authors = _this.props.search.expressionAuthors;\n      return authors.map((author) => {\n        return(\n          <option value={author.authorShortId}>{author.authorTitle}</option>\n          )\n        }\n      )\n    }\n    function displayExpressionTypeList(){\n      var expressionTypes = _this.props.search.expressionTypes;\n      return expressionTypes.map((type) => {\n        return(\n          <option value={type.expressionTypeShortId}>{type.expressionTypeTitle}</option>\n          )\n        }\n      )\n    }\n    function displayQuotationExpressionTypeList(){\n      var quotationExpressionTypes = _this.props.search.quotationExpressionTypes;\n      return quotationExpressionTypes.map((type) => {\n        return(\n          <option value={type.quotationExpressionTypeShortId}>{type.quotationExpressionTypeTitle}</option>\n          )\n        }\n      )\n    }\n    function displayWorkGroupsList(){\n      var workGroups = _this.props.search.workGroups;\n      return workGroups.map((workGroup) => {\n        return(\n          <option value={workGroup.workGroupShortId}>{workGroup.workGroupTitle}</option>\n          )\n        }\n      )\n    }\n    function displayQuotationAuthorTypes(){\n      const authorTypes = _this.props.search.authorTypes;\n      return authorTypes.map((authorType) => {\n        return(\n          <option value={authorType.authorTypeShortId}>{authorType.authorTypeTitle}</option>\n          )\n        }\n      )\n    }\n    function displayExpressionAuthorTypes(){\n      const authorTypes = _this.props.search.authorTypes;\n      return authorTypes.map((authorType) => {\n        return(\n          <option value={authorType.authorTypeShortId}>{authorType.authorTypeTitle}</option>\n          )\n        }\n      )\n    }\n    return(\n      <div>\n        <Form onSubmit={this.handleOnShowQuotationsWithoutAssociation}>\n          <div>\n\n            <div>\n              {\n                // turn this on, if you want  add search button turn off automatic\n                // on change search\n                <Button id=\"runQuery\" onClick={this.handleRunQuery}>Run Search</Button>\n              }\n\n              <Button id=\"clearFilter\" onClick={this.handleClearFilters}>Clear Filters</Button>\n            </div>\n            {\n              /*<div>\n              <label><input id=\"checkbox1\" ref=\"retainCanonical\" type=\"checkbox\"/>Restrict to Can. Quotation</label>\n            </div>\n            */\n            }\n            <div>\n            <p>Search Parameters</p>\n            <Form.Group>\n              <Form.Label>Quotation/ReferenceType</Form.Label>\n              <Form.Control as=\"select\" ref=\"structureElementType\" onChange={this.handleOnShowQuotationsWithoutAssociation}>\n                <option value=\"structureElementQuote\">Quotations</option>\n                <option value=\"structureElementRef\">References</option>\n                <option value=\"structureElementRefDup\">References (With Quotation Overlap)</option>\n                <option value=\"\">All</option>\n                <option value=\"allDup\">All (with quotation overlap)</option>\n              </Form.Control>\n            </Form.Group>\n            <Form.Group>\n              <Form.Label>\n                <Form.Control as=\"input\" type=\"text\" ref=\"searchText\" placeholder=\"search quotation text\" onChange={this.handleSetSearchText}/>\n              </Form.Label>\n            </Form.Group>\n            <hr/>\n            <p>Quotation Parameters</p>\n            <Form.Group>\n            <Form.Label>Quotation Author Type</Form.Label>\n              <Form.Control as=\"select\" ref=\"quotationAuthorType\" onChange={this.handleOnShowQuotationsWithoutAssociation}>\n                <option value=\"\">All</option>\n                {displayQuotationAuthorTypes()}\n              </Form.Control>\n\n            </Form.Group>\n            <Form.Group>\n              <Form.Label>Quotation Author Birth Date</Form.Label>\n              <br/>\n              After <Form.Control as=\"input\" ref=\"quotationAuthorDateAfter\" onBlur={this.handleOnShowQuotationsWithoutAssociation} placeholder=\"e.g. 1200\"/>\n              <br/>\n              Before <Form.Control as=\"input\" ref=\"quotationAuthorDateBefore\" onBlur={this.handleOnShowQuotationsWithoutAssociation} placeholder=\"e.g. 1400\"/>\n            </Form.Group>\n            <Form.Group>\n              <Form.Label>Quotation Author</Form.Label>\n              <Form.Control as=\"select\" ref=\"quotationAuthor\" onChange={this.handleOnShowQuotationsWithoutAssociation} value={_this.props.search.searchParameters.quotationAuthor}>\n                <option value=\"\">All</option>\n                {displayQuotationAuthorsList()}\n              </Form.Control>\n            </Form.Group>\n            <Form.Group>\n              <Form.Label>Quotation Work Group</Form.Label>\n                <Form.Control as=\"select\" ref=\"quotationWorkGroup\" onChange={this.handleOnShowQuotationsWithoutAssociation}>\n                  <option value=\"\">All</option>\n                  {displayWorkGroupsList()}\n                </Form.Control>\n\n            </Form.Group>\n            <Form.Group>\n              <Form.Label>Quotation Text Type</Form.Label>\n                <Form.Control as=\"select\" ref=\"quotationExpressionType\" onChange={this.handleOnShowQuotationsWithoutAssociation}>\n                  <option value=\"\">All</option>\n                  {displayQuotationExpressionTypeList()}\n                </Form.Control>\n            </Form.Group>\n            <Form.Group>\n              <Form.Label>Quotation Text Title</Form.Label>\n                <Form.Control as=\"select\" ref=\"quotationWork\" onChange={this.handleOnShowQuotationsWithoutAssociation} value={_this.props.search.searchParameters.quotationWork}>\n                  <option value=\"\">All</option>\n                  {displayQuotationWorksList()}\n                </Form.Control>\n            </Form.Group>\n            <Form.Group>\n              <Form.Label>Quotation Text Part</Form.Label>\n                <Form.Control as=\"select\" ref=\"quotationWorkPart\" onChange={this.handleOnShowQuotationsWithoutAssociation} value={_this.props.search.searchParameters.quotationWorkPart}>\n                  <option value=\"\">All</option>\n                  {displayQuotationWorkPartsGrandparent()}\n                  {displayQuotationWorkPartsParent()}\n                  {displayQuotationWorkParts()}\n                </Form.Control>\n            </Form.Group>\n            <hr/>\n            <p>Text Parameters</p>\n            <Form.Group>\n              <Form.Label>Text Author Type</Form.Label>\n              <Form.Control as=\"select\" ref=\"expressionAuthorType\" onChange={this.handleOnShowQuotationsWithoutAssociation}>\n                <option value=\"\">All</option>\n                {displayExpressionAuthorTypes()}\n              </Form.Control>\n            </Form.Group>\n            <Form.Group>\n              <Form.Label>Text Author Birth Date</Form.Label>\n              <br/>\n              After <Form.Control as=\"input\" ref=\"expressionAuthorDateAfter\" onBlur={this.handleOnShowQuotationsWithoutAssociation} placeholder=\"e.g. 1200\"/>\n              <br/>\n              Before <Form.Control as=\"input\" ref=\"expressionAuthorDateBefore\" onBlur={this.handleOnShowQuotationsWithoutAssociation} placeholder=\"e.g. 1400\"/>\n            </Form.Group>\n            <Form.Group>\n              <Form.Label>Text Author</Form.Label>\n                <Form.Control as=\"select\" ref=\"expressionAuthor\" onChange={this.handleOnShowQuotationsWithoutAssociation} value={_this.props.search.searchParameters.expressionAuthor}>\n                  <option value=\"\">All</option>\n                  {displayExpressionAuthorsList()}\n                </Form.Control>\n            </Form.Group>\n            <Form.Group>\n              <Form.Label>Text Work Group</Form.Label>\n                <Form.Control as=\"select\" ref=\"workGroup\" onChange={this.handleOnShowQuotationsWithoutAssociation}>\n                  <option value=\"\">All</option>\n                  {displayWorkGroupsList()}\n                </Form.Control>\n            </Form.Group>\n            <Form.Group>\n              <Form.Label>Text Type</Form.Label>\n                <Form.Control as=\"select\" ref=\"expressionType\" onChange={this.handleOnShowQuotationsWithoutAssociation}>\n                  <option value=\"\">All</option>\n                  {displayExpressionTypeList()}\n                </Form.Control>\n            </Form.Group>\n            <Form.Group>\n              <Form.Label>Text Title</Form.Label>\n                <Form.Control as=\"select\" ref=\"expressionId\" onChange={this.handleOnShowQuotationsWithoutAssociation} value={_this.props.search.searchParameters.expressionId}>\n                  <option value=\"\">All</option>\n                  {displaySearchWorksList()}\n                </Form.Control>\n            </Form.Group>\n            <Form.Group>\n              <Form.Label>Text Part</Form.Label>\n              <Form.Control as=\"select\" ref=\"expressionPart\" onChange={this.handleOnShowQuotationsWithoutAssociation} value={_this.props.search.searchParameters.expressionPart + \"/\" + _this.props.search.searchParameters.expressionLevel}>\n                <option value=\"\">All</option>\n                {displayExpressionPartsGrandparent()}\n                {displayExpressionPartsParent()}\n                {displayExpressionParts()}\n              </Form.Control>\n            </Form.Group>\n            </div>\n          </div>\n        </Form>\n        <p><a href=\"#\" onClick={this.handleGraph}>Toggle Historgram</a></p>\n      </div>\n\n\n\t\t)\n\t}\n}\n\nexport default connect(\n  (state) => {\n\t\treturn state\n\t}\n)(Search);\n","import React from 'react'\nimport $ from 'jquery';\nvar {connect} = require('react-redux');\nvar actions = require('../actions/actions');\n\n\n\nclass Quotation extends React.Component{\n\tconstructor(props){\n\t\tsuper(props)\n\t\tthis.handleOnClick = this.handleOnClick.bind(this)\n\t}\n\thandleOnClick(){\n\t\tvar {isInstanceOf, id, quotation, dispatch, source} = this.props;\n\t\tdispatch(actions.changeQuotationsFocus(this.props.id));\n\t\tvar newFocusedQuotationObject = {\n\t\t\tid,\n\t\t\tquotation,\n\t\t\tsource,\n\t\t\ttype: \"expression\"\n\t\t}\n\t\t// example of why all these different dispatches called here might be a problem\n\t\t//fetchParagraph() requires that the createFocusedQuotation() is set.\n\t\t//seems to be working as is, but i'm not sure if this is the best way\n\t\tdispatch(actions.createFocusedQuotation(newFocusedQuotationObject));\n\t\tdispatch(actions.fetchParagraph());\n\t\tdispatch(actions.fetchSourceParagraph());\n\t\t//dispatch(actions.fetchSourceParagraph());\n\t\t//this fetch also seems to rely on focusedQuotation state being set.\n\t\t// seems to work as is though\n\t\tdispatch(actions.fetchManifestationQuotations());\n\n\n\t\tif (isInstanceOf != null){\n\t\t\t// create canonicalQuotation\n\t\t\tvar canonicalQuotationObject = this.props.canonicalQuotations.find((quotation) => {\n\t\t\t\treturn quotation.id === isInstanceOf\n\n\t\t\t});\n\n\t\t\tif (canonicalQuotationObject != undefined){\n\t\t\t\tdispatch(actions.createCanonicalQuotation(canonicalQuotationObject));\n\t\t\t\t// focus canonicalquotation List Item\n\t\t\t\tdispatch(actions.changeCanonicalQuotationsFocus(isInstanceOf));\n\t\t\t\t// scroll\n\t\t\t\tvar topPos = document.getElementById(isInstanceOf).offsetTop;\n\t\t\t\t$('#CanonicalQuotationList').animate({ scrollTop: topPos-10 }, 400);\n\t\t\t\t//scroll self to top\n\t\t\t\tvar selfTopPos = document.getElementById(id).offsetTop;\n\t\t\t\t$('#quotationsList').animate({ scrollTop: selfTopPos-10 }, 400);\n\t\t\t}\n\t\t\telse{\n\t\t\t\talert(\"this quotation is assigned to a canonicalQuotation, but either there is an error in the id assigned or a canonicalQuotation record still needs to be made\")\n\t\t\t\tdispatch(actions.clearCanonicalQuotationsFocus());\n\t\t\t\tdispatch(actions.clearCanonicalQuotation());\n\t\t\t}\n\n\t\t}\n\t\telse{\n\t\t\tdispatch(actions.clearCanonicalQuotationsFocus());\n\t\t\tdispatch(actions.clearCanonicalQuotation());\n\n\t\t}\n\n\n\n\t}\n\trender(){\n\n\t\tvar {isInstanceOf, quotation, className, title, author, id, refText, citation} = this.props;\n\n\t\tvar className = isInstanceOf === null ? className + \" isNotInstance\" : className;\n\n\t\treturn(\n\t\t\t<div className=\"quotation-wrapper\">\n\t\t\t\t<p id={id} className={className} onClick={this.handleOnClick}>\n\t\t\t\t{quotation}\n\t\t\t\t</p>\n\t\t\t\t<a href={id} target=\"_blank\" className=\"quotation-citation\">{author}, {title}</a>\n\t\t\t\t<a href={id} target=\"_blank\" className=\"quotation-citation\">Original Ref: {refText}</a>\n\t\t\t\t<a href={id} target=\"_blank\" className=\"quotation-citation\">Modern Citation: {citation}</a>\n\t\t\t</div>\n\n\n\t\t)\n\t}\n}\n\nexport default connect(\n\t(state) => {\n\t\treturn state\n\t}\n)(Quotation);\n","import React from 'react';\nimport {connect} from 'react-redux';\n\nimport Quotation from \"./Quotation\"\n\nclass QuotationList extends React.Component{\n\trender(){\n    var {quotations, focusedQuotation} = this.props;\n    var renderQuotations = () => {\n\t\t\tif (quotations === \"fetching\"){\n\t\t\t\treturn <p>Fetching...</p>\n\t\t\t}\n\t\t\telse if (quotations.length === 0){\n        return(\n            <p className=\"container__message\">No Quotations</p>\n        );\n      }\n\t\t\telse {\n\t\t\t\treturn quotations.map( (quotation, idx) => {\n\t\t\t\t\t//var quotationClass = quotation.focused ? \"quotation focused\" : \"quotation\"\n\t\t\t\t\tlet quotationClass = \"\"\n\t\t\t\t\tif (focusedQuotation.id){\n\t\t\t\t\t\tif (focusedQuotation.id.includes(quotation.id)){\n\t\t\t\t\t\t\tquotationClass = \"quotation focused\"\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tquotationClass = \"quotation\"\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tquotationClass = \"quotation\"\n\t\t\t\t\t}\n\t\t\t\t\tvar refType = quotation.refType\n\t\t\t\t\tvar classes = quotationClass + \" \" + quotation.refType\n\t\t\t\t\t\n          //NOTE: in the return statement below react complains of duplicate keys with out the addition of the ids\n          //this could suggest duplicate quotation results. But I don't see any duplicates at the moment\n          //adding the idx removes the warning; but the reason for the warning is still unclear.\n\t        return (\n\n\t          <Quotation className={classes} key={idx + \"-\" + quotation.id} {...quotation}/>\n\t        );\n\t      });\n\t\t\t}\n    };\n\n\t\treturn(\n\t\t\t<div>\n\t\t\t\t<p>List of Expression Quotations</p>\n\t\t\t\t{this.props.quotations !== \"fetching\" && <p>Count {quotations.length}</p>}\n\t\t\t\t{renderQuotations()}\n\t\t\t</div>\n\t\t)\n\t}\n}\n\nexport default connect(\n\t(state) => {\n\t\treturn state\n\t}\n)(QuotationList);\n","import React from 'react'\nvar {connect} = require('react-redux');\n\nclass FocusedQuotation extends React.Component{\n\trender(){\n    var {focusedQuotation} = this.props;\n\t\tvar {quotation} = focusedQuotation\n\t\tvar {id} = focusedQuotation\n\n\t\treturn(\n\t\t\t<div className=\"container\">\n\t\t\t\t<p>Focused Quotation: {quotation}</p>\n\t\t\t\t<p><a href={id}>{id}</a></p>\n\t\t\t</div>\n\t\t)\n\t}\n}\n\nexport default connect(\n\t(state) => {\n\t\treturn state\n\t}\n)(FocusedQuotation);\n","import React from 'react';\nvar {connect} = require('react-redux');\n\nclass CanonicalQuotation extends React.Component{\n\trender(){\n    var {canonicalQuotation} = this.props;\n\t\tvar displayQuotation = canonicalQuotation ? canonicalQuotation.quotation : \"No canonical quotation id assigned\";\n\t\tvar displayQuotationId = canonicalQuotation ? canonicalQuotation.id : \"\";\n\t\tvar citation = canonicalQuotation ? canonicalQuotation.citation : \"\";\n\n\t\t//var {quotation} = canonicalQuotation\n\n\t\treturn(\n\t\t\t<div className=\"container\">\n\t\t\t\t<p>Canonical Quotation: {displayQuotation}</p>\n\t\t\t\t<p>{citation}</p>\n\t\t\t\t<p><a href={displayQuotationId}>{displayQuotationId}</a></p>\n\t\t\t</div>\n\t\t)\n\t}\n}\n\nexport default connect(\n\t(state) => {\n\t\treturn state\n\t}\n)(CanonicalQuotation);\n","import React from 'react'\nimport $ from 'jquery';\nvar {connect} = require('react-redux');\nvar actions = require('../actions/actions');\n\n\n\nclass CanonicalQuotationListItem extends React.Component{\n\tconstructor(props){\n\t\tsuper(props)\n\t\tthis.handleOnClick = this.handleOnClick.bind(this)\n\t}\n\thandleOnClick(){\n\t\tvar {id, quotation, citation, dispatch} = this.props;\n\t\tdispatch(actions.changeCanonicalQuotationsFocus(this.props.id));\n\t\tvar quotationObject = {\n\t\t\tid,\n\t\t\tquotation,\n\t\t\tcitation\n\t\t}\n\t\tdispatch(actions.createCanonicalQuotation(quotationObject));\n\t\t// doesn't seem like the way to do it, because this dispatch might get of sync.\n\t\t//The second one requires the state to be set by the first\n\t\t// should be done in subscribe, but I'm not sure how yet\n\t\tdispatch(actions.fetchQuotations());\n\t\tdispatch(actions.clearQuotationsFocus());\n\t\tdispatch(actions.clearFocusedQuotation());\n\t\tdispatch(actions.clearManifestationQuotations());\n\t\tdispatch(actions.clearParagraph());\n\n\t\tvar selfTopPos = document.getElementById(id).offsetTop;\n\t\t$('#CanonicalQuotationList').animate({ scrollTop: selfTopPos-10 }, 400);\n\t}\n\trender(){\n    var {id, quotation, className, citation} = this.props\n    return(\n\t\t\t<div className=\"quotation-wrapper\">\n\t\t\t\t<p id={id} className={className} onClick={this.handleOnClick}>{quotation}</p>\n\t\t\t\t<a href={id} target=\"_blank\" className=\"quotation-citation\">{citation}</a>\n\t\t\t</div>\n\t\t)\n\t}\n}\n\nexport default connect()(CanonicalQuotationListItem);\n","import React from 'react';\nimport {connect} from 'react-redux'\nimport CanonicalQuotationListItem from \"./CanonicalQuotationListItem\"\n\nvar actions = require('../actions/actions');\n//TODO: this component should be deleted\nclass CanonicalQuotationList extends React.Component{\n\tconstructor(props){\n\t\tsuper(props)\n\t\tthis.handleOnShowQuotationsWithoutAssociation = this.handleOnShowQuotationsWithoutAssociation.bind(this)\n\t}\n\thandleOnShowQuotationsWithoutAssociation(e){\n\t\te.preventDefault();\n\t\tvar {dispatch} = this.props;\n\t\tvar searchText = this.refs.searchText.value;\n\n\t\tdispatch(actions.clearCanonicalQuotation());\n\t\tdispatch(actions.clearFocusedQuotation());\n\t\tdispatch(actions.clearParagraph());\n\t\t//dispatch(actions.clearCanonicalQuotationsFocus());\n\t\t//TODO change app so that searchText does need to be passed as parameters\n\t\t//but is retrieved from the searchState\n\t\tdispatch(actions.fetchCanonicalQuotations(searchText));\n\t\tdispatch(actions.fetchQuotations(searchText));\n\t\t//dispatch(actions.fetchManifestationQuotations(searchText));\n\t}\n\trender(){\n    var {canonicalQuotations} = this.props;\n\t\tvar renderQuotations = () => {\n      if (canonicalQuotations.length === 0){\n        return(\n            <p className=\"container__message\">No Quotations</p>\n        );\n      }\n\n      return canonicalQuotations.map( (quotation) => {\n\t\t\t\tvar quotationClass = quotation.focused ? \"quotation focused\" : \"quotation\"\n\t\t\t\t//var quotationClass = \"quotation\"\n        return (\n\t\t\t\t\t<CanonicalQuotationListItem className={quotationClass} key={quotation.id} {...quotation}/>\n        );\n      });\n    };\n\n\t\treturn(\n\t\t\t<div>\n\t\t\t\t<p>List of Canonical Quotations</p>\n\t\t\t\t<p>Count {canonicalQuotations.length}</p>\n\t\t\t\t{renderQuotations()}\n\t\t\t</div>\n\t\t)\n\t}\n}\n\nexport default connect(\n\t(state) => {\n\t\treturn state\n\t}\n)(CanonicalQuotationList);\n","import React from 'react'\nimport $ from 'jquery';\n\nimport Surface3Wrapper from '@bit/jeffreycwitt.lbp.surface3wrapper';\nimport Citation from '@bit/jeffreycwitt.lbp.citation';\n\nimport {FaInfo, FaRegImage} from 'react-icons/fa';\n\nvar {connect} = require('react-redux');\nvar actions = require('../actions/actions');\n\n\n\nclass ManifestationQuotationListItem extends React.Component{\n\tconstructor(props){\n\t\tsuper(props)\n\t\tthis.handleOnClick = this.handleOnClick.bind(this)\n\t\tthis.handleToggleShowImage = this.handleToggleShowImage.bind(this)\n\t\tthis.handleToggleShowCitation = this.handleToggleShowCitation.bind(this)\n\t\tthis.handleImageWrapperWraperClick = this.handleImageWrapperWraperClick.bind(this)\n\t\tthis.state = {\n      imageSize: \"200\",\n\t\t\timageFocus: false,\n\t\t\tshowImage: false,\n\t\t\tshowCitation: false\n    }\n\t}\n\thandleImageWrapperWraperClick(){\n    this.setState((prevState) => {\n      const imageSize = prevState.imageSize === \"200\" ? \"725\" : \"200\"\n      const imageFocus = prevState.imageFocus ? false : true\n      return{\n        imageSize,\n        imageFocus\n      }\n\t\t})\n\t}\n\thandleToggleShowImage(){\n\t\tconsole.log(\"test\")\n\t\tthis.setState((prevState) => {\n\t\t\treturn({\n\t\t\t\tshowImage: !prevState.showImage\n\t\t\t})\n\t\t})\n\t}\n\thandleToggleShowCitation(){\n\t\tthis.setState((prevState) => {\n\t\t\treturn({\n\t\t\t\tshowCitation: !prevState.showCitation\n\t\t\t})\n\t\t})\n\n\t}\n\thandleOnClick(){\n\t\tvar {isManifestationOf, id, quotation, dispatch} = this.props;\n\n\t\tvar newFocusedQuotationObject = {\n\t\t\tid,\n\t\t\tquotation,\n\t\t\ttype: \"manifestation\"\n\t\t}\n\t\tdispatch(actions.createFocusedQuotation(newFocusedQuotationObject));\n\n\t\tdispatch(actions.changeManifestationQuotationsFocus(id));\n\t\t//dispatch(actions.changeQuotationsFocus(isManifestationOf));\n\t\tdispatch(actions.fetchParagraph());\n\n\t\tvar topPos = document.getElementById(id).offsetTop;\n\t\t$('#ManifestationQuotationsList').animate({ scrollTop: topPos-10 }, 400);\n\n\t\t//synchronize other columns\n\t\tif (isManifestationOf != null){\n\t\t\t// create canonicalQuotation\n\t\t\tvar isManifestationOfObject = this.props.quotations.find((quotation) => {\n\t\t\t\treturn quotation.id === isManifestationOf;\n\n\t\t\t});\n\n\t\t\tif (isManifestationOfObject != undefined){\n\t\t\t\t//dispatch(actions.createCanonicalQuotation(canonicalQuotationObject));\n\t\t\t\t// focus canonicalquotation List Item\n\t\t\t\tdispatch(actions.changeQuotationsFocus(isManifestationOf));\n\t\t\t\t// scroll\n\t\t\t\tvar topPos = document.getElementById(isManifestationOf).offsetTop;\n\t\t\t\t$('#quotationsList').animate({ scrollTop: topPos-10 }, 400);\n\n\t\t\t\t//the following is repeated in quotation App; it should be abstracted and not repeated\n\t\t\t\tvar isInstanceOf = isManifestationOfObject.isInstanceOf\n\t\t\t\tif (isInstanceOf != null){\n\t\t\t\t\t// create canonicalQuotation\n\t\t\t\t\tvar canonicalQuotationObject = this.props.canonicalQuotations.find((quotation) => {\n\t\t\t\t\t\treturn quotation.id === isInstanceOf\n\n\t\t\t\t\t});\n\n\t\t\t\t\tif (canonicalQuotationObject != undefined){\n\t\t\t\t\t\tdispatch(actions.createCanonicalQuotation(canonicalQuotationObject));\n\t\t\t\t\t\t// focus canonicalquotation List Item\n\t\t\t\t\t\tdispatch(actions.changeCanonicalQuotationsFocus(isInstanceOf));\n\t\t\t\t\t\t// scroll\n\t\t\t\t\t\tvar topPos = document.getElementById(isInstanceOf).offsetTop;\n\t\t\t\t\t\t$('#CanonicalQuotationList').animate({ scrollTop: topPos-10 }, 400);\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\t//alert(\"this quotation is assigned to a canonicalQuotation, but either there is an error in the id assigned or a canonicalQuotation record still needs to be made\")\n\t\t\t\t\t\tdispatch(actions.clearCanonicalQuotationsFocus());\n\t\t\t\t\t\tdispatch(actions.clearCanonicalQuotation());\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t}\n\t\t\telse{\n\t\t\t\t//alert(\"this quotation is assigned to a canonicalQuotation, but either there is an error in the id assigned or a canonicalQuotation record still needs to be made\")\n\t\t\t\tdispatch(actions.clearQuotationsFocus());\n\t\t\t\tdispatch(actions.clearCanonicalQuotation());\n\t\t\t}\n\n\t\t}\n\t\telse{\n\t\t\tdispatch(actions.clearQuotationsFocus());\n\t\t\tdispatch(actions.clearCanonicalQuotationsFocus());\n\t\t\tdispatch(actions.clearCanonicalQuotation());\n\n\t\t}\n\n\n\t}\n\n\t\n\n\n\n\trender(){\n\t\tvar {id, quotation, className, canonicalTranscription} = this.props\n\t\tconst newManifestations = [{\n\t\t\tmanifestation: id,\n\t\t\tmanifestationTitle: id.split(\"/resource/\")[1],\n\t\t\ttranscription: \"\"\n\t\t}]\n    return(\n\t\t\t<div>\n\t\t\t\t<p id={id} className={className} onClick={this.handleOnClick}>{quotation} \n\t\t\t\t\t<a href={id} className=\"quotation-citation\">{id}</a>\n\t\t\t\t\t<span onClick={this.handleToggleShowImage}><FaRegImage/></span> \n\t\t\t\t\t<span onClick={this.handleToggleShowCitation}><FaInfo/></span>\n\t\t\t\t</p>\n\t\t\t\t<div id=\"mImageWrapperWrapper\" className={this.state.imageFocus ? \"iww-big\" : \"iww-small\"}>\n          \n\t\t\t\t\t{this.state.showImage &&\n\t\t\t\t\t<div>\n\t\t\t\t\t\t{this.state.imageFocus ? <hr className=\"toggleBar\" title=\"click to minimize\" onClick={this.handleImageWrapperWraperClick}/> : <hr className=\"toggleBar\" title=\"click to maximize\" onClick={this.handleImageWrapperWraperClick}/>}\n\t\t\t\t\t\t<Surface3Wrapper\n\t\t\t\t\t\tmanifestations={newManifestations}\n\t\t\t\t\t\tfocusedManifestation={id}\n\t\t\t\t\t\twidth={this.state.imageSize}\n\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t{this.state.showCitation && canonicalTranscription &&\n\t\t\t\t\t\t\t/* could add citation here (perhaps in hidden drop down) */\n\t\t\t\t\t\t<Citation tresourceid={canonicalTranscription}/>\n\t\t\t\t\t\t}\n\t\t\t\t\t</div>\n\t\t\t\t\t\n\t\t\t</div>\n\t\t)\n\t}\n}\n\nexport default connect(\n\t(state) => {\n\t\treturn state\n\t}\n)(ManifestationQuotationListItem);\n","import React from 'react'\nimport {connect} from 'react-redux';\n\n\nimport ManifestationQuotationListItem from \"./ManifestationQuotationListItem\"\nvar actions = require('../actions/actions');\n\nclass ManifestationQuotationList extends React.Component{\n\trender(){\n    var {manifestationQuotations} = this.props;\n    var renderQuotations = () => {\n      if (manifestationQuotations.length === 0){\n        return(\n            <p className=\"container__message\">No Quotations</p>\n        );\n      }\n\n      return manifestationQuotations.map( (quotation) => {\n\t\t\t\tvar quotationClass = quotation.focused ? \"quotation focused\" : \"quotation\"\n\t\t\t\t//var quotationClass = \"quotation\"\n        return (\n\n          <ManifestationQuotationListItem className={quotationClass} key={quotation.id} {...quotation}/>\n        );\n      });\n    };\n\n\t\treturn(\n\t\t\t<div>\n\t\t\t\t<p>List of Manifestation Quotations</p>\n        <p>Count {manifestationQuotations.length}\n          {(manifestationQuotations[0] && manifestationQuotations[0].isManifestationOf) &&\n          <>\n            | <a href={\"https://lombardpress.org/collation-vizualizer/collatexView.html?id=\" + manifestationQuotations[0].isManifestationOf} target=\"_blank\">Collation </a>\n            | <a href={\"https://mirador.scta.info/?blockid=\" + manifestationQuotations[0].isManifestationOf} target=\"_blank\">\n              <img alt=\"view in mirador\" src=\"https://projectmirador.org/img/mirador-logo.svg\" style={{width: \"12px\", height: \"12px\"}}/>\n            </a>\n          </>\n          }\n        </p>\n        {renderQuotations()}\n\t\t\t</div>\n\t\t)\n\t}\n}\n\nexport default connect(\n\t(state) => {\n\t\treturn state\n\t}\n)(ManifestationQuotationList);\n","import React from 'react';\nimport cetei from \"../vendor/CETEI\"\nimport Surface3Wrapper from '@bit/jeffreycwitt.lbp.surface3wrapper';\nimport Citation from '@bit/jeffreycwitt.lbp.citation';\n//import {FaExpand, FaCompress} from 'react-icons/fa';\nvar {connect} = require('react-redux');\nvar actions = require('../actions/actions');\n\n//import CETEI from '../../node_modules/CETEIcean/src/CETEI';\n\n\n\n\n\nclass Paragraph extends React.Component{\n  constructor(props){\n    super(props)\n    this.handleShowImages = this.handleShowImages.bind(this)\n    this.handleImageWrapperWraperClick = this.handleImageWrapperWraperClick.bind(this)\n    this.handleShowFullText = this.handleShowFullText.bind(this)\n    this.runQueryForSource = this.runQueryForSource.bind(this)\n    this.addTEICustom = this.addTEICustom.bind(this)\n    this.handleClearFilters = this.handleClearFilters\n    this.state = {\n      imageSize: \"200\",\n      imageFocus: false\n    }\n  }\n  handleImageWrapperWraperClick(){\n    this.setState((prevState) => {\n      const imageSize = prevState.imageSize === \"200\" ? \"725\" : \"200\"\n      const imageFocus = prevState.imageFocus ? false : true\n      return{\n        imageSize,\n        imageFocus\n      }\n    })\n\n\n  }\n  handleShowImages(e){\n    e.preventDefault();\n    var {dispatch} = this.props;\n    dispatch(actions.fetchImages());\n    dispatch(actions.toggleImagesDisplay(this.props.images.visible));\n  }\n  handleShowFullText(e){\n    e.preventDefault();\n    var {dispatch} = this.props;\n    if (this.props.type === \"source\"){\n      dispatch(actions.fetchFullText(true));\n    }\n    else{\n      dispatch(actions.fetchFullText(false));\n    }\n    dispatch(actions.toggleImagesDisplay(true));\n    dispatch(actions.toggleFullTextDisplay(this.props.fullText.visible));\n  }\n  componentDidMount(e){\n    var _this = this;\n    this.addTEICustom()\n  }\n  componentDidUpdate(e){\n    var _this = this;\n    this.addTEICustom()\n  }\n  addTEICustom(){\n    var _this = this;\n    const htmlText = new cetei()\n    let paragraph = {}\n    if (this.props.type === \"source\"){\n      paragraph = this.props.sourceParagraph;\n    }\n    else{\n      paragraph = this.props.paragraph;\n    }\n    if (paragraph.paragraph_text){\n      htmlText.makeHTML5(paragraph.paragraph_text, function(data){\n        // get id of quote\n        if (_this.props.focusedQuotation.id){\n          const quoteid = _this.props.focusedQuotation.id.split(\"/\").pop();\n          // find quote in text if there and change class to highlighted\n          if (data.querySelector(\"#\" + quoteid)){\n            data.querySelector(\"#\" + quoteid).setAttribute(\"class\", \"highlighted\");\n          }\n          //load text in div\n          _this.refs.text.replaceChild(data, _this.refs.text.childNodes[0]);\n        }\n\n      });\n    }\n    else{\n      const emptyTextNode = document.createTextNode(\"\");\n      _this.refs.text.replaceChild(emptyTextNode, _this.refs.text.childNodes[0]);\n    }\n  }\n  runQueryForSource(sourceId){\n\n    var {dispatch, search} = this.props;\n\n    var quotationWorkPart = sourceId\n\n\n\n    var searchParameters = {\n      quotationWorkPart\n    }\n    // clear search parameters\n    this.handleClearFilters()\n\t\t// set new search parameters\n    dispatch(actions.setSearchParameters(searchParameters));\n\t\t// (ideally after the handleClearFilters has finished) set search parameters to include quotationWorkPart\n\t\tdispatch(actions.fetchQuotationWorkParts());\n\t\t// fetch quotations based on the source part id\n\t\tdispatch(actions.fetchQuotations());\n\t\t//fetch chart to match new query\n\t\t// TODO: seems like it would be better for chart fetch only when view is requested\n    dispatch(actions.fetchChart());\n\n  }\n\t//TODO: this function is mostly a repeat of the clearFilters function in the Search component\n\t//this seems like an unnecessary redundancy; perhaps this can become a generic action or common utility function\n  handleClearFilters(e){\n\n    var {dispatch, search} = this.props;\n    dispatch(actions.clearSearchParameters());\n    dispatch(actions.clearCanonicalQuotations());\n    dispatch(actions.clearQuotations());\n\t\tdispatch(actions.fetchQuotationWorkParts());\n    dispatch(actions.fetchExpressionParts());\n    //dispatch(actions.fetchCanonicalQuotations());\n    dispatch(actions.fetchQuotationAuthors());\n    dispatch(actions.fetchExpressionAuthors());\n    dispatch(actions.fetchSearchWorksList());\n    //store.dispatch(actions.fetchExpressionTypes());\n    dispatch(actions.fetchQuotationWorksList());\n    dispatch(actions.fetchWorkGroups());\n    dispatch(actions.fetchAuthorTypes());\n    //dispatch(actions.fetchManifestationQuotations(searchText, quotationType, expressionId));\n    dispatch(actions.clearManifestationQuotations());\n\n    // date refs won't clear until place for them in the store has been created\n\t    // this.refs.quotationAuthorDateAfter.value = \"\";\n\t    // this.refs.quotationAuthorDateBefore.value = \"\";\n\t    // this.refs.expressionAuthorDateAfter.value = \"\";\n\t    // this.refs.expressionAuthorDateBefore.value = \"\";\n\t\t\t//this.refs.searchText.value = \"\";\n\n\n\n  }\n  render(){\n    var _this = this;\n    let paragraph = {}\n    if (this.props.type === \"source\"){\n      paragraph = this.props.sourceParagraph;\n    }\n    else{\n      paragraph = this.props.paragraph;\n    }\n    //var {paragraph} = this.props;\n    var {expression_id, manifestation_id, transcription_id, manifestations, paragraph_text, review} = paragraph\n\n    // NOTE: sparql is returning construct id as sctar:<id>; this needs to be converted to its expanded form \n    const transcription_id_expanded = transcription_id && transcription_id.replace(\"sctar:\", \"http://scta.info/resource/\")\n    \n    \n    // var domParser = new DOMParser();\n    // var xsltProcessor = new XSLTProcessor();\n    //\n    // var xsltText = '<?xml version=\"1.0\" encoding=\"UTF-8\"?><xsl:stylesheet xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\"  xmlns:xs=\"http://www.w3.org/2001/XMLSchema\"  exclude-result-prefixes=\"xs\"  version=\"1.0\" xmlns:tei=\"http://www.tei-c.org/ns/1.0\">  <xsl:output method=\"html\"/>  <xsl:template match=\"/\">    <xsl:apply-templates select=\"//tei:body\"/>  </xsl:template>  <xsl:template match=\"tei:p\">      <xsl:apply-templates/>    </xsl:template>  <xsl:template match=\"tei:quote\">    \"<xsl:apply-templates/>\"  </xsl:template>  <xsl:template match=\"tei:rdg\">      </xsl:template>  <xsl:template match=\"tei:note\">      </xsl:template>  <xsl:template match=\"tei:bibl\">      </xsl:template>  <xsl:template match=\"tei:reg\">      </xsl:template>  <xsl:template match=\"tei:corr\">      </xsl:template>  </xsl:stylesheet>';\n    // var xsltDoc = domParser.parseFromString(xsltText, \"text/xml\");\n    // xsltProcessor.importStylesheet(xsltDoc);\n    //\n    // var xmlText = paragraph_text;\n    // var xmlDoc = domParser.parseFromString(xmlText, \"text/xml\");\n    // var fragment = xsltProcessor.transformToFragment(xmlDoc, document);\n    //\n    // var parent = document.createElement(\"div\");\n    // parent.appendChild(fragment);\n    // var text =  parent.innerHTML;\n\n    function showImageToggle(){\n\n      if (paragraph.expression_id){\n        return(\n          <p>\n            <a onClick={_this.handleShowImages}>Toggle Image</a>\n          </p>\n        )\n      }\n\n    }\n    function showFullTextToggle(){\n\n      if (paragraph.expression_id){\n        return(\n          <p>\n            <a onClick={_this.handleShowFullText}>Show Full Text</a>\n          </p>\n        )\n      }\n\n    }\n\n    function showReview(){\n      if (review){\n        var reviewLink  = \"https://dll-review-registry.scta.info/reviews/\" + review[\"id\"] + \".html\";\n        var ipfsGatewayLink  = \"https://gateway.scta.info/ipfs/\" + review[\"ipfs-hash\"];\n        return(\n          <p>\n            <a href={reviewLink} target=\"_blank\"><img src={review[\"badge-url\"]}/></a> Content extracted from reviewed data source <a href={ipfsGatewayLink} target=\"_blank\">{review[\"ipfs-hash\"]}</a>\n          </p>\n        )\n      }\n    }\n    function showLbpLink(){\n\n    }\n    let newManifestations = []\n    if (manifestations && manifestations.constructor === Array) {\n      newManifestations = manifestations.map((m) => {\n        return {\n          manifestation: m,\n          manifestationTitle: m.split(\"/resource/\")[1],\n          transcription:\"\"\n        }\n      })\n    }\n    else if (typeof manifestations === \"string\")\n    {\n      newManifestations = [{\n        manifestation: manifestations,\n        manifestationTitle: manifestations.split(\"/resource/\")[1],\n        transcription:\"\"\n      }]\n    }\n    return(\n\n\n      <div>\n        <p>Context Paragraph</p>\n        <div id=\"text\" ref=\"text\"><div/></div>\n        {manifestation_id &&\n          <div id=\"imageWrapperWrapper\" className={this.state.imageFocus ? \"iww-big\" : \"iww-small\"}>\n          {this.state.imageFocus ? <hr className=\"toggleBar\" title=\"click to minimize\" onClick={this.handleImageWrapperWraperClick}/> : <hr className=\"toggleBar\" title=\"click to maximize\" onClick={this.handleImageWrapperWraperClick}/>}\n          <Surface3Wrapper\n           manifestations={newManifestations}\n           focusedManifestation={manifestation_id}\n           width={this.state.imageSize}\n         />\n         </div>\n          //showImageToggle()\n        }\n        {showFullTextToggle()}\n        {manifestation_id && <p><a href={\"https://scta.lombardpress.org/res?resourceid=\" + manifestation_id} target=\"_blank\">View in LbpWeb</a></p>}\n        {\n        //  showReview()\n        }\n        {(this.props.type === \"source\" && this.props.focusedQuotation.id) && <p className=\"link\" onClick={() => {this.runQueryForSource(this.props.sourceParagraph.expression_id.split(\"/resource/\")[1])}}>Search Quotations of this Passage Only</p>}\n        {\n          // no longer needed since citation component is in place\n          //manifestation_id && <p><a href={manifestation_id}>{manifestation_id}</a></p>\n        }\n        {manifestation_id && <Citation tresourceid={transcription_id_expanded}/>}\n      </div>\n    )\n  }\n}\n\nexport default connect(\n  (state) => {\n    return state\n  }\n)(Paragraph);\n","import React, { Component } from 'react'\nvar {connect} = require('react-redux');\n// import { scaleLinear } from 'd3-scale';\n// import { max } from 'd3-array';\n// import { select } from 'd3-selection';\nvar d3 = require(\"d3\");\nvar actions = require('../actions/actions');\n\n\n\n\n\nclass BarChart extends React.Component {\n   constructor(props){\n      super(props)\n      this.createBarChart = this.createBarChart.bind(this)\n  }\n   componentDidMount() {\n     var count = this.props.chart.count;\n     if (count){\n      this.createBarChart(count)\n      }\n   }\n   componentDidUpdate(prevProps, prevState) {\n     var count = this.props.chart.count;\n     if (count != prevProps.chart.count){\n       this.createBarChart(count)\n     }\n   }\n   componentWillUnmount(){\n     d3.selectAll(\".tooltip\").remove();\n   }\n   createBarChart(count) {\n     var svg = d3.select(\"svg\");\n     svg.selectAll(\"*\").remove();\n     d3.selectAll(\".tooltip\").remove();\n\n\n  //    console.log(\"value in createBarChart\", count)\n  //     const node = this.node\n  //     //const dataMax = max(this.props.data)\n  //     const dataMax = max(count)\n  //     const yScale = scaleLinear()\n  //        .domain([0, dataMax])\n  //        .range([0, this.props.size[1]])\n  //  select(node)\n  //     .selectAll('rect')\n  //     //.data(this.props.data)\n  //     .data(count)\n  //     .enter()\n  //     .append('rect')\n   //\n  //  select(node)\n  //     .selectAll('rect')\n  //     //.data(this.props.data)\n  //     .data(count)\n  //     .exit()\n  //     .remove()\n   //\n  //  select(node)\n  //     .selectAll('rect')\n  //     //.data(this.props.data)\n  //     .data(count)\n  //     .style('fill', '#fe9922')\n  //     .attr('x', (d,i) => i * 25)\n  //     .attr('y', d => this.props.size[1] - yScale(d))\n  //     .attr('height', d => yScale(d))\n  //     .attr('width', 25)\n  //  }\n  var data = count\n\n  //above is working chart\n\n  // below is new attempted chart\n  //data.sort(sort)\n\t\t//this filter is required to make sure count is recognized as integers not strings\n\t\t// see: http://stackoverflow.com/questions/10709950/get-the-real-max-of-an-array-in-d3\n\n\tdata.filter(function(d,i) {\n\t  d.count = +d.count;\n\t});\n\n\tvar countArray = [];\n\tvar titleArray = [];\n\n  countArray = data.map(function(d){\n    return d.count\n  });\n  // for (x in data){\n\t// \tcountArray.push(data[x].count);\n  //\n\t// };\n  titleArray = data.map(function(d){\n    return d.title\n  });\n\t// for (x in data){\n\t// \ttitleArray.push(data[x].title);\n\t// };\n\n\tvar margin = {top: 30, right: 30, bottom: 40, left: 50}\n\tvar height = 500 - margin.top - margin.bottom,\n\twidth = 1200 - margin.left - margin.right;\n\t//barWidth = 50,\n\t//barOffset = 5;\n\n\tvar colors = d3.scale.linear()\n\t\t.domain([0, data.length*.80,  data.length])\n\t\t.range(['#FFB832', '#C61C6F']);\n\n\n\t//var xScale = d3.scale.linear()\n\t\t//.domain([0, d3.max(countArray)])\n\t\t//.range([0, height]);\n\n\t//var yScale = d3.scale.ordinal()\n\t\t//.domain(d3.range(0, data.length))\n\t\t//.rangeBands([0, height])\n\n\tvar yScale = d3.scale.linear()\n\t\t.domain([0, d3.max(countArray)])\n\t\t.range([0, height]);\n\n\tvar xScale = d3.scale.ordinal()\n\t\t.domain(d3.range(0, data.length))\n\t\t.rangeBands([0, width], .5)\n\n\n\n\n\tvar tooltip = d3.select('body').append('div')\n\t\t.attr('class', 'tooltip')\n\t\t.style('position', 'absolute')\n\t\t.style('padding', '0 10px')\n\t\t.style('background', 'white')\n\t\t.style('opacity', 0)\n\n    const node = this.node\n    //var canvas = d3.select(\"div#\" + chart).append(\"svg\")\n    var canvas = d3.select(node)\n      //.attr(\"id\", chart)\n\t\t//.style('background', '#E7E0CB')\n\t\t.attr('width', width + margin.left + margin.right)\n\t\t.attr('height', height + margin.top + margin.bottom)\n\t\t.append(\"g\")\n\t\t.attr('transform', 'translate(' + margin.left + ', ' + margin.top +')')\n\t\t.selectAll(\"rect\")\n\t\t\t.data(data)\n\t\t\t.enter()\n\t\t\t.append(\"g\")\n\t\t\t\t.append(\"rect\")\n\t\t\t\t\t.style('fill', function(d,i){\n\t\t\t\t\t\treturn colors(i);\n\t\t\t\t\t})\n\t\t\t\t\t.attr('height', 0)\n\t\t\t\t\t.attr('y', height)\n\t\t\t\t\t.attr(\"width\", xScale.rangeBand())\n\t\t\t\t\t.attr(\"x\", function (d,i) {return xScale(i);})\n\n\n\t\t\t\t\t.on('mouseover', function(d) {\n\t\t\t\t\t\ttooltip.transition()\n\t\t\t\t\t\t\t.style('opacity', .9)\n\n\t\t\t\t\t\ttooltip.html(\"<a href='\" + d.item + \"'>\" + d.title + \"</a>. Quoted \" + d.count + \" times\")\n\t\t\t\t\t\t\t.style('left', (d3.event.pageX + 0) + 'px')\n\t\t\t\t\t\t\t.style('top', (d3.event.pageY + 0) + 'px')\n\t\t\t\t\t\t\t.style('left', d3.select(node).left + 150 + 'px')\n\t\t\t\t\t\t\t.style('top', d3.select(node).top + 125 + 'px')\n\n\t\t\t\t\t\t\td3.select(this)\n\t\t\t\t\t\t\t\t.style('opacity', .5);\n\t\t\t\t\t})\n\t\t\t\t\t.on('mouseout', function(d) {\n\t\t\t\t\t\t//tooltip.transition().style('opacity', 0)\n\t\t\t\t\t\td3.select(this)\n\t\t\t\t\t\t\t.transition()\n\t\t\t\t\t\t\t.style('opacity', 1);\n\t\t\t\t\t})\n\n\n\t\t//canvas.transition()\n    canvas.transition()\n\t\t\t.attr(\"height\", function (d) {return yScale(d.count)})\n\t\t\t.attr(\"y\", function(d) { return height - yScale(d.count) })\n\t\t\t.delay(function(d,i){return i * 10})\n\t\t\t.duration(1000)\n\t\t\t.ease('elastic')\n\n\t\t\tvar vGuideScale = d3.scale.linear()\n\t\t\t\t.domain([0, d3.max(countArray)])\n\t\t\t\t.range([height, 0])\n\n\t\t\tvar vAxis = d3.svg.axis()\n\t\t\t\t.scale(vGuideScale)\n\t\t\t\t.orient('left')\n\t\t\t\t.ticks(10)\n\t\t\tvar vGuide = d3.select(node).append('g')\n\t\t\t\tvAxis(vGuide)\n\t\t\t\tvGuide.attr('transform', 'translate('+ margin.left+', '+margin.top + ')')\n\t\t\t\tvGuide.selectAll('path')\n\t\t\t\t\t.style({fill: 'none', stroke: \"#000\"})\n\t\t\t\tvGuide.selectAll('line')\n\t\t\t\t\t.style({ stroke: \"#000\"})\n\n\t\t\t//var horizontalGuideScale = d3.scale.ordinal()\n\t\t\t\t//.domain([0, d3.max(countArray)])\n\t\t\t\t//.range([height, 0])\n\n\t\t\tvar hAxis = d3.svg.axis()\n\t\t\t\t.scale(xScale)\n\t\t\t\t.orient('bottom')\n\t\t\t\t.tickValues(xScale.domain().filter(function(d, i){\n\t\t\t\t\treturn i % 50 === 0\n\t\t\t\t}\n\t\t\t\t));\n\n        var hGuide = d3.select(node).append('g')\n\t\t\t\thAxis(hGuide)\n\t\t\t\thGuide.attr('transform', 'translate('+ margin.left+', '+ (height + margin.top) + ')')\n\t\t\t\thGuide.selectAll('path')\n\t\t\t\t\t.style({fill: 'none', stroke: \"#000\"})\n\t\t\t\thGuide.selectAll('line')\n\t\t\t\t\t.style({ stroke: \"#000\"})\n\t\t}\nrender() {\n      return(\n          <svg ref={node => this.node = node}\n          width={500} height={500}>\n          </svg>\n\n\n    )\n   }\n}\n//module.exports = BarChart;\n\n// export default connect(\n// \t(state) => {\n// \t\treturn state\n// \t}\n// )(BarChart);\n\nconst mapStateToProps = state => (\n  {\n    chart: state.chart,\n  }\n);\n\nconst mapDispatchToProps = dispatch => ({\n\n});\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps,\n)(BarChart);\n","import React, { Component } from 'react'\nimport Surface3Wrapper from '@bit/jeffreycwitt.lbp.surface3wrapper';\nimport CitationExplanation from '@bit/jeffreycwitt.lbp.citation-explanation'\nvar {connect} = require('react-redux');\nvar actions = require('../actions/actions');\nvar cetei = require(\"../vendor/CETEI\");\n\n\n\n\n\nclass Images extends React.Component {\n   constructor(props){\n      super(props)\n      this.handleToggleImage = this.handleToggleImage.bind(this)\n\n  }\n   componentDidMount() {\n\n   }\n   componentDidUpdate(count) {\n\n   }\n   handleToggleImage(e){\n    e.preventDefault();\n    var {dispatch} = this.props;\n \t\tdispatch(actions.toggleImagesDisplay(this.props.images.visible));\n\n   }\n   render(){\n     var _this = this;\n     function showImages(){\n       var images = _this.props.images;\n       if (images.visible && images.images.length > 0){\n         return images.images.map(function(image){\n           var imageUrl = image.url;\n           return(\n             <img src={imageUrl + \"/full/1000,/0/default.jpg\"}/>\n           )\n           }\n         )\n\n       }\n     }\n     const manifestations = [{\n         manifestation: \"http://scta.info/resource/l1-cpspfs/reims\",\n         manifestationTitle: \"reims\",\n         transcription: \"\"\n       },\n       {\n         manifestation: \"http://scta.info/resource/l1-cpspfs/svict\",\n         manifestationTitle: \"svict\",\n         transcription: \"\"\n       },\n     ]\n     return(\n       <div className=\"images\">\n       <Surface3Wrapper\n        manifestations={manifestations}\n        focusedManifestation={\"http://scta.info/l1-cpspfs/reims\"}\n      />\n         {showImages()}\n       </div>\n     )\n   }\n }\n//module.exports = BarChart;\n\nexport default connect(\n\t(state) => {\n\t\treturn state\n\t}\n)(Images);\n","import React, { Component } from 'react'\nimport $ from 'jquery';\nimport cetei from \"../vendor/CETEI\"\nvar {connect} = require('react-redux');\nvar actions = require('../actions/actions');\n\n//var cetei = require(\"../vendor/CETEI\");\n\n\nclass FullText extends React.Component {\n   constructor(props){\n      super(props)\n      this.handleToggleFullText = this.handleToggleFullText.bind(this)\n\n  }\n  componentDidUpdate() {\n    var _this = this;\n\t\tconst htmlText = new cetei()\n\t\tif (this.props.fullText.textInfo.text){\n\t\t\thtmlText.makeHTML5(this.props.fullText.textInfo.text, function(data){\n\t\t\t\t// get id of quote\n\t\t\t\tconst quoteid = _this.props.focusedQuotation.id.split(\"/\").pop();\n        const sourceid = _this.props.focusedQuotation.source.split(\"/\").pop();\n\n\t\t\t\t//load text in div\n\t\t\t\t_this.refs.text.replaceChild(data, _this.refs.text.childNodes[0]);\n        let selfTopPos = \"\"\n        try{\n          // find quote in text if there and change class to highlighted\n  \t\t\t\tif (data.querySelector(\"#\" + quoteid)){\n  \t\t\t\t\tdata.querySelector(\"#\" + quoteid).setAttribute(\"class\", \"highlighted\");\n  \t\t\t\t}\n          selfTopPos = document.getElementById(quoteid).offsetTop;\n        }\n        catch(e){\n          // find quote in text if there and change class to highlighted\n  \t\t\t\tif (data.querySelector(\"#\" + sourceid)){\n  \t\t\t\t\tdata.querySelector(\"#\" + sourceid).setAttribute(\"class\", \"highlighted\");\n  \t\t\t\t}\n          selfTopPos = document.getElementById(sourceid).offsetTop;\n        }\n\n        console.log(\"scroll\", selfTopPos);\n        $(\".full-text-wrapper\").animate({ scrollTop: selfTopPos-100 }, 400);\n\n\t\t\t});\n\t\t}\n\n\n  }\n  handleToggleFullText(e){\n    e.preventDefault();\n    var {dispatch} = this.props;\n \t\tdispatch(actions.toggleFullTextDisplay(this.props.fullText.visible));\n\n  }\n  render(){\n     var _this = this;\n\n     return(\n       <div className=\"full-text-wrapper\">\n         <div id=\"text-tool-bar\">\n           <button id=\"hide-full-text\" onClick={this.handleToggleFullText}>Hide Text</button>\n         </div>\n         <div id=\"text\" ref=\"text\"><div/>\n       </div>\n\n       </div>\n     )\n   }\n }\n\n//module.exports = BarChart;\n\nexport default connect(\n\t(state) => {\n\t\treturn state\n\t}\n)(FullText);\n","import React from 'react';\nimport {connect} from 'react-redux';\n\n\n\n\n\n//var actions = require('actions');\nimport Search from \"./Search\";\nimport QuotationList from \"./QuotationList\";\nimport FocusedQuotation from \"./FocusedQuotation\";\nimport CanonicalQuotation from \"./CanonicalQuotation\";\nimport CanonicalQuotationList from \"./CanonicalQuotationList\";\nimport ManifestationQuotationList from \"./ManifestationQuotationList\";\nimport Paragraph from \"./Paragraph\";\nimport BarChart from \"./BarChart\";\nimport Images from \"./Images\";\nimport FullText from \"./FullText\";\n\nclass TodoApp extends React.Component{\n\trender(){\n\t\tvar _this = this;\n\t\tfunction barGraphDisplay(){\n\t\t\tif (_this.props.chart.visible){\n\t\t\t\treturn(\n\t\t\t\t\t<div className=\"chart\">\n\t\t\t\t\t\t<BarChart size={[500,500]}/>\n\t\t\t\t\t</div>\n\t\t\t\t)\n\t\t\t}\n    }\n\t\tfunction imagesDisplay(){\n\t\t\tif (_this.props.images.visible){\n\t\t\t\treturn(\n\t\t\t\t\t<div>\n\t\t\t\t\t<Images/>\n\t\t\t\t\t\t<div className=\"column5\">\n\t\t\t\t\t\t\t<Paragraph/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t)\n\t\t\t}\n    }\n\t\tfunction fullTextDisplay(){\n\t\t\tif (_this.props.fullText.visible){\n\t\t\t\treturn(\n\t\t\t\t\t<FullText/>\n\t\t\t\t)\n\t\t\t}\n    }\n\t\tfunction quotationDisplay(){\n\t\t\tif (!_this.props.chart.visible && !_this.props.images.visible && !_this.props.fullText.visible){\n\t\t\t\treturn(\n\t\t\t\t\t<div>\n\t\t\t\t\t<div id=\"quotationsList\" className=\"column2\">\n\t\t\t\t\t\t<QuotationList/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div id=\"ManifestationQuotationsList\" className=\"column3\">\n\t\t\t\t\t\t<ManifestationQuotationList/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"column4\">\n\t\t\t\t\t\t<Paragraph/>\n\t\t\t\t\t\t{/* <FocusedQuotation/>\n\t\t\t\t\t\t<CanonicalQuotation/> */}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"column5\">\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t//<CanonicalQuotationList/>\n\t\t\t\t\t\t\t<Paragraph type=\"source\"/>\n\t\t\t\t\t\t}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t)\n\t\t\t}\n    }\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t<div className=\"wrapper\">\n\t\t\t\t\t<div className='search column1'>\n\t\t\t\t\t\t<Search/>\n\t\t\t\t\t</div>\n\t\t\t\t\t{quotationDisplay()}\n\t\t\t\t\t{barGraphDisplay()}\n\t\t\t\t\t{imagesDisplay()}\n\t\t\t\t\t{fullTextDisplay()}\n\n\t\t\t\t</div>\n\n\t\t\t</div>\n\t\t)\n\t}\n}\n\n//module.exports = ;\nexport default connect(\n  (state) => {\n\t\treturn state\n\t}\n)(TodoApp);\n","import React from \"react\";\nimport TodoApp from \"./TodoApp\";\n\nvar Main = (props) => {\n\treturn(\n\t\t\t<div>\n        <h3 className='page-title'><em>Ad fontes</em>: A Scholastic Quotation Explorer</h3>\n\t\t\t\t<div className='page-header'>\n\t\t\t\t\t<p>A <a href=\"http://lombardpress.org\">LombardPress</a> Publication</p>\n\t\t\t\t\t<p>Powerd by Data from the <a href=\"https://scta.info\">Scholastic Commentaries and Text Archive</a></p>\n\t\t\t\t\t<p>Designed by <a href=\"http://jeffreycwitt.com\">Jeffrey C. Witt</a></p>\n        </div>\n        <TodoApp/>\n\t\t\t</div>\n\t\t);\n}\n\nexport default Main;\n","import React from \"react\"\nimport ReactDOM from \"react-dom\"\nimport {Provider} from \"react-redux\"\n//import {Route, Router, IndexRoute, hashHistory} from \"react-router\"\n\nimport TodoApp from \"./components/TodoApp\"\n//var BarChart = require(\"BarChart\");\nimport BarChart from './components/BarChart'\nimport Main from './components/Main'\n\nimport {setSearchParameters, fetchQuotationAuthors, fetchExpressionAuthors, fetchSearchWorksList, fetchExpressionTypes, fetchQuotationExpressionTypes, fetchQuotationWorksList, fetchWorkGroups, fetchAuthorTypes, fetchChart} from './actions/actions'\nimport 'bootstrap/dist/css/bootstrap.css'\nimport './styles/app.scss';\nvar store = require(\"./store/configureStore\").configure();\n\n\n\nstore.subscribe(() => {\n\tvar state = store.getState();\n\n});\n\n//var state = store.getState();\n\nstore.dispatch(setSearchParameters({}));\n//store.dispatch(actions.fetchCanonicalQuotations());\nstore.dispatch(fetchQuotationAuthors());\nstore.dispatch(fetchExpressionAuthors());\nstore.dispatch(fetchSearchWorksList());\nstore.dispatch(fetchExpressionTypes());\nstore.dispatch(fetchQuotationExpressionTypes());\nstore.dispatch(fetchQuotationWorksList());\nstore.dispatch(fetchWorkGroups());\nstore.dispatch(fetchAuthorTypes());\nstore.dispatch(fetchChart());\n\n\n\n\n// load foundation\n//$(document).foundation();\n\n// App css\n\n//require('style!css!sass!applicationStyles')\n//$(document).foundation();\n\nReactDOM.render(\n\t<Provider store={store}>\n\t\t<Main/>\n\t</Provider>,\n\tdocument.getElementById('root')\n);\n","export var searchReducer = (state = {}, action) => {\n  switch (action.type){\n    case 'CLEAR_SEARCH_PARAMETERS':\n      return {\n        ...state,\n        searchParameters: []\n        }\n    case 'SET_SEARCH_PARAMETERS':\n      return {\n        ...state,\n        searchParameters: action.searchParameters\n        }\n    case 'START_SEARCH_WORKS_FETCH':\n        return {\n          ...state,\n          searchWorks: []\n        }\n    case 'COMPLETE_SEARCH_WORKS_FETCH':\n      return {\n        ...state,\n        searchWorks: action.listOfWorks\n      }\n    case 'START_QUOTATION_AUTHORS_FETCH':\n        return {\n          ...state,\n          quotationAuthors: []\n        }\n    case 'COMPLETE_QUOTATION_AUTHORS_FETCH':\n      return {\n        ...state,\n        quotationAuthors: action.authors\n      }\n    case 'START_EXPRESSION_AUTHORS_FETCH':\n        return {\n          ...state,\n          expressionAuthors: []\n        }\n    case 'COMPLETE_EXPRESSION_AUTHORS_FETCH':\n      return {\n        ...state,\n        expressionAuthors: action.authors\n      }\n    case 'START_QUOTATION_WORKS_LIST_FETCH':\n        return {\n          ...state,\n          quotationWorksList: []\n        }\n    case 'COMPLETE_QUOTATION_WORKS_LIST_FETCH':\n      return {\n        ...state,\n        quotationWorksList: action.quotationWorksList\n      }\n    case 'START_QUOTATION_WORK_PARTS_FETCH':\n      return {\n        ...state,\n        quotationWorkParts: []\n      }\n    case 'COMPLETE_QUOTATION_WORK_PARTS_FETCH':\n      return {\n        ...state,\n        quotationWorkParts: action.parts\n      }\n    case 'START_EXPRESSION_PARTS_FETCH':\n      return {\n        ...state,\n        expressionParts: []\n      }\n    case 'COMPLETE_EXPRESSION_PARTS_FETCH':\n      return {\n        ...state,\n        expressionParts: action.parts\n      }\n    case 'START_EXPRESSION_TYPE_FETCH':\n        return {\n          ...state,\n          expressionTypes: []\n        }\n    case 'COMPLETE_EXPRESSION_TYPE_FETCH':\n      return {\n        ...state,\n        expressionTypes: action.expressionTypes\n      }\n    case 'START_QUOTATION_EXPRESSION_TYPE_FETCH':\n        return {\n          ...state,\n          quotationExpressionTypes: []\n        }\n    case 'COMPLETE_QUOTATION_EXPRESSION_TYPE_FETCH':\n      return {\n        ...state,\n        quotationExpressionTypes: action.quotationExpressionTypes\n      }\n    case 'START_WORK_GROUPS_FETCH':\n        return {\n          ...state,\n          workGroups: []\n        }\n    case 'COMPLETE_WORK_GROUPS_FETCH':\n      return {\n        ...state,\n        workGroups: action.workGroups\n      }\n    case 'START_AUTHOR_TYPES_FETCH':\n        return {\n          ...state,\n          authorTypes: []\n        }\n    case 'COMPLETE_AUTHOR_TYPES_FETCH':\n      return {\n        ...state,\n        authorTypes: action.authorTypes\n      }\n    default:\n      return state\n  };\n};\n","export var chartReducer = (state = {}, action) => {\n  switch (action.type){\n    case 'TOGGLE_GRAPH_DISPLAY':\n        return {\n          ...state,\n          visible: !action.current\n        }\n    case 'START_CHART_FETCH':\n        return {\n          ...state,\n          count: []\n        }\n    case 'COMPLETE_CHART_FETCH':\n      return {\n        ...state,\n        count: action.count\n      }\n    default:\n      return state\n  };\n};\n","export var imagesReducer = (state = {}, action) => {\n  switch (action.type){\n    case 'TOGGLE_IMAGES_DISPLAY':\n        return {\n          ...state,\n          visible: !action.current\n        }\n    // case 'TOGGLE_GRAPH_DISPLAY':\n    //   return {\n    //     ...state,\n    //     visible: false\n    //   }\n    case 'START_IMAGES_FETCH':\n        return {\n          ...state,\n          images: []\n        }\n    case 'COMPLETE_IMAGES_FETCH':\n      return {\n        ...state,\n        images: action.images\n      }\n    default:\n      return state\n  };\n};\n","export var quotationsReducer = (state = [], action) => {\n  switch (action.type){\n    case 'ADD_QUOTATIONS':\n      return [\n        ...state,\n        ...action.quotations\n      ];\n    case 'ADD_QUOTATIONS':\n      return [\n        ...state,\n        ...action.quotations\n      ];\n    case 'CLEAR_QUOTATIONS':\n      return [];\n    case 'START_QUOTATIONS_FETCH':\n      //return [];\n      return \"fetching\";\n    case 'COMPLETE_QUOTATIONS_FETCH':\n      return action.quotations.map((quotation)=>{\n        return {\n          id: quotation.quotation.value,\n          quotation: quotation.quotation_text.value,\n          title: quotation.toplevel_expression_title.value,\n          author: quotation.author_title.value,\n          focused: false,\n          isInstanceOf: quotation.isInstanceOf ? quotation.isInstanceOf.value : null,\n          source: quotation.source ? quotation.source.value : null,\n          citation: quotation.citation ? quotation.citation.value : null,\n          refText: quotation.refText ? quotation.refText.value : null,\n          refType: quotation.refType ? quotation.refType.value.split(\"/resource/\").reverse()[0] : null,\n        }\n      });\n    case 'CHANGE_QUOTATIONS_FOCUS':\n      var updatedState = state.map((quotation) =>{\n        if (quotation.id === action.id){\n          return{\n            ...quotation,\n            focused: true\n          }\n        }\n        else{\n          return{\n            ...quotation,\n            focused: false\n          }\n        }\n      });\n      return [\n        ...updatedState,\n      ];\n    default:\n      return state;\n  };\n};\n","export var focusedQuotationReducer = (state = {}, action) => {\n  switch (action.type){\n    case 'CREATE_FOCUSED_QUOTATION':\n      return action.quotation;\n    case 'CLEAR_FOCUSED_QUOTATION':\n      return {}\n    default:\n      return state;\n  };\n};\n","export var canonicalQuotationReducer = (state = {}, action) => {\n  switch (action.type){\n    case 'CREATE_CANONICAL_QUOTATION':\n      return action.quotation;\n    case 'CLEAR_CANONICAL_QUOTATION':\n      return null;\n    default:\n      return state;\n  };\n};\n","export var canonicalQuotationsReducer = (state = [], action) => {\n  switch (action.type){\n    case 'ADD_CANONICAL_QUOTATIONS':\n      return [\n        ...state,\n        ...action.quotations\n      ];\n    case 'CLEAR_CANONICAL_QUOTATIONS':\n      return []\n    case 'START_CANONICAL_QUOTATIONS_FETCH':\n      return []\n    case 'COMPLETE_CANONICAL_QUOTATIONS_FETCH':\n\n      return action.canonicalQuotations.map((quotation) => {\n        return {\n          id: quotation.quotation.value,\n          quotation: quotation.quotation_text.value,\n          citation: quotation.citation ? quotation.citation.value : \"citation not yet recorded\",\n          focused: false,\n        }\n      });\n    case 'CLEAR_CANONICAL_QUOTATIONS_FOCUS':\n      return state.map((quotation) => {\n        return{\n          ...quotation,\n          focused: false\n        }\n      });\n    case 'CHANGE_CANONICAL_QUOTATIONS_FOCUS':\n      var updatedState = state.map((quotation) =>{\n        if (quotation.id === action.id){\n          return{\n            ...quotation,\n            focused: true\n          }\n        }\n        else{\n          return{\n            ...quotation,\n            focused: false\n          }\n        }\n      });\n      return [\n        ...updatedState,\n      ];\n    default:\n      return state;\n  };\n};\n","/// manifestation quotations reducer\nexport var manifestationQuotationsReducer = (state = [], action) => {\n  switch (action.type){\n    case 'ADD_MANIFESTATION_QUOTATIONS':\n      return [\n        ...state,\n        ...action.quotations\n      ];\n    case 'CLEAR_MANIFESTATION_QUOTATIONS':\n      return []\n    case 'START_MANIFESTATION_QUOTATIONS_FETCH':\n      return []\n    case 'COMPLETE_MANIFESTATION_QUOTATIONS_FETCH':\n\n      return action.manifestationQuotations.map((quotation) => {\n        return {\n          id: quotation.quotation.value,\n          quotation: quotation.quotation_text.value,\n          focused: false,\n          isManifestationOf: quotation.isManifestationOf ? quotation.isManifestationOf.value : null,\n          canonicalTranscription: quotation.canonicalTranscription ? quotation.canonicalTranscription.value : null\n        }\n      });\n    case 'CLEAR_MANIFESTATION_QUOTATIONS_FOCUS':\n      return state.map((quotation) => {\n        return{\n          ...quotation,\n          focused: false\n        }\n      });\n    case 'CHANGE_MANIFESTATION_QUOTATIONS_FOCUS':\n      var updatedState = state.map((quotation) =>{\n        if (quotation.id === action.id){\n          return{\n            ...quotation,\n            focused: true\n          }\n        }\n        else{\n          return{\n            ...quotation,\n            focused: false\n          }\n        }\n      });\n      return [\n        ...updatedState,\n      ];\n    default:\n      return state;\n  };\n};\n","export var paragraphReducer = (state = {}, action) => {\n  switch (action.type){\n    case 'ADD_PARAGRAPH':\n      return action.paragraph;\n    case 'CLEAR_PARAGRAPH':\n      return {}\n    case 'START_PARAGRAPH_FETCH':\n      return {}\n    case 'COMPLETE_PARAGRAPH_FETCH':\n      return action.paragraph\n    case 'START_REVIEW_FETCH':\n      return state\n    case 'COMPLETE_REVIEW_FETCH':\n      return {\n        ...state,\n        review: action.review\n      }\n    default:\n      return state;\n  }\n};\n","export var sourceParagraphReducer = (state = {}, action) => {\n  switch (action.type){\n    case 'ADD_SOURCE_PARAGRAPH':\n      return action.sourceParagraph;\n    case 'CLEAR_SOURCE_PARAGRAPH':\n      return {}\n    case 'START_SOURCE_PARAGRAPH_FETCH':\n      return {}\n    case 'COMPLETE_SOURCE_PARAGRAPH_FETCH':\n      return action.sourceParagraph\n    case 'START_SOURCE_PARAGRAPH_REVIEW_FETCH':\n      return state\n    case 'COMPLETE_SOURCE_PARAGRAPH_REVIEW_FETCH':\n      return {\n        ...state,\n        review: action.review\n      }\n    default:\n      return state;\n  }\n};\n","// paragraphReducer\nexport var fullTextReducer = (state = {}, action) => {\n  switch (action.type){\n    case 'TOGGLE_FULL_TEXT_DISPLAY':\n      return {\n        ...state,\n        visible: !action.current\n      }\n    case 'ADD_FULL_TEXT':\n      return {\n        ...state,\n        textInfo: action.text\n      }\n    case 'CLEAR_FULL_TEXT':\n      return {\n        ...state,\n        textInfo: {}\n      }\n    case 'START_FULL_TEXT_FETCH':\n      return {\n        ...state,\n        textInfo: {}\n      }\n    case 'COMPLETE_FULL_TEXT_FETCH':\n      return {\n        ...state,\n        textInfo: action.text\n      }\n    default:\n      return state;\n  }\n};\n","\n\n\nimport {searchReducer} from '../reducers/searchReducer';\nimport {chartReducer} from \"../reducers/chartReducer\";\nimport {imagesReducer} from \"../reducers/imagesReducer\";\nimport {quotationsReducer} from \"../reducers/quotationsReducer\";\nimport {focusedQuotationReducer} from \"../reducers/focusedQuotationReducer\";\nimport {canonicalQuotationReducer} from \"../reducers/canonicalQuotationReducer\";\nimport {canonicalQuotationsReducer} from \"../reducers/canonicalQuotationsReducer\";\nimport {manifestationQuotationsReducer} from \"../reducers/manifestationQuotationsReducer\";\nimport {paragraphReducer} from \"../reducers/paragraphReducer\";\nimport {sourceParagraphReducer} from \"../reducers/sourceParagraphReducer\";\nimport {fullTextReducer} from \"../reducers/fullTextReducer\";\n\nvar redux = require('redux')\nvar thunk = require('redux-thunk').default;\n\nexport var configure = (initialState = {}) => {\n  var reducer = redux.combineReducers({\n    search: searchReducer,\n    quotations: quotationsReducer,\n    focusedQuotation: focusedQuotationReducer,\n    canonicalQuotation: canonicalQuotationReducer,\n    canonicalQuotations: canonicalQuotationsReducer,\n    manifestationQuotations: manifestationQuotationsReducer,\n    paragraph: paragraphReducer,\n    sourceParagraph: sourceParagraphReducer,\n    chart: chartReducer,\n    images: imagesReducer,\n    fullText: fullTextReducer,\n\n  })\n\n  var store = redux.createStore(reducer, initialState, redux.compose(\n    redux.applyMiddleware(thunk),\n    window.devToolsExtension ?window.devToolsExtension() : f => f\n  ));\n  return store;\n}\n","var behaviors = require('./behaviors');\nclass CETEI {\n\n    constructor(base){\n        this.els = [];\n        this.behaviors = [];\n        this.hasStyle = false;\n        this.prefixes = [];\n        if (base) {\n          this.base = base;\n        } else {\n          try {\n            if (window) {\n              this.base = window.location.href.replace(/\\/[^\\/]*$/, \"/\");\n            }\n          } catch (e) {\n            this.base = \"\";\n          }\n        }\n        this.behaviors.push(behaviors);\n        //this.shadowCSS;\n        this.supportsShadowDom = document.head.createShadowRoot || document.head.attachShadow;\n    }\n\n    // public method\n    /* Returns a Promise that fetches a TEI source document from the URL\n       provided in the first parameter and then calls the makeHTML5 method\n       on the returned document.\n     */\n    getHTML5(TEI_url, callback, perElementFn){\n        if (window.location.href.startsWith(this.base) && (TEI_url.indexOf(\"/\") >= 0)) {\n          this.base = TEI_url.replace(/\\/[^\\/]*$/, \"/\");\n        }\n        // Get TEI from TEI_url and create a promise\n        let promise = new Promise( function (resolve, reject) {\n            let client = new XMLHttpRequest();\n\n            client.open('GET', TEI_url);\n            client.send();\n\n            client.onload = function () {\n              if (this.status >= 200 && this.status < 300) {\n                resolve(this.response);\n              } else {\n                reject(this.statusText);\n              }\n            };\n            client.onerror = function () {\n              reject(this.statusText);\n            };\n        })\n        .catch( function(reason) {\n            // TODO: better error handling?\n            console.log(reason);\n        });\n\n        return promise.then((TEI) => {\n            return this.makeHTML5(TEI, callback, perElementFn);\n        });\n\n    }\n\n    /* Converts the supplied TEI string into HTML5 Custom Elements. If a callback\n       function is supplied, calls it on the result.\n     */\n    makeHTML5(TEI, callback, perElementFn){\n      // TEI is assumed to be a string\n      let TEI_dom = ( new DOMParser() ).parseFromString(TEI, \"text/xml\");\n      var doc = this.domToHTML5(TEI_dom, callback, perElementFn);\n      return this.registerTEIElements(doc, callback);\n\n    }\n\n    /* Converts the supplied TEI DOM into HTML5 Custom Elements. If a callback\n       function is supplied, calls it on the result.\n    */\n    domToHTML5(TEI_dom, callback, perElementFn){\n\n      this._fromTEI(TEI_dom);\n\n      let convertEl = (el) => {\n          // Create new element. TEI elements get prefixed with 'tei-',\n          // TEI example elements with 'teieg-'. All others keep\n          // their namespaces and are copied as-is.\n          let newElement;\n          let copy = false;\n          switch (el.namespaceURI) {\n            case \"http://www.tei-c.org/ns/1.0\":\n              newElement = document.createElement(\"tei-\" + el.tagName);\n              break;\n            case \"http://www.tei-c.org/ns/Examples\":\n              if (el.tagName == \"egXML\") {\n                newElement = document.createElement(\"teieg-\" + el.tagName);\n                break;\n              }\n            case \"http://relaxng.org/ns/structure/1.0\":\n              newElement = document.createElement(\"rng-\" + el.tagName);\n              break;\n            default:\n              newElement = document.importNode(el, false);\n              copy = true;\n          }\n          // Copy attributes; @xmlns, @xml:id, @xml:lang, and\n          // @rendition get special handling.\n          for (let att of Array.from(el.attributes)) {\n              if (!att.name.startsWith(\"xmlns\") || copy) {\n                newElement.setAttribute(att.name, att.value);\n              } else {\n                if (att.name == \"xmlns\")\n                newElement.setAttribute(\"data-xmlns\", att.value); //Strip default namespaces, but hang on to the values\n              }\n              if (att.name == \"xml:id\" && !copy) {\n                newElement.setAttribute(\"id\", att.value);\n              }\n              if (att.name == \"xml:lang\" && !copy) {\n                newElement.setAttribute(\"lang\", att.value);\n              }\n              if (att.name == \"rendition\") {\n                newElement.setAttribute(\"class\", att.value.replace(/#/g, \"\"));\n              }\n          }\n          // Preserve element name so we can use it later\n          newElement.setAttribute(\"data-teiname\", el.localName);\n          // If element is empty, flag it\n          if (el.childNodes.length == 0) {\n            newElement.setAttribute(\"data-empty\", \"\");\n          }\n          // Turn <rendition scheme=\"css\"> elements into HTML styles\n          if (el.localName == \"tagsDecl\") {\n            let style = document.createElement(\"style\");\n            for (let node of Array.from(el.childNodes)){\n              if (node.nodeType == Node.ELEMENT_NODE && node.localName == \"rendition\" && node.getAttribute(\"scheme\") == \"css\") {\n                let rule = \"\";\n                if (node.hasAttribute(\"selector\")) {\n                  //rewrite element names in selectors\n                  rule += node.getAttribute(\"selector\").replace(/([^#, >]+\\w*)/g, \"tei-$1\").replace(/#tei-/g, \"#\") + \"{\\n\";\n                  rule += node.textContent;\n                } else {\n                  rule += \".\" + node.getAttribute(\"xml:id\") + \"{\\n\";\n                  rule += node.textContent;\n                }\n                rule += \"\\n}\\n\";\n                style.appendChild(document.createTextNode(rule));\n              }\n            }\n            if (style.childNodes.length > 0) {\n              newElement.appendChild(style);\n              this.hasStyle = true;\n            }\n          }\n          // Get prefix definitions\n          if (el.localName == \"prefixDef\") {\n            this.prefixes.push(el.getAttribute(\"ident\"));\n            this.prefixes[el.getAttribute(\"ident\")] =\n              {\"matchPattern\": el.getAttribute(\"matchPattern\"),\n              \"replacementPattern\": el.getAttribute(\"replacementPattern\")};\n          }\n          for (let node of Array.from(el.childNodes)){\n              if (node.nodeType == Node.ELEMENT_NODE) {\n                  newElement.appendChild(  convertEl(node)  );\n              }\n              else {\n                  newElement.appendChild(node.cloneNode());\n              }\n          }\n          if (perElementFn) {\n            perElementFn(newElement);\n          }\n          return newElement;\n      }\n\n      return this.dom = convertEl(TEI_dom.documentElement);\n\n\n    }\n\n    registerTEIElements(doc, callback){\n\n      if (doc.registerElement) {\n        this.registerAll(this.els);\n      } else {\n        this.fallback(this.els);\n      }\n      this.done = true;\n      if (callback) {\n          callback(this.dom, this);\n      }\n      else {\n          return this.dom;\n      }\n\n    }\n\n    /* If the TEI document defines CSS styles in its tagsDecl, this method\n       copies them into the wrapper HTML document's head.\n     */\n    addStyle(doc, data) {\n      if (this.hasStyle) {\n        doc.getElementsByTagName(\"head\").item(0).appendChild(data.getElementsByTagName(\"style\").item(0).cloneNode(true));\n      }\n    }\n\n    /* If a URL where CSS for styling Shadow DOM elements lives has been defined,\n       insert it into the Shadow DOM.\n     */\n    addShadowStyle(shadow) {\n      if (this.shadowCSS) {\n        shadow.innerHTML = \"<style>\" + \"@import url(\\\"\" + this.shadowCSS + \"\\\");</style>\" + shadow.innerHTML;\n      }\n    }\n\n    /* Add a user-defined set of behaviors to CETEIcean's processing\n       workflow. Added behaviors will override predefined behaviors with the\n       same name.\n    */\n    addBehaviors(bhvs){\n      if (bhvs[\"handlers\"] || bhvs [\"fallbacks\"]) {\n        this.behaviors.push(bhvs);\n      } else {\n        console.log(\"No handlers or fallback methods found.\");\n      }\n    }\n\n    /* Sets the base URL for the document. Used to rewrite relative links in the\n       XML source (which may be in a completely different location from the HTML\n       wrapper).\n     */\n    setBaseUrl(base) {\n      this.base = base;\n    }\n\n    // \"private\" method\n    _fromTEI(TEI_dom) {\n        let root_el = TEI_dom.documentElement;\n        this.els = new Set( Array.from(root_el.getElementsByTagNameNS(\"http://www.tei-c.org/ns/1.0\", \"*\"), x => x.tagName) );\n        this.els.add(\"egXML\"); // Special case—not in TEI namespace, but needs to be handled\n        this.els.add(root_el.tagName); // Add the root element to the array\n    }\n\n    // private method\n    _insert(elt, strings) {\n      let span = document.createElement(\"span\");\n      if (strings.length > 1) {\n        if (strings[0].includes(\"<\") && strings[1].includes(\"</\")) {\n          span.innerHTML = strings[0] + elt.innerHTML + strings[1];\n        } else {\n          span.innerHTML = \"<span>\" + strings[0] + \"</span>\" + elt.innerHTML + \"<span>\" + strings[1] + \"</span>\";\n        }\n      } else {\n        if (strings[0].includes(\"<\")) {\n          span.innerHTML = strings[0] + elt.innerHTML;\n        } else {\n          span.innerHTML = \"<span>\" + strings[0] + \"</span>\" + elt.innerHTML;\n        }\n      }\n      if (span.children.length > 1) {\n        return span;\n      } else {\n        return span.children[0];\n      }\n    }\n\n    // private method\n    _template(str, elt) {\n      let result = str;\n      if (str.search(/$(\\w*)@(\\w+)/)) {\n        let re = /\\$(\\w*)@(\\w+)/g;\n        let replacements;\n        while (replacements = re.exec(str)) {\n          if (elt.hasAttribute(replacements[2])) {\n            if (replacements[1] && this[replacements[1]]) {\n              result = result.replace(replacements[0], this[replacements[1]].call(this, elt.getAttribute(replacements[2])));\n            } else {\n              result = result.replace(replacements[0], elt.getAttribute(replacements[2]));\n            }\n          }\n        }\n      }\n      return result;\n    }\n\n    tagName(name) {\n      if (name == \"egXML\") {\n        return \"teieg-\" + name;\n      } else {\n        return \"tei-\" + name;\n      }\n    }\n\n    /* Takes a template in the form of an array of 1 or 2 strings and\n       returns a closure around a function that can be called as\n       a createdCallback or applied to an individual element.\n       Called by the getHandler() and getFallback() methods\n    */\n    decorator(strings) {\n      let ceteicean = this;\n      return function (elt) {\n        let copy = [];\n        for (let i = 0; i < strings.length; i++) {\n          copy.push(ceteicean._template(strings[i], elt));\n        }\n        return ceteicean._insert(elt, copy);\n      }\n    }\n\n    /* Returns the handler function for the given element name\n       Called by registerAll().\n     */\n    getHandler(fn) {\n      for (let i = this.behaviors.length - 1; i >= 0; i--) {\n        if (this.behaviors[i][\"handlers\"][fn]) {\n          if (Array.isArray(this.behaviors[i][\"handlers\"][fn])) {\n            return this.append(this.decorator(this.behaviors[i][\"handlers\"][fn]));\n          } else {\n            return this.append(this.behaviors[i][\"handlers\"][fn]);\n          }\n        }\n      }\n    }\n\n    /* Returns the fallback function for the given element name.\n       Called by fallback().\n     */\n    getFallback(fn) {\n      for (let i = this.behaviors.length - 1; i >= 0; i--) {\n        if (this.behaviors[i][\"handlers\"][fn]) {\n          if (Array.isArray(this.behaviors[i][\"handlers\"][fn])) {\n            return this.decorator(this.behaviors[i][\"handlers\"][fn]);\n          } else {\n            return this.behaviors[i][\"handlers\"][fn];\n          }\n        }\n      }\n    }\n\n    /* Appends any element returned by the function passed in the first\n     * parameter to the element in the second parameter. If the function\n     * returns nothing, this is a no-op aside from any side effects caused\n     * by the provided function.\n     * called by getHandler() and fallback()\n     */\n    append(fn, elt) {\n      if (elt) {\n        let content = fn.call(this, elt);\n        if (content && !(elt.querySelector(\":scope > \" + content.nodeName))) {\n          if (this.supportsShadowDom) {\n            this._appendShadow(elt, content);\n          } else {\n            this._appendBasic(elt, content);\n          }\n        }\n      } else {\n        let self = this;\n        if (this.supportsShadowDom) {\n          return function() {\n            let content = fn.call(self, this);\n            if (content) {\n              self._appendShadow(this, content);\n            }\n          }\n        } else {\n          return function() {\n            let content = fn.call(self, this);\n            if (content && !(this.querySelector(\":scope > \" + content.nodeName))) {\n              self._appendBasic(this, content);\n            }\n          }\n        }\n      }\n    }\n\n    /* Private method called by append() if the browser supports Shadow DOM\n     */\n    _appendShadow(elt, content) {\n      var shadow = elt.attachShadow({mode:'open'});\n      this.addShadowStyle(shadow);\n      shadow.appendChild(content);\n    }\n\n    /* Private method called by append() if the browser does not support\n     * Shadow DOM\n     */\n    _appendBasic(elt, content) {\n      this.hideContent(elt);\n      elt.appendChild(content);\n    }\n\n    /* Registers the list of elements provided with the browser.\n       Called by makeHTML5(), but can be called independently if, for example,\n       you've created Custom Elements via an XSLT transformation instead.\n     */\n    registerAll(names) {\n      for (let name of names) {\n        let proto = Object.create(HTMLElement.prototype);\n        let fn = this.getHandler(name);\n        if (fn) {\n          proto.createdCallback = fn;\n        }\n        let prefixedName = this.tagName(name);\n        try {\n          document.registerElement(prefixedName, {prototype: proto});\n        } catch (error) {\n          console.log(prefixedName + \" couldn't be registered or is already registered.\");\n          console.log(error);\n        }\n\n      }\n    }\n\n    /* Provides fallback functionality for browsers where Custom Elements\n       are not supported.\n       Like registerAll(), this is called by makeHTML5(), but can be called\n       independently.\n    */\n    fallback(names) {\n      for (let name of names) {\n        let fn = this.getFallback(name);\n        if (fn) {\n          for (let elt of Array.from(this.dom.getElementsByTagName(this.tagName(name)))) {\n            this.append(fn, elt);\n          }\n        }\n      }\n    }\n\n    /**********************\n     * Utility functions  *\n     **********************/\n\n    /* Takes a relative URL and rewrites it based on the base URL of the\n       HTML document */\n    rw(url) {\n      if (!url.match(/^(?:http|mailto|file|\\/|#).*$/)) {\n        return this.base + url;\n      } else {\n        return url;\n      }\n    }\n\n    /* Given a space-separated list of URLs (e.g. in a ref with multiple\n       targets), returns just the first one.\n     */\n    first(urls) {\n      return urls.replace(/ .*$/, \"\");\n    }\n\n    /* Takes an element and serializes it to a string or, if the stripElt\n       parameter is set, serializes the element's content.\n     */\n    serialize(el, stripElt) {\n      let str = \"\";\n      if (!stripElt) {\n        str += \"&lt;\" + el.getAttribute(\"data-teiname\");\n        for (let attr of Array.from(el.attributes)) {\n          if (!attr.name.startsWith(\"data-\") && !([\"id\", \"lang\", \"class\"].includes(attr.name))) {\n            str += \" \" + attr.name + \"=\\\"\" + attr.value + \"\\\"\";\n          }\n          if (attr.name == \"data-xmlns\") {\n            str += \" xmlns=\\\"\" + attr.value +\"\\\"\";\n          }\n        }\n        if (el.childNodes.length > 0) {\n          str += \">\";\n        } else {\n          str += \"/>\";\n        }\n      }\n      for (let node of Array.from(el.childNodes)) {\n        switch (node.nodeType) {\n          case Node.ELEMENT_NODE:\n            str += this.serialize(node);\n            break;\n          case Node.PROCESSING_INSTRUCTION_NODE:\n            str += \"&lt;?\" + node.nodeValue + \"?>\";\n            break;\n          case Node.COMMENT_NODE:\n            str += \"&lt;!--\" + node.nodeValue + \"-->\";\n            break;\n          default:\n            str += node.nodeValue.replace(/</g, \"&lt;\");\n        }\n      }\n      if (!stripElt && el.childNodes.length > 0) {\n        str += \"&lt;/\" + el.getAttribute(\"data-teiname\") + \">\";\n      }\n      return str;\n    }\n\n    /* Wraps the content of the element parameter in a <span class=\"hide\">\n     * with display set to \"none\".\n     */\n    hideContent(elt) {\n      if (elt.childNodes.length > 0) {\n        let content = elt.innerHTML;\n        elt.innerHTML = \"\";\n        let hidden = document.createElement(\"span\");\n        hidden.setAttribute(\"style\", \"display:none;\");\n        hidden.setAttribute(\"class\", \"hide\");\n        hidden.innerHTML = content;\n        elt.appendChild(hidden);\n      }\n    }\n\n    unEscapeEntities(str) {\n      return str.replace(/&gt;/, \">\")\n                .replace(/&quot;/, \"\\\"\")\n                .replace(/&apos;/, \"'\")\n                .replace(/&amp;/, \"&\");\n    }\n\n    savePosition() {\n      localStorage.setItem(\"scroll\",window.scrollY);\n    }\n\n    restorePosition() {\n      if (localStorage.getItem(\"scroll\")) {\n        window.scrollTo(0, localStorage.getItem(\"scroll\"));\n      }\n    }\n\n    // public method\n    fromODD(){\n        // Place holder for ODD-driven setup.\n        // For example:\n        // Create table of elements from ODD\n        //    * default HTML behaviour mapping on/off (eg tei:div to html:div)\n        //    ** phrase level elements behave like span (can I tell this from ODD classes?)\n        //    * optional custom behaviour mapping\n    }\n\n\n\n}\n\n// Make main class available to pre-ES6 browser environments\ntry {\n  if (window) {\n      window.CETEI = CETEI;\n      window.unload = CETEI.savePosition;\n      window.load = CETEI.restorePosition;\n  }\n} catch (e) {\n  // window not defined;\n}\n\n\nexport default CETEI;\n"],"sourceRoot":""}