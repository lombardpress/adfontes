{"version":3,"sources":["actions/actions.jsx","vendor/behaviors.js","components/Search.jsx","components/Quotation.jsx","components/QuotationList.jsx","components/FocusedQuotation.jsx","components/CanonicalQuotation.jsx","components/CanonicalQuotationListItem.jsx","components/CanonicalQuotationList.jsx","components/ManifestationQuotationListItem.jsx","components/ManifestationQuotationList.jsx","components/Paragraph.jsx","components/BarChart.jsx","components/Images.jsx","components/FullText.jsx","components/TodoApp.js","components/Main.jsx","index.js","reducers/searchReducer.jsx","reducers/chartReducer.jsx","reducers/imagesReducer.jsx","reducers/quotationsReducer.jsx","reducers/focusedQuotationReducer.jsx","reducers/canonicalQuotationReducer.jsx","reducers/canonicalQuotationsReducer.jsx","reducers/manifestationQuotationsReducer.jsx","reducers/paragraphReducer.jsx","reducers/sourceParagraphReducer.jsx","reducers/fullTextReducer.jsx","store/configureStore.jsx","vendor/CETEI.js"],"names":["sparqlEndpoint","clearSearchParameters","type","setSearchParameters","searchParameters","startSearchWorksFetch","completeSearchWorksFetch","listOfWorks","fetchSearchWorksList","dispatch","getState","state","workGroupSparql","search","workGroup","join","expressionAuthorTypeSparql","expressionAuthorType","authorSparql","expressionAuthor","query","axios","get","params","then","res","searchWorks","data","results","bindings","map","result","expression","value","expressionShortId","expressionTitle","workGroupTitle","author","authorTitle","startQuotationAuthorsFetch","completeQuotationAuthorsFetch","authors","fetchQuotationAuthors","quotationAuthorTypeSparql","quotationAuthorType","quotationAuthorDateSparql","quotationAuthorDateAfter","quotationAuthorDateBefore","quotationAuthorDateAfterSparqlFilter","quotationAuthorDateBeforeSparqlFilter","authorShortId","startExpressionAuthorsFetch","completeExpressionAuthorsFetch","fetchExpressionAuthors","expressionAuthorDateSparql","expressionAuthorDateAfter","expressionAuthorDateBefore","expressionAuthorDateAfterSparqlFilter","expressionAuthorDateBeforeSparqlFilter","startQuotationWorksListFetch","completeQuotationWorksListFetch","quotationWorksList","fetchQuotationWorksList","quotationWorkGroupSparql","quotationWorkGroup","quotationAuthorSparql","quotationAuthor","startQuotationWorkPartsFetch","completeQuotationWorkPartsFetch","parts","fetchQuotationWorkParts","quotationWorkPart","quotationWork","grandparent","grandparent_title","parent","parent_title","child","child_title","startExpressionPartsFetch","completeExpressionPartsFetch","fetchExpressionParts","currentNode","expressionPart","expressionId","grandparent_level","parent_level","child_level","startQuotationExpressionTypeFetch","completeQuotationExpressionTypeFetch","quotationExpressionTypes","fetchQuotationExpressionTypes","quotationExpressionType","quotationExpressionTypeShortId","quotationExpressionTypeTitle","startExpressionTypeFetch","completeExpressionTypeFetch","expressionTypes","fetchExpressionTypes","expressionType","expressionTypeShortId","expressionTypeTitle","startWorkGroupsFetch","completeWorkGroupsFetch","workGroups","fetchWorkGroups","workGroupShortId","startAuthorTypesFetch","completeAuthorTypesFetch","authorTypes","fetchAuthorTypes","authorType","authorTypeShortId","authorTypeTitle","toggleGraphDisplay","current","startChartFetch","completeChartFetch","count","fetchChart","level","parseInt","expressionLevel","searchText","expressionWorkGroupSparql","expressionAuthorSparql","expressionAuthorCoreSparql","searchShortId","quotationAuthorCoreSparql","quotationWorkSparql","structureElementTypeSparql","structureElementType","ref","reftitle","toggleImagesDisplay","startImagesFetch","completeImagesFetch","images","fetchImages","paragraph","manifestation_id","url","addQuotations","quotations","clearQuotations","startQuotationsFetch","clearQuotationsFocus","completeQuotationsFetch","fetchQuotations","expressionIdSparql","quotationExpressionTypeSparql","expressionTypeSparql","canonicalQuotation","id","changeQuotationsFocus","clearFocusedQuotation","createFocusedQuotation","quotation","createCanonicalQuotation","clearCanonicalQuotation","changeCanonicalQuotationsFocus","clearCanonicalQuotationsFocus","clearCanonicalQuotations","startCanonicalQuotationsFetch","completeCanonicalQuotationsFetch","canonicalQuotations","fetchCanonicalQuotations","quotationInstanceSparql","topLevelExpressionSparql","changeManifestationQuotationsFocus","clearManifestationQuotationsFocus","clearManifestationQuotations","startManifestationQuotationsFetch","completeManifestationQuotationsFetch","manifestationQuotations","fetchManifestationQuotations","undefined","focusedQuotation","clearParagraph","startParagraphFetch","completeParagraphFetch","fetchParagraph","quotationId","idType","hasXML","replace","res2","expression_id","manifestations","hasManifestations","hasDefaultManifestation","transcription_id","hasDefaultTranscription","transcription_item_file","hasDocument","paragraph_text","fetchReview","catch","err","console","log","startReviewFetch","completeReviewFetch","review","reviewUrl","clearSourceParagraph","startSourceParagraphFetch","completeSourceParagraphFetch","sourceParagraph","fetchSourceParagraph","source","startSourceParagraphReviewFetch","completeSourceParagraphReviewFetch","fetchSourceParagraphReview","toggleFullTextDisplay","clearFullText","startFullTextFetch","completeFullTextFetch","text","fetchFullText","xml_url","expression_item","manifestation_item","transcription_item","test","elt","content","Image","src","this","rw","getAttribute","hasAttribute","width","height","dl","document","createElement","Array","from","children","nodeType","Node","ELEMENT_NODE","localName","dt","innerHTML","appendChild","dd","table","firstElementChild","head","remove","caption","querySelectorAll","row","tr","attributes","attr","setAttribute","name","parentElement","replaceChild","cell","td","pre","serialize","module","exports","connect","require","actions","Search","props","handleSetSearchText","bind","handleOnShowQuotationsWithoutAssociation","handleRunQuery","handleGraph","handleClearFilters","e","refs","preventDefault","split","chart","visible","_this","displayWorkGroupsList","onSubmit","onClick","Group","Label","Control","as","onChange","placeholder","onBlur","quotationAuthors","work","quotationWorkParts","part","grandparentid","displayQuotationWorkPartsGrandparent","parentid","displayQuotationWorkPartsParent","childShortId","displayQuotationWorkParts","expressionAuthors","expressionParts","displayExpressionPartsGrandparent","displayExpressionPartsParent","displayExpressionParts","href","React","Component","Quotation","handleOnClick","isInstanceOf","newFocusedQuotationObject","canonicalQuotationObject","find","topPos","getElementById","offsetTop","$","animate","scrollTop","selfTopPos","alert","className","title","refText","citation","target","QuotationList","length","quotationClass","includes","refType","classes","key","FocusedQuotation","CanonicalQuotation","displayQuotation","displayQuotationId","CanonicalQuotationListItem","quotationObject","CanonicalQuotationList","focused","ManifestationQuotationListItem","handleToggleShowImage","handleToggleShowCitation","handleImageWrapperWraperClick","imageSize","imageFocus","showImage","showCitation","setState","prevState","isManifestationOf","isManifestationOfObject","canonicalTranscription","newManifestations","manifestation","manifestationTitle","transcription","focusedManifestation","tresourceid","ManifestationQuotationList","Paragraph","handleShowImages","handleShowFullText","runQueryForSource","addTEICustom","fullText","htmlText","cetei","makeHTML5","quoteid","pop","querySelector","childNodes","emptyTextNode","createTextNode","sourceId","constructor","m","showFullTextToggle","d3","BarChart","createBarChart","prevProps","selectAll","select","filter","d","i","countArray","margin","colors","scale","linear","domain","range","yScale","max","xScale","ordinal","rangeBands","tooltip","append","style","node","enter","rangeBand","on","transition","html","item","event","pageX","pageY","left","top","delay","duration","ease","vGuideScale","vAxis","svg","axis","orient","ticks","vGuide","fill","stroke","hAxis","tickValues","hGuide","Images","handleToggleImage","image","imageUrl","showImages","FullText","handleToggleFullText","textInfo","sourceid","TodoApp","quotationDisplay","size","barGraphDisplay","imagesDisplay","fullTextDisplay","Main","store","configure","subscribe","ReactDOM","render","searchReducer","action","chartReducer","imagesReducer","quotationsReducer","quotation_text","toplevel_expression_title","author_title","reverse","updatedState","focusedQuotationReducer","canonicalQuotationReducer","canonicalQuotationsReducer","manifestationQuotationsReducer","paragraphReducer","sourceParagraphReducer","fullTextReducer","redux","thunk","default","initialState","reducer","combineReducers","createStore","compose","applyMiddleware","window","devToolsExtension","f","behaviors","CETEI","base","els","hasStyle","prefixes","location","push","supportsShadowDom","createShadowRoot","attachShadow","TEI_url","callback","perElementFn","startsWith","indexOf","Promise","resolve","reject","client","XMLHttpRequest","open","send","onload","status","response","statusText","onerror","reason","TEI","TEI_dom","DOMParser","parseFromString","doc","domToHTML5","registerTEIElements","_fromTEI","dom","convertEl","el","newElement","copy","namespaceURI","tagName","importNode","att","rule","textContent","cloneNode","documentElement","registerElement","registerAll","fallback","done","getElementsByTagName","shadow","shadowCSS","bhvs","root_el","Set","getElementsByTagNameNS","x","add","strings","span","str","replacements","re","exec","call","ceteicean","_template","_insert","fn","isArray","decorator","self","_appendShadow","nodeName","_appendBasic","mode","addShadowStyle","hideContent","names","proto","Object","create","HTMLElement","prototype","getHandler","createdCallback","prefixedName","error","getFallback","match","urls","stripElt","PROCESSING_INSTRUCTION_NODE","nodeValue","COMMENT_NODE","hidden","localStorage","setItem","scrollY","getItem","scrollTo","unload","savePosition","load","restorePosition"],"mappings":"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BACrE0D,EAAgC,CAChC,IACE,sEACA,IACE,qGACA,8DACA,6DACA,mFAAqFzD,EAAiC,MACxH,IACA,QACA,IACE,yEACA,8DACA,iFAAmFA,EAAiC,MACtH,IACF,IACA,QACA,IACE,0EACA,IACE,0DACA,6DACA,mFAAqFA,EAAiC,MACxH,IACA,QACA,iEACA,IACE,0DACA,iFAAmFA,EAAiC,MACtH,IACF,KACA9E,KAAK,IAGP,IAAIH,EAAkB,GAClBD,EAAME,OAAOT,iBAAiBU,YAChCF,EAAkB,CAClB,8BAAgCD,EAAME,OAAOT,iBAAiBU,UAAY,sEACxEC,KAAK,KAGT,IAAIwI,EAAuB,GACvB5I,EAAME,OAAOT,iBAAiB+F,iBAChCoD,EAAuB,CACrB,4EACA,+FAAiG5I,EAAME,OAAOT,iBAAiB+F,eAAiB,OAChJpF,KAAK,KAGT,IAAImH,EAA6B,GAE/BA,EADyD,wBAAvDvH,EAAME,OAAOT,iBAAiB+H,qBACH,CAC3B,kHACA,QACA,4EACEpH,KAAK,IAEqD,2BAAvDJ,EAAME,OAAOT,iBAAiB+H,qBACR,gHAEiC,0BAAvDxH,EAAME,OAAOT,iBAAiB+H,qBACR,kHAEiC,WAAvDxH,EAAME,OAAOT,iBAAiB+H,qBACR,CAC3B,oHACA,QACA,oHACApH,KAAK,IAGsB,CAC3B,oHACA,QACA,mHACA,QACA,2EAEA,KACAA,KAAK,IAGT,IAAIK,EAAQ,GACZ,GAAIT,EAAM6I,mBAEJpI,EAAQ,CACN,oHACA,UACA,IAJqBT,EAAM6I,mBAAmBC,GAIjB,yDAC7B,aACA,sEACA,IACA,aACA,0DACA,IACAJ,EACArB,EACAjE,EACAkE,EACAqB,EACA,gFAEA,4FACAC,EACA3I,EACA,6FACAkH,EACA,aACE,+DACF,IACA,aACE,+DACA,oEACF,IACArE,EACAC,EACAV,EACAC,EACA,IACA,aACAlC,KAAK,SAGPK,EAAQ,CACR,qIACA,UACA8G,EACA,0EACA,wDACA,aACA,sEACA,IACA,aACA,0DACA,IACAmB,EACArB,EACAjE,EACAkE,EACAqB,EACA,gFACA,4FACAC,EACA3I,EACAM,EACA,6FACA4G,EACA,aACE,+DACF,IACA,aACE,+DACA,oEACF,IACArE,EACAC,EACAV,EACAC,EACA,wCAA0C0E,EAAa,aACvD,IACA,4BACA,aACA5G,KAAK,IAEXN,EAASwI,KACT5H,IAAMC,IAAItB,EAAgB,CAACuB,OAAQ,CAAC,MAAUH,EAAO,OAAU,UAAUI,KAAK,SAASC,GACrF,IAAIG,EAAUH,EAAIE,KAAKC,QAAQC,SAE/BpB,EAAS0I,EAAwBvH,QAM5B8H,EAAwB,SAACD,GAClC,MAAM,CACJvJ,KAAM,0BACNuJ,OAIOE,EAAwB,WACjC,MAAM,CACJzJ,KAAM,4BAIC0J,GAAyB,SAACC,GACnC,MAAM,CACJ3J,KAAM,2BACN2J,cAKOC,GAA2B,SAACD,GACrC,MAAM,CACJ3J,KAAM,6BACN2J,cAGOE,GAA0B,WACnC,MAAM,CACJ7J,KAAM,8BAMC8J,GAAiC,SAACP,GAC3C,MAAM,CACJvJ,KAAM,oCACNuJ,OAGOQ,GAAgC,WACzC,MAAM,CACJ/J,KAAM,qCAGCgK,GAA2B,WACpC,MAAM,CACJhK,KAAM,+BAGCiK,GAAgC,WACzC,MAAM,CACJjK,KAAM,qCAGCkK,GAAmC,SAACC,GAC7C,MAAM,CACJnK,KAAM,sCACNmK,wBAGOC,GAA2B,WACpC,OAAO,SAAC7J,EAAUC,GAChB,IAAIC,EAAQD,IACRiH,EAAahH,EAAME,OAAOT,iBAAiBuH,YAAc,GAGzD4C,EAA0B,IAC1B5J,EAAME,OAAOT,iBAAiBgF,cAAgBzE,EAAME,OAAOT,iBAAiBe,kBAAoBR,EAAME,OAAOT,iBAAiBU,aAChIyJ,EAA0B,CAC1B,2EACExJ,KAAK,KAET,IAAIyJ,EAA2B,IAC3B7J,EAAME,OAAOT,iBAAiBe,kBAAoBR,EAAME,OAAOT,iBAAiBU,aAClF0J,EAA2B,CAC3B,oGACEzJ,KAAK,KAOT,IAAIsI,EAAqB,GACzB,GAAI1I,EAAME,OAAOT,iBAAiBgF,cAAgBzE,EAAME,OAAOT,iBAAiB+E,eAE1EkE,EAAqB,CACzB,yFAFItB,EAAiBpH,EAAME,OAAOT,iBAAiB+E,eAAkBxE,EAAME,OAAOT,iBAAiB+E,eAAiBxE,EAAME,OAAOT,iBAAiBgF,cAExC,OACxGrE,KAAK,IAIT,IAAIC,EAA6B,GAC7BL,EAAME,OAAOT,iBAAiBa,uBAChCD,EAA6B,uFAAyFL,EAAME,OAAOT,iBAAiBa,qBAAuB,SAG7K,IAAIqC,EAA6B,IAC7B3C,EAAME,OAAOT,iBAAiBmD,2BAA6B5C,EAAME,OAAOT,iBAAiBoD,8BAC3FF,EACI,4FAEN,IAAIG,EAAwC,GACxC9C,EAAME,OAAOT,iBAAiBmD,4BAChCE,EAAwC,4CAA8C9C,EAAME,OAAOT,iBAAiBmD,0BAA4B,OAElJ,IAAIG,EAAyC,GACzC/C,EAAME,OAAOT,iBAAiBoD,6BAC9BE,EAAyC,4CAA8C/C,EAAME,OAAOT,iBAAiBoD,2BAA6B,OAItJ,IAAItC,EAAe,GACfP,EAAME,OAAOT,iBAAiBe,mBAChCD,EAAe,+FAAiGP,EAAME,OAAOT,iBAAiBe,iBAAmB,OAGnK,IAAI2G,EAA6B,CAC/B,0EACA,mGACA,wFACA9G,EACAsC,EACApC,GACAH,KAAK,IAKH4B,EAA4B,GAC5BhC,EAAME,OAAOT,iBAAiBwC,sBAEhCD,EAA4B,sFADNhC,EAAME,OAAOT,iBAAiBwC,oBACgF,SAGtI,IAAIC,EAA4B,IAC5BlC,EAAME,OAAOT,iBAAiB0C,0BAA4BnC,EAAME,OAAOT,iBAAiB2C,6BAC1FF,EACI,0FAEN,IAAIG,EAAuC,GACvCrC,EAAME,OAAOT,iBAAiB0C,2BAChCE,EAAuC,2CAA6CrC,EAAME,OAAOT,iBAAiB0C,yBAA2B,OAE/I,IAAIG,EAAwC,GACxCtC,EAAME,OAAOT,iBAAiB2C,4BAC9BE,EAAwC,2CAA6CtC,EAAME,OAAOT,iBAAiB2C,0BAA4B,OAGnJ,IAAIkB,EAAwB,GACxBtD,EAAME,OAAOT,iBAAiB8D,kBAEhCD,EAAwB,uGADpB8D,EAAiBpH,EAAME,OAAOT,iBAAiB8D,iBAC6F,SAElJ,IAAI8D,EAA4B,CAC9B,0DACA,gGACA,6FACArF,EACAE,EACAoB,GACAlD,KAAK,IAIHgD,EAA2B,GAC/B,GAAIpD,EAAME,OAAOT,iBAAiB4D,mBAAmB,CACnD,IAAI+D,EAAiBpH,EAAME,OAAOT,iBAAiB4D,mBACnDD,EAA2B,CACzB,0DACA,gGACA,8BAAgCpD,EAAME,OAAOT,iBAAiB4D,mBAAqB,6EACnFjD,KAAK,IAGT,IAAIkH,EAAsB,IACtBtH,EAAME,OAAOT,iBAAiBoE,eAAiB7D,EAAME,OAAOT,iBAAiBmE,qBAIjF0D,EAAsB,CACpB,IACE,oFACA,0DACA,8EAPEF,EAAiBpH,EAAME,OAAOT,iBAAiBmE,kBAAqB5D,EAAME,OAAOT,iBAAiBmE,kBAAoB5D,EAAME,OAAOT,iBAAiBoE,eAOvD,OACjG,IACA,QACA,2EACA,IACE,4EAA8EuD,EAAgB,MAChG,KACEhH,KAAK,KAGT,IAAIuI,EAAgC,GACpC,GAAI3I,EAAME,OAAOT,iBAAiBwF,wBAAwB,CACxD,IAAMC,EAAiClF,EAAME,OAAOT,iBAAiBwF,wBAErE0D,EAAgC,CAC9B,IACE,oFACA,0DACA,6DACA,mFAAqFzD,EAAiC,OACxH,IACA,QACA,2EACA,IACE,0DACA,iFAAmFA,EAAiC,MACtH,KACE9E,KAAK,IAGb,IAAIH,EAAkB,GAChBD,EAAME,OAAOT,iBAAiBU,YAChCF,EAAkB,CAGlB,8BAAgCD,EAAME,OAAOT,iBAAiBU,UAAY,sEACxEC,KAAK,KAIT,IAAIwI,EAAuB,GACvB5I,EAAME,OAAOT,iBAAiB+F,iBAChCoD,EAAuB,CAErB,0EACA,oFACA,+FAAiG5I,EAAME,OAAOT,iBAAiB+F,eAAiB,OAChJpF,KAAK,KAIT,IAAIK,EAAQ,CACN,wDACA,UACA,uDACA,qEACAmI,EACAgB,EACAC,EACA1C,EACAlH,EACAoH,EACAjE,EACAkE,EACAqB,EACAD,EACA,cACA,8DACA,IACArG,EACAC,EACAS,EACAD,EACA,wCAA0CkE,EAAa,aACvD,IACA,sBACA,cACA5G,KAAK,IACXN,EAASwI,KACT5H,IAAMC,IAAItB,EAAgB,CAACuB,OAAQ,CAAC,MAAUH,EAAO,OAAU,UAAUI,KAAK,SAASC,GACrF,IAAIG,EAAUH,EAAIE,KAAKC,QAAQC,SAC/BpB,EAAS2J,GAAiCxI,QAOrC6I,GAAqC,SAAChB,GAC/C,MAAM,CACJvJ,KAAM,wCACNuJ,OAGOiB,GAAoC,WAC7C,MAAM,CACJxK,KAAM,yCAGCyK,GAA+B,WACxC,MAAM,CACJzK,KAAM,mCAGC0K,GAAoC,WAC7C,MAAM,CACJ1K,KAAM,yCAGC2K,GAAuC,SAACC,GACjD,MAAM,CACJ5K,KAAM,0CACN4K,4BAGOC,GAA+B,WACxC,OAAO,SAACtK,EAAUC,GAChB,IAAIC,EAAQD,IACRiH,EAAahH,EAAME,OAAOT,iBAAiBuH,YAAc,GAEzDvG,EAAQ,QAEqB4J,GAA7BrK,EAAMsK,iBAAiBxB,GAEzBrI,EAAQ,CACF,gFACA,UACA,IAJsBT,EAAMsK,iBAAiBxB,GAIf,8DAC9B,gFACA,gFACA,WACA,IACE,6FACF,IACA,KACA1I,KAAK,IAGXK,EAAQ,CACJ,gFACA,UACA,kHACA,2DACA,gFACA,gFACA,WACA,IACE,6FACF,IACA,wCAA0CuG,EAAa,aACvD,IACA,0BACA,aACA5G,KAAK,IAGXN,EAASmK,MACTvJ,IAAMC,IAAItB,EAAgB,CAACuB,OAAQ,CAAC,MAAUH,EAAO,OAAU,UAAUI,KAAK,SAASC,GACrF,IAAIG,EAAUH,EAAIE,KAAKC,QAAQC,SAE/BpB,EAASoK,GAAqCjJ,QAOzCsJ,GAAiB,WAC1B,MAAM,CACJhL,KAAM,oBAICiL,GAAsB,WAC/B,MAAM,CACJjL,KAAM,0BAGCkL,GAAyB,SAACzC,GACnC,MAAM,CACJzI,KAAM,2BACNyI,cAGO0C,GAAiB,WAC1B,OAAO,SAAC5K,EAAUC,GAChB,IAAIC,EAAQD,IAEZ,GAAIC,EAAMsK,iBAAiB,CACzB,IAAIK,EAAc3K,EAAMsK,iBAAiBxB,GAErCrI,EAAQ,GACRmK,EAAS5K,EAAMsK,iBAAiB/K,KAErB,eAAXqL,EACFnK,EAAQ,CACN,YACA,IACE,uGACA,kEACA,iFACA,0EACA,qEACA,gDACF,IACA,WACE,IAAMkK,EAAc,+EACpB,yGACA,uFACA,iGACA,4GACA,mGACA,yFACA,yEACF,KACEvK,KAAK,IAES,kBAAXwK,IACPnK,EAAQ,CACN,YACA,IACE,uGACC,kEACA,iFACA,0EACA,qEACA,gDACH,IACA,WACE,IAAMkK,EAAc,mFACpB,iGACA,uFACA,4GACA,mGACA,yFACA,yEACF,KACAvK,KAAK,KAGTN,EAAS0K,MACT9J,IAAMC,IAAItB,EAAgB,CAACuB,OAAQ,CAAC,MAAUH,EAAO,OAAU,UAAUI,KAAK,SAASC,GACrF,IAAIG,EAAUH,EAAIE,KACdC,EAAQ4J,QACVnK,IAAMC,IAAIM,EAAQ4J,OAAOC,QAAQ,UAAW,aAAajK,KAAK,SAASkK,GACrE,IAAI/C,EAAY,CACdgD,cAAe/J,EAAQ,OACvBgK,eAAgBhK,EAAQiK,kBACxBjD,iBAAkBhH,EAAQkK,wBAC1BC,iBAAkBnK,EAAQoK,wBAC1BC,wBAAyBrK,EAAQsK,YAAYT,QAAQ,UAAW,YAChEU,eAAgBT,EAAK/J,MAEvBlB,EAAS2K,GAAuBzC,IAChClI,EAAS2L,UAGZC,MAAM,SAACC,GACRC,QAAQC,IAAI,SAAUF,QAMnBG,GAAmB,WAC5B,MAAM,CACJvM,KAAM,uBAGCwM,GAAsB,SAACC,GAChC,MAAM,CACJzM,KAAM,wBACNyM,WAGOP,GAAc,WACvB,OAAO,SAAC3L,EAAUC,GAChB,IAAIC,EAAQD,IAEZ,GAAIC,EAAMgI,UAAUsD,wBAAwB,CAC1C,IACIW,EAAY,4DADNjM,EAAMgI,UAAUsD,wBAC0D,eACpFxL,EAASgM,MACTpL,IAAMC,IAAIsL,GAAWpL,KAAK,SAASC,GACjC,IAAIkL,EAASlL,EAAIE,KAAK,GACtBlB,EAASiM,GAAoBC,SAQ1BE,GAAuB,WAChC,MAAM,CACJ3M,KAAM,2BAIC4M,GAA4B,WACrC,MAAM,CACJ5M,KAAM,iCAGC6M,GAA+B,SAACC,GACzC,MAAM,CACJ9M,KAAM,kCACN8M,oBAGOC,GAAuB,WAChC,OAAO,SAACxM,EAAUC,GAChB,IAAIC,EAAQD,IAEZ,GAAIC,EAAMsK,iBAAiB,CACzB,IAEI7J,EAAQ,CACV,YACA,IACE,uGACC,kEACA,iFACA,0EACA,qEACA,gDACH,IACE,WACA,SAboBT,EAAMsK,iBAAiBiC,OAaZ,gCAC/B,yGACA,uFACA,4GACA,mGACA,yFACA,yEACA,KACAnM,KAAK,IAETN,EAASqM,MACTzL,IAAMC,IAAItB,EAAgB,CAACuB,OAAQ,CAAC,MAAUH,EAAO,OAAU,UAAUI,KAAK,SAASC,GACrF,IAAIG,EAAUH,EAAIE,KACdC,EAAQ4J,QACVnK,IAAMC,IAAIM,EAAQ4J,OAAOC,QAAQ,UAAW,aAAajK,KAAK,SAASkK,GACrE,IAAIsB,EAAkB,CACpBrB,cAAe/J,EAAQ,OACvBgK,eAAgBhK,EAAQiK,kBACxBjD,iBAAkBhH,EAAQkK,wBAC1BC,iBAAkBnK,EAAQoK,wBAC1BC,wBAAyBrK,EAAQsK,YAAYT,QAAQ,UAAW,YAChEU,eAAgBT,EAAK/J,MAEvBlB,EAASsM,GAA6BC,WAQvCG,GAAkC,WAC3C,MAAM,CACJjN,KAAM,wCAGCkN,GAAqC,SAACT,GAC/C,MAAM,CACJzM,KAAM,kCACNyM,WAGOU,GAA6B,WACtC,OAAO,SAAC5M,EAAUC,GAChB,IAAIC,EAAQD,IAEZ,GAAIC,EAAMqM,gBAAgBf,wBAAwB,CAChD,IACIW,EAAY,4DADNjM,EAAMqM,gBAAgBf,wBACoD,eACpFxL,EAASqM,MACTzL,IAAMC,IAAIsL,GAAWpL,KAAK,SAASC,GACjC,IAAIkL,EAASlL,EAAIE,KAAK,GACtBlB,EAAS2M,GAAmCT,SAUzCW,GAAwB,SAACnG,GAClC,MAAM,CACJjH,KAAM,2BACNiH,YAGOoG,GAAgB,WACzB,MAAM,CACJrN,KAAM,oBAICsN,GAAqB,WAC9B,MAAM,CACJtN,KAAM,0BAGCuN,GAAwB,SAACC,GAClC,MAAM,CACJxN,KAAM,2BACNwN,SAGOC,GAAgB,WAAkB,IAAjBT,EAAgB,wDAC1C,OAAO,SAACzM,EAAUC,GAChB,IAAIC,EAAQD,IACRU,EAAQ,GACZ,GAAIT,EAAMsK,iBAAiB,CACzB,IAAIK,EAAc3K,EAAMsK,iBAAiBxB,GAErC8B,EAAS5K,EAAMsK,iBAAiB/K,MAErB,IAAXgN,EACF9L,EAAQ,CACN,qGACA,WACA,SAAWT,EAAMsK,iBAAiBiC,OAAS,4BAC3C,yFACA,+FACA,kGACA,yFACA,oEACA,KACAnM,KAAK,IAEW,eAAXwK,EACPnK,EAAQ,CACJ,qGACA,WACA,IAAMkK,EAAc,2EACpB,yFACA,+FACA,kGACA,yFACA,oEACA,KACAvK,KAAK,IAES,kBAAXwK,IACPnK,EAAQ,CACJ,qGACA,WACA,IAAMkK,EAAc,+EACpB,+FACA,uFACA,kGACA,yFACA,oEACA,KACAvK,KAAK,KAEXwL,QAAQC,IAAIpL,GACZX,EAAS+M,MACTnM,IAAMC,IAAItB,EAAgB,CAACuB,OAAQ,CAAC,MAAUH,EAAO,OAAU,UAAUI,KAAK,SAASC,GACrF,IAAIG,EAAUH,EAAIE,KAAKC,QAAQC,SAAS,GACxC0K,QAAQC,IAAI,oBAAqB5K,GACjCP,IAAMC,IAAIM,EAAQgM,QAAQ3L,MAAMwJ,QAAQ,UAAW,aAAajK,KAAK,SAASkK,GAC5E,IAAIgC,EAAO,CACT/B,cAAe/J,EAAQiM,gBAAgB5L,MACvC2G,iBAAkBhH,EAAQkM,mBAAmB7L,MAC7C8J,iBAAkBnK,EAAQmM,mBAAmB9L,MAC7CgK,wBAAyBrK,EAAQqK,wBAA0BrK,EAAQqK,wBAAwBhK,MAAMwJ,QAAQ,UAAW,YAAc,GAClIiC,KAAMhC,EAAK/J,MAEblB,EAASgN,GAAsBC,IAC/BjN,EAAS2L,c,kBCt9DnB,IAAI4B,EAAQ,CACV,SAAY,CACV,GAAM,CAAC,QAAQ,UAGf,IAAO,CAAC,qCAGR,QAAW,SAASC,GAClB,IAAIC,EAAU,IAAIC,MAQlB,OAPAD,EAAQE,IAAMC,KAAKC,GAAGL,EAAIM,aAAa,QACnCN,EAAIO,aAAa,WACnBN,EAAQO,MAAQR,EAAIM,aAAa,SAAS9C,QAAQ,WAAY,KAE5DwC,EAAIO,aAAa,YACnBN,EAAQQ,OAAST,EAAIM,aAAa,UAAU9C,QAAQ,WAAY,KAE3DyC,GAET,KAAQ,SAASD,GACf,GAAIA,EAAIO,aAAa,SAAuC,SAA5BP,EAAIM,aAAa,QAAoB,CAEnE,IADA,IAAII,EAAKC,SAASC,cAAc,MAChC,MAAkBC,MAAMC,KAAKd,EAAIe,UAAjC,eAA4C,CAAvC,IAAInK,EAAK,KACZ,GAAIA,EAAMoK,UAAYC,KAAKC,aAAc,CACvC,GAAuB,aAAnBtK,EAAMuK,UAA0B,CAClC,IAAIC,EAAKT,SAASC,cAAc,MAChCQ,EAAGC,UAAYzK,EAAMyK,UACrBX,EAAGY,YAAYF,GAEjB,GAAuB,YAAnBxK,EAAMuK,UAAyB,CACjC,IAAII,EAAKZ,SAASC,cAAc,MAChCW,EAAGF,UAAYzK,EAAMyK,UACrBX,EAAGY,YAAYC,KAIrB,OAAOb,EAEP,OAAO,MAGX,MAAS,SAASV,GAChB,IAAIwB,EAAQb,SAASC,cAAc,SAEnC,GADAY,EAAMH,UAAYrB,EAAIqB,UACmB,YAArCG,EAAMC,kBAAkBN,UAAyB,CACnD,IAAIO,EAAOF,EAAMC,kBACjBC,EAAKC,SACL,IAAIC,EAAUjB,SAASC,cAAc,WACrCgB,EAAQP,UAAYK,EAAKL,UACzBG,EAAMF,YAAYM,GAEpB,cAAgBf,MAAMC,KAAKU,EAAMK,iBAAiB,YAAlD,eAA+D,CAA1D,IAAIC,EAAG,KACNC,EAAKpB,SAASC,cAAc,MAChCmB,EAAGV,UAAYS,EAAIT,UACnB,cAAiBR,MAAMC,KAAKgB,EAAIE,YAAhC,eAA6C,CAAxC,IAAIC,EAAI,KACXF,EAAGG,aAAaD,EAAKE,KAAMF,EAAKjO,OAElC8N,EAAIM,cAAcC,aAAaN,EAAID,GAErC,cAAiBjB,MAAMC,KAAKU,EAAMK,iBAAiB,aAAnD,eAAiE,CAA5D,IAAIS,EAAI,KACPC,EAAK5B,SAASC,cAAc,MAC5B0B,EAAK/B,aAAa,SACpBgC,EAAGL,aAAa,UAAWI,EAAKhC,aAAa,SAE/CiC,EAAGlB,UAAYiB,EAAKjB,UACpB,cAAiBR,MAAMC,KAAKwB,EAAKN,YAAjC,eAA8C,CAAzC,IAAIC,EAAI,KACXM,EAAGL,aAAaD,EAAKE,KAAMF,EAAKjO,OAElCsO,EAAKF,cAAcC,aAAaE,EAAID,GAEtC,OAAOd,GAET,MAAS,SAASxB,GAChB,IAAIwC,EAAM7B,SAASC,cAAc,OAEjC,OADA4B,EAAInB,UAAYjB,KAAKqC,UAAUzC,GAAK,GAC7BwC,KAIbE,EAAOC,QAAU5C,G,+ZC5EZ6C,EAAWC,EAAQ,IAAnBD,QACDE,EAAUD,EAAQ,IAEhBE,E,YACJ,WAAYC,GAAO,IAAD,8BAChB,4CAAMA,KACDC,oBAAsB,EAAKA,oBAAoBC,KAAzB,gBAC3B,EAAKC,yCAA2C,EAAKA,yCAAyCD,KAA9C,gBAChD,EAAKE,eAAiB,EAAKA,eAAeF,KAApB,gBACtB,EAAKG,YAAc,EAAKA,YAAYH,KAAjB,gBACnB,EAAKI,mBAAqB,EAAKA,mBAAmBJ,KAAxB,gBANV,E,iFAQEK,GAAG,IAAD,EACKnD,KAAK4C,MAAzBxQ,EADe,EACfA,SACDkH,GAFgB,EACL9G,OACEwN,KAAKoD,KAAK9J,WAAW1F,OAClC7B,E,qVAAgB,IACfiO,KAAK4C,MAAMpQ,OAAOT,iBADH,CAElBuH,eAEFlH,EAASsQ,EAAQ5Q,oBAAoBC,M,+DAEEoR,GACzCA,EAAEE,iBADyC,MAElBrD,KAAK4C,MAAzBxQ,EAFsC,EAEtCA,SAECuD,GAJqC,EAE5BnD,OAEYwN,KAAKoD,KAAKzN,mBAAmB/B,OAClD2D,EAA0ByI,KAAKoD,KAAK7L,wBAAwB3D,MAC5DuC,EAAgB6J,KAAKoD,KAAKjN,cAAcvC,MACxCsC,EAAoB8J,KAAKoD,KAAKlN,kBAAkBtC,MAChDmD,EAAeiJ,KAAKoD,KAAKrM,aAAanD,MACtCkD,EAAiBkJ,KAAKoD,KAAKtM,eAAelD,MAAQoM,KAAKoD,KAAKtM,eAAelD,MAAM0P,MAAM,KAAK,GAAKtD,KAAKoD,KAAKtM,eAAelD,MAC1HyF,EAAkB2G,KAAKoD,KAAKtM,eAAelD,MAAQoM,KAAKoD,KAAKtM,eAAelD,MAAM0P,MAAM,KAAK,GAAK,EAClGxQ,EAAmBkN,KAAKoD,KAAKtQ,iBAAiBc,MAC9ChB,EAAuBoN,KAAKoD,KAAKxQ,qBAAqBgB,MAYtD7B,EAAmB,CAErBgF,eACAD,iBACAuC,kBACAvG,mBACA+C,gBAjBoBmK,KAAKoD,KAAKvN,gBAAgBjC,MAkB9C2D,0BACApB,gBACAD,oBACAP,qBACApB,oBArBwByL,KAAKoD,KAAK7O,oBAAoBX,MAsBtDhB,uBACAkF,eAtBmBkI,KAAKoD,KAAKtL,eAAelE,MAuB5CnB,UAtBcuN,KAAKoD,KAAK3Q,UAAUmB,MAuBlCa,yBAtB6BuL,KAAKoD,KAAK3O,yBAAyBb,MAuBhEc,0BAtB8BsL,KAAKoD,KAAK1O,0BAA0Bd,MAuBlEsB,0BAtB8B8K,KAAKoD,KAAKlO,0BAA0BtB,MAuBlEuB,2BAtB+B6K,KAAKoD,KAAKjO,2BAA2BvB,MAuBpEkG,qBAtByBkG,KAAKoD,KAAKtJ,qBAAqBlG,OA0B1DxB,EAASsQ,EAAQ5Q,oBAAoBC,IAErCK,EAASsQ,EAAQzM,2BACjB7D,EAASsQ,EAAQ9L,wBACjBxE,EAASsQ,EAAQvQ,wBACjBC,EAASsQ,EAAQjN,2BACjBrD,EAASsQ,EAAQrO,yBACjBjC,EAASsQ,EAAQ1N,4B,qCAiBJmO,GACfA,EAAEE,iBADe,MAEUrD,KAAK4C,MAAzBxQ,EAFU,EAEVA,SAFU,EAEAI,OAmCOJ,EAASsQ,EAAQhH,2BACzCtJ,EAASsQ,EAAQpH,yBACflJ,EAASsQ,EAAQpG,gCACnBlK,EAASsQ,EAAQ7F,kBACfzK,EAASsQ,EAAQlE,wBACGpM,EAASsQ,EAAQzG,4BACvC7J,EAASsQ,EAAQ3H,mBACjB3I,EAASsQ,EAAQxJ,gB,yCAEEiK,GACjBA,EAAEE,iBADiB,MAEMrD,KAAK4C,MAAzBxQ,EAFc,EAEdA,SAFc,EAEJI,OACfJ,EAASsQ,EAAQ9Q,yBACjBQ,EAASsQ,EAAQ7G,4BACjBzJ,EAASsQ,EAAQ/H,mBACjBvI,EAASsQ,EAAQzM,2BACjB7D,EAASsQ,EAAQ9L,wBAEjBxE,EAASsQ,EAAQrO,yBACjBjC,EAASsQ,EAAQ1N,0BACjB5C,EAASsQ,EAAQvQ,wBAEjBC,EAASsQ,EAAQjN,2BACjBrD,EAASsQ,EAAQtK,mBACjBhG,EAASsQ,EAAQjK,oBAEjBrG,EAASsQ,EAAQpG,gCACjBlK,EAASsQ,EAAQ7F,kBACjBzK,EAASsQ,EAAQlE,wBACjBwB,KAAKoD,KAAK3O,yBAAyBb,MAAQ,GAC3CoM,KAAKoD,KAAK1O,0BAA0Bd,MAAQ,GAC5CoM,KAAKoD,KAAKlO,0BAA0BtB,MAAQ,GAC5CoM,KAAKoD,KAAKjO,2BAA2BvB,MAAQ,GAC7CoM,KAAKoD,KAAK9J,WAAW1F,MAAQ,K,kCAKnBuP,GACZA,EAAEE,kBAEFjR,EADiB4N,KAAK4C,MAAjBxQ,UACIsQ,EAAQ7J,mBAAmBmH,KAAK4C,MAAMW,MAAMC,Y,+BAGnD,IAAIC,EAAQzD,KAyIZ,SAAS0D,IAEP,OADiBD,EAAMb,MAAMpQ,OAAO2F,WAClB1E,IAAI,SAAChB,GACrB,OACE,4BAAQmB,MAAOnB,EAAU4F,kBAAmB5F,EAAUsB,kBAuB5D,OACE,6BACE,kBAAC,IAAD,CAAM4P,SAAU3D,KAAK+C,0CACnB,6BAEE,6BAII,kBAAC,IAAD,CAAQ3H,GAAG,WAAWwI,QAAS5D,KAAKgD,gBAApC,cAGF,kBAAC,IAAD,CAAQ5H,GAAG,cAAcwI,QAAS5D,KAAKkD,oBAAvC,kBAQF,6BACA,gDACA,kBAAC,IAAKW,MAAN,KACE,kBAAC,IAAKC,MAAN,gCACA,kBAAC,IAAKC,QAAN,CAAcC,GAAG,SAASjK,IAAI,uBAAuBkK,SAAUjE,KAAK+C,0CAClE,4BAAQnP,MAAM,yBAAd,cACA,4BAAQA,MAAM,uBAAd,cACA,4BAAQA,MAAM,0BAAd,uCACA,4BAAQA,MAAM,IAAd,OACA,4BAAQA,MAAM,UAAd,kCAGJ,kBAAC,IAAKiQ,MAAN,KACE,kBAAC,IAAKC,MAAN,KACE,kBAAC,IAAKC,QAAN,CAAcC,GAAG,QAAQnS,KAAK,OAAOkI,IAAI,aAAamK,YAAY,wBAAwBD,SAAUjE,KAAK6C,wBAG7G,6BACA,mDACA,kBAAC,IAAKgB,MAAN,KACA,kBAAC,IAAKC,MAAN,8BACE,kBAAC,IAAKC,QAAN,CAAcC,GAAG,SAASjK,IAAI,sBAAsBkK,SAAUjE,KAAK+C,0CACjE,4BAAQnP,MAAM,IAAd,OA3DU6P,EAAMb,MAAMpQ,OAAOgG,YACpB/E,IAAI,SAACiF,GACtB,OACE,4BAAQ9E,MAAO8E,EAAWC,mBAAoBD,EAAWE,qBA6DvD,kBAAC,IAAKiL,MAAN,KACE,kBAAC,IAAKC,MAAN,oCACA,6BAFF,SAGQ,kBAAC,IAAKC,QAAN,CAAcC,GAAG,QAAQjK,IAAI,2BAA2BoK,OAAQnE,KAAK+C,yCAA0CmB,YAAY,cACjI,6BAJF,UAKS,kBAAC,IAAKH,QAAN,CAAcC,GAAG,QAAQjK,IAAI,4BAA4BoK,OAAQnE,KAAK+C,yCAA0CmB,YAAY,eAErI,kBAAC,IAAKL,MAAN,KACE,kBAAC,IAAKC,MAAN,yBACA,kBAAC,IAAKC,QAAN,CAAcC,GAAG,SAASjK,IAAI,kBAAkBkK,SAAUjE,KAAK+C,yCAA0CnP,MAAO6P,EAAMb,MAAMpQ,OAAOT,iBAAiB8D,iBAClJ,4BAAQjC,MAAM,IAAd,OAvHI6P,EAAMb,MAAMpQ,OAAO4R,iBAClB3Q,IAAI,SAACO,GAClB,OACE,4BAAQJ,MAAOI,EAAOa,eAAgBb,EAAOC,iBAwH3C,kBAAC,IAAK4P,MAAN,KACE,kBAAC,IAAKC,MAAN,6BACE,kBAAC,IAAKC,QAAN,CAAcC,GAAG,SAASjK,IAAI,qBAAqBkK,SAAUjE,KAAK+C,0CAChE,4BAAQnP,MAAM,IAAd,OACC8P,MAIP,kBAAC,IAAKG,MAAN,KACE,kBAAC,IAAKC,MAAN,4BACE,kBAAC,IAAKC,QAAN,CAAcC,GAAG,SAASjK,IAAI,0BAA0BkK,SAAUjE,KAAK+C,0CACrE,4BAAQnP,MAAM,IAAd,OA3GmB6P,EAAMb,MAAMpQ,OAAO6E,yBAClB5D,IAAI,SAAC5B,GACnC,OACE,4BAAQ+B,MAAO/B,EAAK2F,gCAAiC3F,EAAK4F,kCA4GxD,kBAAC,IAAKoM,MAAN,KACE,kBAAC,IAAKC,MAAN,6BACE,kBAAC,IAAKC,QAAN,CAAcC,GAAG,SAASjK,IAAI,gBAAgBkK,SAAUjE,KAAK+C,yCAA0CnP,MAAO6P,EAAMb,MAAMpQ,OAAOT,iBAAiBoE,eAChJ,4BAAQvC,MAAM,IAAd,OAxOa6P,EAAMb,MAAMpQ,OAAOgD,mBAClB/B,IAAI,SAAC4Q,GAC7B,IAAIjJ,EAAKiJ,EAAKxQ,kBAAoBwQ,EAAKxQ,kBAAoBwQ,EAAK1Q,WAAW2P,MAAM,8BAA8B,GAC/G,OACE,4BAAQ1P,MAAOwH,GAAKiJ,EAAKvQ,qBAwOvB,kBAAC,IAAK+P,MAAN,KACE,kBAAC,IAAKC,MAAN,4BACE,kBAAC,IAAKC,QAAN,CAAcC,GAAG,SAASjK,IAAI,oBAAoBkK,SAAUjE,KAAK+C,yCAA0CnP,MAAO6P,EAAMb,MAAMpQ,OAAOT,iBAAiBmE,mBACpJ,4BAAQtC,MAAM,IAAd,OA1Nd,WACE,IAAI0Q,EAAqBb,EAAMb,MAAMpQ,OAAO8R,mBAC5C,GAAIA,EAAmB,CACrB,IAAIC,EAAOD,EAAmB,GAC9B,GAAIC,EAAK,CACP,IAAIC,EAAgBD,EAAKnO,YAAYkN,MAAM,8BAA8B,GACzE,QAAqB3G,GAAjB6H,EACF,OACE,4BAAQ5Q,MAAO4Q,GAAf,OAAmCD,EAAKlO,qBAmNnCoO,GAvOf,WACE,IAAIH,EAAqBb,EAAMb,MAAMpQ,OAAO8R,mBAC5C,GAAIA,EAAmB,CACrB,IAAIC,EAAOD,EAAmB,GAC9B,GAAIC,EAAK,CACP,IAAIG,EAAWH,EAAKjO,OAAOgN,MAAM,8BAA8B,GAC/D,OACE,4BAAQ1P,MAAO8Q,GAAf,YAAmCH,EAAKhO,gBAiOjCoO,GA9Mf,WACE,IAAIL,EAAqBb,EAAMb,MAAMpQ,OAAO8R,mBAC5C,GAAIA,EACF,OAAOA,EAAmB7Q,IAAI,SAAC8Q,GAC7B,IAAInJ,EAAKmJ,EAAKK,aAAeL,EAAKK,aAAeL,EAAK/N,MAAM8M,MAAM,8BAA8B,GAChG,GAAIiB,EAAK/N,MACP,OACE,4BAAQ5C,MAAOwH,GAAKmJ,EAAK9N,eAwMpBoO,KAGP,6BACA,8CACA,kBAAC,IAAKhB,MAAN,KACE,kBAAC,IAAKC,MAAN,yBACA,kBAAC,IAAKC,QAAN,CAAcC,GAAG,SAASjK,IAAI,uBAAuBkK,SAAUjE,KAAK+C,0CAClE,4BAAQnP,MAAM,IAAd,OAzGU6P,EAAMb,MAAMpQ,OAAOgG,YACpB/E,IAAI,SAACiF,GACtB,OACE,4BAAQ9E,MAAO8E,EAAWC,mBAAoBD,EAAWE,qBA0GvD,kBAAC,IAAKiL,MAAN,KACE,kBAAC,IAAKC,MAAN,+BACA,6BAFF,SAGQ,kBAAC,IAAKC,QAAN,CAAcC,GAAG,QAAQjK,IAAI,4BAA4BoK,OAAQnE,KAAK+C,yCAA0CmB,YAAY,cAClI,6BAJF,UAKS,kBAAC,IAAKH,QAAN,CAAcC,GAAG,QAAQjK,IAAI,6BAA6BoK,OAAQnE,KAAK+C,yCAA0CmB,YAAY,eAEtI,kBAAC,IAAKL,MAAN,KACE,kBAAC,IAAKC,MAAN,oBACE,kBAAC,IAAKC,QAAN,CAAcC,GAAG,SAASjK,IAAI,mBAAmBkK,SAAUjE,KAAK+C,yCAA0CnP,MAAO6P,EAAMb,MAAMpQ,OAAOT,iBAAiBe,kBACnJ,4BAAQc,MAAM,IAAd,OApKE6P,EAAMb,MAAMpQ,OAAOsS,kBAClBrR,IAAI,SAACO,GAClB,OACE,4BAAQJ,MAAOI,EAAOa,eAAgBb,EAAOC,iBAqK3C,kBAAC,IAAK4P,MAAN,KACE,kBAAC,IAAKC,MAAN,wBACE,kBAAC,IAAKC,QAAN,CAAcC,GAAG,SAASjK,IAAI,YAAYkK,SAAUjE,KAAK+C,0CACvD,4BAAQnP,MAAM,IAAd,OACC8P,MAGP,kBAAC,IAAKG,MAAN,KACE,kBAAC,IAAKC,MAAN,kBACE,kBAAC,IAAKC,QAAN,CAAcC,GAAG,SAASjK,IAAI,iBAAiBkK,SAAUjE,KAAK+C,0CAC5D,4BAAQnP,MAAM,IAAd,OAzKU6P,EAAMb,MAAMpQ,OAAOoF,gBAClBnE,IAAI,SAAC5B,GAC1B,OACE,4BAAQ+B,MAAO/B,EAAKkG,uBAAwBlG,EAAKmG,yBA0K/C,kBAAC,IAAK6L,MAAN,KACE,kBAAC,IAAKC,MAAN,mBACE,kBAAC,IAAKC,QAAN,CAAcC,GAAG,SAASjK,IAAI,eAAekK,SAAUjE,KAAK+C,yCAA0CnP,MAAO6P,EAAMb,MAAMpQ,OAAOT,iBAAiBgF,cAC/I,4BAAQnD,MAAM,IAAd,OAtSM6P,EAAMb,MAAMpQ,OAAOa,YAClBI,IAAI,SAAC4Q,GACtB,OACE,4BAAQzQ,MAAOyQ,EAAKxQ,mBAAoBwQ,EAAKvQ,qBAuS3C,kBAAC,IAAK+P,MAAN,KACE,kBAAC,IAAKC,MAAN,kBACA,kBAAC,IAAKC,QAAN,CAAcC,GAAG,SAASjK,IAAI,iBAAiBkK,SAAUjE,KAAK+C,yCAA0CnP,MAAO6P,EAAMb,MAAMpQ,OAAOT,iBAAiB+E,eAAiB,IAAM2M,EAAMb,MAAMpQ,OAAOT,iBAAiBsH,iBAC5M,4BAAQzF,MAAM,IAAd,OAvOZ,WACE,IAAImR,EAAkBtB,EAAMb,MAAMpQ,OAAOuS,gBACzC,GAAIA,EAAgB,CAClB,IAAIR,EAAOQ,EAAgB,GAC3B,GAAIR,EAAK,CACP,IAAIC,EAAgBD,EAAKnO,YAAYkN,MAAM,8BAA8B,GACzE,QAAqB3G,GAAjB6H,EACF,OACE,4BAAQ5Q,MAAO4Q,EAAgB,IAAMD,EAAKvN,mBAA1C,OAAkEuN,EAAKlO,qBAgOpE2O,GApPb,WACE,IAAID,EAAkBtB,EAAMb,MAAMpQ,OAAOuS,gBACzC,GAAIA,EAAgB,CAClB,IAAIR,EAAOQ,EAAgB,GAC3B,GAAIR,EAAK,CACP,IAAIG,EAAWH,EAAKjO,OAAOgN,MAAM,8BAA8B,GAC/D,OACE,4BAAQ1P,MAAO8Q,EAAU,IAAMH,EAAKtN,cAApC,YAA4DsN,EAAKhO,gBA8O5D0O,GA3Nb,WACE,IAAIF,EAAkBtB,EAAMb,MAAMpQ,OAAOuS,gBACzC,GAAIA,EACF,OAAOA,EAAgBtR,IAAI,SAAC8Q,GAC1B,IAAInJ,EAAKmJ,EAAKK,aAAeL,EAAKK,aAAeL,EAAK/N,MAAM8M,MAAM,8BAA8B,GAChG,GAAIiB,EAAK/N,MACP,OACE,4BAAQ5C,MAAOwH,EAAK,IAAMmJ,EAAKrN,aAAcqN,EAAK9N,eAqN/CyO,QAMT,2BAAG,uBAAGC,KAAK,IAAIvB,QAAS5D,KAAKiD,aAA1B,2B,GAleUmC,IAAMC,WA0eZ7C,IACb,SAAClQ,GACD,OAAOA,GAFMkQ,CAIbG,G,iBClfGH,EAAWC,EAAQ,IAAnBD,QACDE,EAAUD,EAAQ,IAIhB6C,E,YACL,WAAY1C,GAAO,IAAD,8BACjB,4CAAMA,KACD2C,cAAgB,EAAKA,cAAczC,KAAnB,gBAFJ,E,6EAIF,IAAD,EACwC9C,KAAK4C,MAAtD4C,EADS,EACTA,aAAcpK,EADL,EACKA,GAAII,EADT,EACSA,UAAWpJ,EADpB,EACoBA,SAAUyM,EAD9B,EAC8BA,OAC5CzM,EAASsQ,EAAQrH,sBAAsB2E,KAAK4C,MAAMxH,KAClD,IAAIqK,EAA4B,CAC/BrK,KACAI,YACAqD,SACAhN,KAAM,cAcP,GATAO,EAASsQ,EAAQnH,uBAAuBkK,IACxCrT,EAASsQ,EAAQ1F,kBACjB5K,EAASsQ,EAAQ9D,wBAIjBxM,EAASsQ,EAAQhG,gCAGG,MAAhB8I,EAAqB,CAExB,IAAIE,EAA2B1F,KAAK4C,MAAM5G,oBAAoB2J,KAAK,SAACnK,GACnE,OAAOA,EAAUJ,KAAOoK,IAIzB,QAAgC7I,GAA5B+I,EAAsC,CACzCtT,EAASsQ,EAAQjH,yBAAyBiK,IAE1CtT,EAASsQ,EAAQ/G,+BAA+B6J,IAEhD,IAAII,EAASrF,SAASsF,eAAeL,GAAcM,UACnDC,IAAE,2BAA2BC,QAAQ,CAAEC,UAAWL,EAAO,IAAM,KAE/D,IAAIM,EAAa3F,SAASsF,eAAezK,GAAI0K,UAC7CC,IAAE,mBAAmBC,QAAQ,CAAEC,UAAWC,EAAW,IAAM,UAG3DC,MAAM,6JACN/T,EAASsQ,EAAQ9G,iCACjBxJ,EAASsQ,EAAQhH,gCAKlBtJ,EAASsQ,EAAQ9G,iCACjBxJ,EAASsQ,EAAQhH,6B,+BAOV,IAAD,EAE0EsE,KAAK4C,MAAjF4C,EAFE,EAEFA,aAAchK,EAFZ,EAEYA,UAAW4K,EAFvB,EAEuBA,UAAWC,EAFlC,EAEkCA,MAAOrS,EAFzC,EAEyCA,OAAQoH,EAFjD,EAEiDA,GAAIkL,EAFrD,EAEqDA,QAASC,EAF9D,EAE8DA,SAEjEH,EAA6B,OAAjBZ,EAAwBY,EAAY,iBAAmBA,EAEvE,OACC,yBAAKA,UAAU,qBACd,uBAAGhL,GAAIA,EAAIgL,UAAWA,EAAWxC,QAAS5D,KAAKuF,eAC9C/J,GAED,uBAAG2J,KAAM/J,EAAIoL,OAAO,SAASJ,UAAU,sBAAsBpS,EAA7D,KAAuEqS,GACvE,uBAAGlB,KAAM/J,EAAIoL,OAAO,SAASJ,UAAU,sBAAvC,iBAA2EE,GAC3E,uBAAGnB,KAAM/J,EAAIoL,OAAO,SAASJ,UAAU,sBAAvC,oBAA8EG,Q,GAzE1DnB,IAAMC,WAiFf7C,IACd,SAAClQ,GACA,OAAOA,GAFMkQ,CAIb8C,GCvFImB,E,iLACI,IAAD,EACgCzG,KAAK4C,MAArClI,EADA,EACAA,WAAYkC,EADZ,EACYA,iBAmCnB,OACC,6BACC,4DAC2B,aAA1BoD,KAAK4C,MAAMlI,YAA6B,oCAAUA,EAAWgM,QApC5C,aAAfhM,EACI,0CAEuB,IAAtBA,EAAWgM,OAEX,uBAAGN,UAAU,sBAAb,iBAID1L,EAAWjH,IAAK,SAAC+H,GAEvB,IAAImL,EAAiB,GAGnBA,EAFE/J,EAAiBxB,IAChBwB,EAAiBxB,GAAGwL,SAASpL,EAAUJ,IACzB,oBAOD,YAEJI,EAAUqL,QAAxB,IACIC,EAAUH,EAAiB,IAAMnL,EAAUqL,QAC3C,OAEE,kBAAC,EAAD,eAAWT,UAAWU,EAASC,IAAKvL,EAAUJ,IAAQI,W,GA/BrC4J,IAAMC,WA+CnB7C,oBACd,SAAClQ,GACA,OAAOA,GAFMkQ,CAIbiE,GCvDGjE,EAAWC,EAAQ,IAAnBD,QAECwE,E,iLACI,IACDpK,EAAoBoD,KAAK4C,MAAzBhG,iBACFpB,EAAaoB,EAAbpB,UACAJ,EAAMwB,EAANxB,GAEL,OACC,yBAAKgL,UAAU,aACd,iDAAuB5K,GACvB,2BAAG,uBAAG2J,KAAM/J,GAAKA,S,GATUgK,IAAMC,WCFhC7C,GDiBUA,EACd,SAAClQ,GACA,OAAOA,GAFMkQ,CAIbwE,GCrBcvE,EAAQ,IAAnBD,SAECyE,E,iLACI,IACD9L,EAAsB6E,KAAK4C,MAA3BzH,mBACH+L,EAAmB/L,EAAqBA,EAAmBK,UAAY,qCACvE2L,EAAqBhM,EAAqBA,EAAmBC,GAAK,GAClEmL,EAAWpL,EAAqBA,EAAmBoL,SAAW,GAIlE,OACC,yBAAKH,UAAU,aACd,mDAAyBc,GACzB,2BAAIX,GACJ,2BAAG,uBAAGpB,KAAMgC,GAAqBA,S,GAbJ/B,IAAMC,WCDlC7C,GDoBUA,EACd,SAAClQ,GACA,OAAOA,GAFMkQ,CAIbyE,GCxBcxE,EAAQ,IAAnBD,SACDE,EAAUD,EAAQ,IAIhB2E,E,YACL,WAAYxE,GAAO,IAAD,8BACjB,4CAAMA,KACD2C,cAAgB,EAAKA,cAAczC,KAAnB,gBAFJ,E,6EAIF,IAAD,EAC4B9C,KAAK4C,MAA1CxH,EADS,EACTA,GAAII,EADK,EACLA,UAAW+K,EADN,EACMA,SAAUnU,EADhB,EACgBA,SAC9BA,EAASsQ,EAAQ/G,+BAA+BqE,KAAK4C,MAAMxH,KAC3D,IAAIiM,EAAkB,CACrBjM,KACAI,YACA+K,YAEDnU,EAASsQ,EAAQjH,yBAAyB4L,IAI1CjV,EAASsQ,EAAQ3H,mBACjB3I,EAASsQ,EAAQ7H,wBACjBzI,EAASsQ,EAAQpH,yBACjBlJ,EAASsQ,EAAQpG,gCACjBlK,EAASsQ,EAAQ7F,kBAEjB,IAAIqJ,EAAa3F,SAASsF,eAAezK,GAAI0K,UAC7CC,IAAE,2BAA2BC,QAAQ,CAAEC,UAAWC,EAAW,IAAM,O,+BAE3D,IAAD,EACsClG,KAAK4C,MAA3CxH,EADA,EACAA,GAAII,EADJ,EACIA,UAAW4K,EADf,EACeA,UAAWG,EAD1B,EAC0BA,SAC/B,OACD,yBAAKH,UAAU,qBACd,uBAAGhL,GAAIA,EAAIgL,UAAWA,EAAWxC,QAAS5D,KAAKuF,eAAgB/J,GAC/D,uBAAG2J,KAAM/J,EAAIoL,OAAO,SAASJ,UAAU,sBAAsBG,Q,GA/BxBnB,IAAMC,WAqChC7C,MAAU4E,GCxCrB1E,EAAUD,EAAQ,IAEhB6E,E,YACL,WAAY1E,GAAO,IAAD,8BACjB,4CAAMA,KACDG,yCAA2C,EAAKA,yCAAyCD,KAA9C,gBAF/B,E,sGAIuBK,GACxCA,EAAEE,iBADwC,IAErCjR,EAAY4N,KAAK4C,MAAjBxQ,SACDkH,EAAa0G,KAAKoD,KAAK9J,WAAW1F,MAEtCxB,EAASsQ,EAAQhH,2BACjBtJ,EAASsQ,EAAQpH,yBACjBlJ,EAASsQ,EAAQ7F,kBAIjBzK,EAASsQ,EAAQzG,yBAAyB3C,IAC1ClH,EAASsQ,EAAQ3H,gBAAgBzB,M,+BAGzB,IACD0C,EAAuBgE,KAAK4C,MAA5B5G,oBAiBP,OACC,6BACC,2DACA,oCAAUA,EAAoB0K,QAlBO,IAA/B1K,EAAoB0K,OAElB,uBAAGN,UAAU,sBAAb,iBAICpK,EAAoBvI,IAAK,SAAC+H,GACnC,IAAImL,EAAiBnL,EAAU+L,QAAU,oBAAsB,YAE3D,OACH,kBAAC,EAAD,eAA4BnB,UAAWO,EAAgBI,IAAKvL,EAAUJ,IAAQI,W,GAjC9C4J,IAAMC,W,GAgD5B7C,kBACd,SAAClQ,GACA,OAAOA,GAFMkQ,CAIb8E,G,yCClDG9E,EAAWC,EAAQ,IAAnBD,QACDE,EAAUD,EAAQ,IAIhB+E,E,YACL,WAAY5E,GAAO,IAAD,8BACjB,4CAAMA,KACD2C,cAAgB,EAAKA,cAAczC,KAAnB,gBACrB,EAAK2E,sBAAwB,EAAKA,sBAAsB3E,KAA3B,gBAC7B,EAAK4E,yBAA2B,EAAKA,yBAAyB5E,KAA9B,gBAChC,EAAK6E,8BAAgC,EAAKA,8BAA8B7E,KAAnC,gBACrC,EAAKxQ,MAAQ,CACTsV,UAAW,MACdC,YAAY,EACZC,WAAW,EACXC,cAAc,GAVE,E,6FAcf/H,KAAKgI,SAAS,SAACC,GAGb,MAAM,CACJL,UAHwC,QAAxBK,EAAUL,UAAsB,MAAQ,MAIxDC,YAHiBI,EAAUJ,gB,8CAQjC3J,QAAQC,IAAI,QACZ6B,KAAKgI,SAAS,SAACC,GACd,MAAO,CACNH,WAAYG,EAAUH,e,iDAKxB9H,KAAKgI,SAAS,SAACC,GACd,MAAO,CACNF,cAAeE,EAAUF,kB,sCAKZ,IAAD,EACqC/H,KAAK4C,MAAnDsF,EADS,EACTA,kBAAmB9M,EADV,EACUA,GAAII,EADd,EACcA,UAAWpJ,EADzB,EACyBA,SAEnCqT,EAA4B,CAC/BrK,KACAI,YACA3J,KAAM,iBAEPO,EAASsQ,EAAQnH,uBAAuBkK,IAExCrT,EAASsQ,EAAQtG,mCAAmChB,IAEpDhJ,EAASsQ,EAAQ1F,kBAEjB,IAAI4I,EAASrF,SAASsF,eAAezK,GAAI0K,UAIzC,GAHAC,IAAE,gCAAgCC,QAAQ,CAAEC,UAAWL,EAAO,IAAM,KAG3C,MAArBsC,EAA0B,CAE7B,IAAIC,EAA0BnI,KAAK4C,MAAMlI,WAAWiL,KAAK,SAACnK,GACzD,OAAOA,EAAUJ,KAAO8M,IAIzB,QAA+BvL,GAA3BwL,EAAqC,CAGxC/V,EAASsQ,EAAQrH,sBAAsB6M,IAEnCtC,EAASrF,SAASsF,eAAeqC,GAAmBpC,UACxDC,IAAE,mBAAmBC,QAAQ,CAAEC,UAAWL,EAAO,IAAM,KAGvD,IAAIJ,EAAe2C,EAAwB3C,aAC3C,GAAoB,MAAhBA,EAAqB,CAExB,IAAIE,EAA2B1F,KAAK4C,MAAM5G,oBAAoB2J,KAAK,SAACnK,GACnE,OAAOA,EAAUJ,KAAOoK,IAIzB,QAAgC7I,GAA5B+I,EAAsC,CACzCtT,EAASsQ,EAAQjH,yBAAyBiK,IAE1CtT,EAASsQ,EAAQ/G,+BAA+B6J,IAE5CI,EAASrF,SAASsF,eAAeL,GAAcM,UACnDC,IAAE,2BAA2BC,QAAQ,CAAEC,UAAWL,EAAO,IAAM,UAI/DxT,EAASsQ,EAAQ9G,iCACjBxJ,EAASsQ,EAAQhH,iCAOnBtJ,EAASsQ,EAAQ7H,wBACjBzI,EAASsQ,EAAQhH,gCAKlBtJ,EAASsQ,EAAQ7H,wBACjBzI,EAASsQ,EAAQ9G,iCACjBxJ,EAASsQ,EAAQhH,6B,+BAWV,IAAD,EACkDsE,KAAK4C,MAAzDxH,EADE,EACFA,GAAII,EADF,EACEA,UAAW4K,EADb,EACaA,UAAWgC,EADxB,EACwBA,uBACzBC,EAAoB,CAAC,CAC1BC,cAAelN,EACfmN,mBAAoBnN,EAAGkI,MAAM,cAAc,GAC3CkF,cAAe,KAEd,OACD,6BACC,uBAAGpN,GAAIA,EAAIgL,UAAWA,EAAWxC,QAAS5D,KAAKuF,eAAgB/J,EAC9D,uBAAG2J,KAAM/J,EAAIgL,UAAU,sBAAsBhL,GAC7C,0BAAMwI,QAAS5D,KAAKyH,uBAAuB,kBAAC,IAAD,OAC3C,0BAAM7D,QAAS5D,KAAK0H,0BAA0B,kBAAC,IAAD,QAE/C,yBAAKtM,GAAG,uBAAuBgL,UAAWpG,KAAK1N,MAAMuV,WAAa,UAAY,aAE5E7H,KAAK1N,MAAMwV,WACZ,6BACE9H,KAAK1N,MAAMuV,WAAa,wBAAIzB,UAAU,YAAYC,MAAM,oBAAoBzC,QAAS5D,KAAK2H,gCAAmC,wBAAIvB,UAAU,YAAYC,MAAM,oBAAoBzC,QAAS5D,KAAK2H,gCAChM,kBAAC,IAAD,CACApK,eAAgB8K,EAChBI,qBAAsBrN,EACtBgF,MAAOJ,KAAK1N,MAAMsV,aAKlB5H,KAAK1N,MAAMyV,cAAgBK,GAE3B,kBAAC,IAAD,CAAUM,YAAaN,U,GApJgBhD,IAAMC,WA6JpC7C,IACd,SAAClQ,GACA,OAAOA,GAFMkQ,CAIbgF,GCvKImB,GAFQlG,EAAQ,I,iLAGZ,IACDhG,EAA2BuD,KAAK4C,MAAhCnG,wBAkBP,OACC,6BACC,+DACI,oCAAUA,EAAwBiK,QAnBG,IAAnCjK,EAAwBiK,OAEtB,uBAAGN,UAAU,sBAAb,iBAIC3J,EAAwBhJ,IAAK,SAAC+H,GACvC,IAAImL,EAAiBnL,EAAU+L,QAAU,oBAAsB,YAE3D,OAEE,kBAAC,EAAD,eAAgCnB,UAAWO,EAAgBI,IAAKvL,EAAUJ,IAAQI,W,GAfnD4J,IAAMC,YA8BhC7C,oBACd,SAAClQ,GACA,OAAOA,GAFMkQ,CAIbmG,G,QCpCGnG,GAAWC,EAAQ,IAAnBD,QACDE,GAAUD,EAAQ,IAQhBmG,G,YACJ,WAAYhG,GAAO,IAAD,8BAChB,4CAAMA,KACDiG,iBAAmB,EAAKA,iBAAiB/F,KAAtB,gBACxB,EAAK6E,8BAAgC,EAAKA,8BAA8B7E,KAAnC,gBACrC,EAAKgG,mBAAqB,EAAKA,mBAAmBhG,KAAxB,gBAC1B,EAAKiG,kBAAoB,EAAKA,kBAAkBjG,KAAvB,gBACzB,EAAKkG,aAAe,EAAKA,aAAalG,KAAlB,gBACpB,EAAKI,mBAAqB,EAAKA,mBAC/B,EAAK5Q,MAAQ,CACXsV,UAAW,MACXC,YAAY,GAVE,E,6FAchB7H,KAAKgI,SAAS,SAACC,GAGb,MAAM,CACJL,UAHwC,QAAxBK,EAAUL,UAAsB,MAAQ,MAIxDC,YAHiBI,EAAUJ,gB,uCAShB1E,GACfA,EAAEE,iBADe,IAEZjR,EAAY4N,KAAK4C,MAAjBxQ,SACLA,EAASsQ,GAAQrI,eACjBjI,EAASsQ,GAAQzI,oBAAoB+F,KAAK4C,MAAMxI,OAAOoJ,Y,yCAEtCL,GACjBA,EAAEE,iBADiB,IAEdjR,EAAY4N,KAAK4C,MAAjBxQ,SACmB,WAApB4N,KAAK4C,MAAM/Q,KACbO,EAASsQ,GAAQpD,eAAc,IAG/BlN,EAASsQ,GAAQpD,eAAc,IAEjClN,EAASsQ,GAAQzI,qBAAoB,IACrC7H,EAASsQ,GAAQzD,sBAAsBe,KAAK4C,MAAMqG,SAASzF,Y,wCAE3CL,GAEhBnD,KAAKgJ,iB,yCAEY7F,GAEjBnD,KAAKgJ,iB,qCAGL,IAAIvF,EAAQzD,KACNkJ,EAAW,IAAIC,UACjB7O,EAAY,GAOhB,IALEA,EADsB,WAApB0F,KAAK4C,MAAM/Q,KACDmO,KAAK4C,MAAMjE,gBAGXqB,KAAK4C,MAAMtI,WAEXwD,eACZoL,EAASE,UAAU9O,EAAUwD,eAAgB,SAASxK,GAEpD,GAAImQ,EAAMb,MAAMhG,iBAAiBxB,GAAG,CAClC,IAAMiO,EAAU5F,EAAMb,MAAMhG,iBAAiBxB,GAAGkI,MAAM,KAAKgG,MAEvDhW,EAAKiW,cAAc,IAAMF,IAC3B/V,EAAKiW,cAAc,IAAMF,GAASvH,aAAa,QAAS,eAG1D2B,EAAML,KAAK/D,KAAK4C,aAAa3O,EAAMmQ,EAAML,KAAK/D,KAAKmK,WAAW,WAKhE,CACF,IAAMC,EAAgBlJ,SAASmJ,eAAe,IAC9CjG,EAAML,KAAK/D,KAAK4C,aAAawH,EAAehG,EAAML,KAAK/D,KAAKmK,WAAW,O,wCAGzDG,GAAU,IAAD,EAEA3J,KAAK4C,MAAzBxQ,EAFoB,EAEpBA,SAMDL,GARqB,EAEVS,OAMQ,CACrB0D,kBALsByT,IAQxB3J,KAAKkD,qBAEL9Q,EAASsQ,GAAQ5Q,oBAAoBC,IAEvCK,EAASsQ,GAAQzM,2BAEjB7D,EAASsQ,GAAQ3H,mBAGf3I,EAASsQ,GAAQxJ,gB,yCAKAiK,GAAG,IAAD,EAEMnD,KAAK4C,MAAzBxQ,EAFc,EAEdA,SAFc,EAEJI,OACfJ,EAASsQ,GAAQ9Q,yBACjBQ,EAASsQ,GAAQ7G,4BACjBzJ,EAASsQ,GAAQ/H,mBACnBvI,EAASsQ,GAAQzM,2BACf7D,EAASsQ,GAAQ9L,wBAEjBxE,EAASsQ,GAAQrO,yBACjBjC,EAASsQ,GAAQ1N,0BACjB5C,EAASsQ,GAAQvQ,wBAEjBC,EAASsQ,GAAQjN,2BACjBrD,EAASsQ,GAAQtK,mBACjBhG,EAASsQ,GAAQjK,oBAEjBrG,EAASsQ,GAAQpG,kC,+BAYV,IAAD,OACFmH,EAAQzD,KACR1F,EAAY,GAFV,EAIJA,EADsB,WAApB0F,KAAK4C,MAAM/Q,KACDmO,KAAK4C,MAAMjE,gBAGXqB,KAAK4C,MAAMtI,UAGLC,GAVd,EAUD+C,cAVC,EAUc/C,kBAAkBmD,EAVhC,EAUgCA,iBAAkBH,EAVlD,EAUkDA,eAVlD,EAUkEO,eAVlE,EAUkFQ,OAqDxF,IAAI+J,EAAoB,GAkBxB,OAjBI9K,GAAkBA,EAAeqM,cAAgBnJ,MACnD4H,EAAoB9K,EAAe9J,IAAI,SAACoW,GACtC,MAAO,CACLvB,cAAeuB,EACftB,mBAAoBsB,EAAEvG,MAAM,cAAc,GAC1CkF,cAAc,MAIe,kBAAnBjL,IAEd8K,EAAoB,CAAC,CACnBC,cAAe/K,EACfgL,mBAAoBhL,EAAe+F,MAAM,cAAc,GACvDkF,cAAc,MAMhB,6BACE,gDACA,yBAAKpN,GAAG,OAAOrB,IAAI,QAAO,+BACzBQ,GACC,yBAAKa,GAAG,sBAAsBgL,UAAWpG,KAAK1N,MAAMuV,WAAa,UAAY,aAC5E7H,KAAK1N,MAAMuV,WAAa,wBAAIzB,UAAU,YAAYC,MAAM,oBAAoBzC,QAAS5D,KAAK2H,gCAAmC,wBAAIvB,UAAU,YAAYC,MAAM,oBAAoBzC,QAAS5D,KAAK2H,gCAChM,kBAAC,IAAD,CACCpK,eAAgB8K,EAChBI,qBAAsBlO,EACtB6F,MAAOJ,KAAK1N,MAAMsV,aAxDzB,WAEE,GAAItN,EAAUgD,cACZ,OACE,2BACE,uBAAGsG,QAASH,EAAMqF,oBAAlB,mBAwDHgB,GACAvP,GAAoB,2BAAG,uBAAG4K,KAAM,mDAAqD5K,EAAkBiM,OAAO,UAAvF,mBAIF,WAApBxG,KAAK4C,MAAM/Q,MAAqBmO,KAAK4C,MAAMhG,iBAAiBxB,IAAO,uBAAGgL,UAAU,OAAOxC,QAAS,WAAO,EAAKmF,kBAAkB,EAAKnG,MAAMjE,gBAAgBrB,cAAcgG,MAAM,cAAc,MAAxH,0CAKpE/I,GAAoB,kBAAC,IAAD,CAAUmO,YAAahL,S,GArP5B0H,IAAMC,WA2Pf7C,MACb,SAAClQ,GACC,OAAOA,GAFIkQ,CAIboG,IC5QGpG,GAAWC,EAAQ,IAAnBD,QAIDuH,GAAKtH,EAAQ,KAOXuH,IANQvH,EAAQ,I,YAOnB,WAAYG,GAAO,IAAD,8BACf,4CAAMA,KACDqH,eAAiB,EAAKA,eAAenH,KAApB,gBAFP,E,iFAKhB,IAAI7J,EAAQ+G,KAAK4C,MAAMW,MAAMtK,MACzBA,GACH+G,KAAKiK,eAAehR,K,yCAGJiR,EAAWjC,GAC5B,IAAIhP,EAAQ+G,KAAK4C,MAAMW,MAAMtK,MACzBA,GAASiR,EAAU3G,MAAMtK,OAC3B+G,KAAKiK,eAAehR,K,6CAItB8Q,GAAGI,UAAU,YAAY5I,W,qCAEZtI,GACH8Q,GAAGK,OAAO,OAChBD,UAAU,KAAK5I,SACnBwI,GAAGI,UAAU,YAAY5I,SAkC5B,IAAIjO,EAAO2F,EASZ3F,EAAK+W,OAAO,SAASC,EAAEC,GACrBD,EAAErR,OAASqR,EAAErR,QAGf,IAAIuR,EAGHA,EAAalX,EAAKG,IAAI,SAAS6W,GAC7B,OAAOA,EAAErR,QAME3F,EAAKG,IAAI,SAAS6W,GAC7B,OAAOA,EAAEjE,QAMZ,IAAIoE,EAAe,GAAfA,EAA0B,GAA1BA,EAAsC,GAAtCA,EAAgD,GAChDpK,EAAS,IAAMoK,EAAaA,EAChCrK,EAAQ,KAAOqK,EAAcA,EAIzBC,EAASX,GAAGY,MAAMC,SACpBC,OAAO,CAAC,EAAe,GAAZvX,EAAKoT,OAAapT,EAAKoT,SAClCoE,MAAM,CAAC,UAAW,YAWhBC,EAAShB,GAAGY,MAAMC,SACpBC,OAAO,CAAC,EAAGd,GAAGiB,IAAIR,KAClBM,MAAM,CAAC,EAAGzK,IAER4K,EAASlB,GAAGY,MAAMO,UACpBL,OAAOd,GAAGe,MAAM,EAAGxX,EAAKoT,SACxByE,WAAW,CAAC,EAAG/K,GAAQ,IAKrBgL,EAAUrB,GAAGK,OAAO,QAAQiB,OAAO,OACrCxJ,KAAK,QAAS,WACdyJ,MAAM,WAAY,YAClBA,MAAM,UAAW,UACjBA,MAAM,aAAc,SACpBA,MAAM,UAAW,GAEVC,EAAOvL,KAAKuL,KAELxB,GAAGK,OAAOmB,GAGxB1J,KAAK,QAASzB,EAAQqK,EAAcA,GACpC5I,KAAK,SAAUxB,EAASoK,EAAaA,GACrCY,OAAO,KACPxJ,KAAK,YAAa,aAAe4I,EAAc,KAAOA,EAAY,KAClEN,UAAU,QACT7W,KAAKA,GACLkY,QACAH,OAAO,KACNA,OAAO,QACNC,MAAM,OAAQ,SAAShB,EAAEC,GACzB,OAAOG,EAAOH,KAEd1I,KAAK,SAAU,GACfA,KAAK,IAAKxB,GACVwB,KAAK,QAASoJ,EAAOQ,aACrB5J,KAAK,IAAK,SAAUyI,EAAEC,GAAI,OAAOU,EAAOV,KAGxCmB,GAAG,YAAa,SAASpB,GACzBc,EAAQO,aACNL,MAAM,UAAW,IAEnBF,EAAQQ,KAAK,YAActB,EAAEuB,KAAO,KAAOvB,EAAEjE,MAAQ,gBAAkBiE,EAAErR,MAAQ,UAC/EqS,MAAM,OAASvB,GAAG+B,MAAMC,MAAQ,EAAK,MACrCT,MAAM,MAAQvB,GAAG+B,MAAME,MAAQ,EAAK,MACpCV,MAAM,OAAQvB,GAAGK,OAAOmB,GAAMU,KAAO,IAAM,MAC3CX,MAAM,MAAOvB,GAAGK,OAAOmB,GAAMW,IAAM,IAAM,MAE1CnC,GAAGK,OAAOpK,MACRsL,MAAM,UAAW,MAEpBI,GAAG,WAAY,SAASpB,GAExBP,GAAGK,OAAOpK,MACR2L,aACAL,MAAM,UAAW,KAKdK,aACP9J,KAAK,SAAU,SAAUyI,GAAI,OAAOS,EAAOT,EAAErR,SAC7C4I,KAAK,IAAK,SAASyI,GAAK,OAAOjK,EAAS0K,EAAOT,EAAErR,SACjDkT,MAAM,SAAS7B,EAAEC,GAAG,OAAW,GAAJA,IAC3B6B,SAAS,KACTC,KAAK,WAEN,IAAIC,EAAcvC,GAAGY,MAAMC,SACzBC,OAAO,CAAC,EAAGd,GAAGiB,IAAIR,KAClBM,MAAM,CAACzK,EAAQ,IAEbkM,EAAQxC,GAAGyC,IAAIC,OACjB9B,MAAM2B,GACNI,OAAO,QACPC,MAAM,IACJC,EAAS7C,GAAGK,OAAOmB,GAAMF,OAAO,KACnCkB,EAAMK,GACNA,EAAO/K,KAAK,YAAa,aAAc4I,EAAY,KAAKA,EAAa,KACrEmC,EAAOzC,UAAU,QACfmB,MAAM,CAACuB,KAAM,OAAQC,OAAQ,SAC/BF,EAAOzC,UAAU,QACfmB,MAAM,CAAEwB,OAAQ,SAMnB,IAAIC,EAAQhD,GAAGyC,IAAIC,OACjB9B,MAAMM,GACNyB,OAAO,UACPM,WAAW/B,EAAOJ,SAASR,OAAO,SAASC,EAAGC,GAC9C,OAAOA,EAAI,KAAO,KAIX0C,EAASlD,GAAGK,OAAOmB,GAAMF,OAAO,KACxC0B,EAAME,GACNA,EAAOpL,KAAK,YAAa,aAAc4I,EAAY,MAAOpK,EAASoK,GAAc,KACjFwC,EAAO9C,UAAU,QACfmB,MAAM,CAACuB,KAAM,OAAQC,OAAQ,SAC/BG,EAAO9C,UAAU,QACfmB,MAAM,CAAEwB,OAAQ,W,+BAEZ,IAAD,OACH,OACI,yBAAK/S,IAAK,SAAAwR,GAAI,OAAI,EAAKA,KAAOA,GAC9BnL,MAAO,IAAKC,OAAQ,U,GAvNP+E,IAAMC,YA+Od7C,MATS,SAAAlQ,GAAK,MAC3B,CACEiR,MAAOjR,EAAMiR,QAIU,SAAAnR,GAAQ,MAAK,IAGzBoQ,CAGbwH,IC3PGxH,I,OAAWC,EAAQ,IAAnBD,SACDE,GAAUD,EAAQ,IAOhByK,IANMzK,EAAQ,I,YAOjB,WAAYG,GAAO,IAAD,8BACf,4CAAMA,KACDuK,kBAAoB,EAAKA,kBAAkBrK,KAAvB,gBAFV,E,6HAQC7J,M,wCAGDkK,GACjBA,EAAEE,kBAEHjR,EADkB4N,KAAK4C,MAAjBxQ,UACGsQ,GAAQzI,oBAAoB+F,KAAK4C,MAAMxI,OAAOoJ,Y,+BAIrD,IAAIC,EAAQzD,KAyBZ,OACE,yBAAKoG,UAAU,UACf,kBAAC,IAAD,CACC7I,eAdoB,CAAC,CACpB+K,cAAe,4CACfC,mBAAoB,QACpBC,cAAe,IAEjB,CACEF,cAAe,4CACfC,mBAAoB,QACpBC,cAAe,KAOhBC,qBAAsB,qCA5BzB,WACE,IAAIrO,EAASqJ,EAAMb,MAAMxI,OACzB,GAAIA,EAAOoJ,SAAWpJ,EAAOA,OAAOsM,OAAS,EAC3C,OAAOtM,EAAOA,OAAO3G,IAAI,SAAS2Z,GAChC,IAAIC,EAAWD,EAAM5S,IACrB,OACE,yBAAKuF,IAAKsN,EAAW,gCAwBxBC,Q,GAlDWlI,IAAMC,YAyDZ7C,MACd,SAAClQ,GACA,OAAOA,GAFMkQ,CAIb0K,ICrEG1K,GAAWC,EAAQ,IAAnBD,QACDE,GAAUD,EAAQ,IAKhB8K,G,YACH,WAAY3K,GAAO,IAAD,8BACf,4CAAMA,KACD4K,qBAAuB,EAAKA,qBAAqB1K,KAA1B,gBAFb,E,kFAMjB,IAAIW,EAAQzD,KACRkJ,EAAW,IAAIC,UACjBnJ,KAAK4C,MAAMqG,SAASwE,SAASpO,MAChC6J,EAASE,UAAUpJ,KAAK4C,MAAMqG,SAASwE,SAASpO,KAAM,SAAS/L,GAE9D,IAAM+V,EAAU5F,EAAMb,MAAMhG,iBAAiBxB,GAAGkI,MAAM,KAAKgG,MACjDoE,EAAWjK,EAAMb,MAAMhG,iBAAiBiC,OAAOyE,MAAM,KAAKgG,MAGpE7F,EAAML,KAAK/D,KAAK4C,aAAa3O,EAAMmQ,EAAML,KAAK/D,KAAKmK,WAAW,IAC1D,IAAItD,EAAa,GACjB,IAEE5S,EAAKiW,cAAc,IAAMF,IAC5B/V,EAAKiW,cAAc,IAAMF,GAASvH,aAAa,QAAS,eAErDoE,EAAa3F,SAASsF,eAAewD,GAASvD,UAEhD,MAAM3C,GAEJ7P,EAAKiW,cAAc,IAAMmE,IAC5Bpa,EAAKiW,cAAc,IAAMmE,GAAU5L,aAAa,QAAS,eAEtDoE,EAAa3F,SAASsF,eAAe6H,GAAU5H,UAGjD5H,QAAQC,IAAI,SAAU+H,GACtBH,IAAE,sBAAsBC,QAAQ,CAAEC,UAAWC,EAAW,KAAO,S,2CAOhD/C,GACnBA,EAAEE,kBAEHjR,EADkB4N,KAAK4C,MAAjBxQ,UACGsQ,GAAQzD,sBAAsBe,KAAK4C,MAAMqG,SAASzF,Y,+BAMzD,OACE,yBAAK4C,UAAU,qBACb,yBAAKhL,GAAG,iBACN,4BAAQA,GAAG,iBAAiBwI,QAAS5D,KAAKwN,sBAA1C,cAEF,yBAAKpS,GAAG,OAAOrB,IAAI,QAAO,oC,GAvDZqL,IAAMC,WAiEd7C,MACd,SAAClQ,GACA,OAAOA,GAFMkQ,CAIb+K,IC3DII,G,iLAEJ,IAAIlK,EAAQzD,KAsDZ,OACC,6BACC,yBAAKoG,UAAU,WACd,yBAAKA,UAAU,kBACd,kBAAC,EAAD,OA7BJ,WACC,IAAK3C,EAAMb,MAAMW,MAAMC,UAAYC,EAAMb,MAAMxI,OAAOoJ,UAAYC,EAAMb,MAAMqG,SAASzF,QACtF,OACC,6BACA,yBAAKpI,GAAG,iBAAiBgL,UAAU,WAClC,kBAAC,EAAD,OAED,yBAAKhL,GAAG,8BAA8BgL,UAAU,WAC/C,kBAAC,EAAD,OAED,yBAAKA,UAAU,WACd,kBAAC,GAAD,OAID,yBAAKA,UAAU,WAGb,kBAAC,GAAD,CAAWvU,KAAK,aAajB+b,GA3DJ,WACC,GAAInK,EAAMb,MAAMW,MAAMC,QACrB,OACC,yBAAK4C,UAAU,SACd,kBAAC,GAAD,CAAUyH,KAAM,CAAC,IAAI,QAwDrBC,GAnDJ,WACC,GAAIrK,EAAMb,MAAMxI,OAAOoJ,QACtB,OACC,6BACA,kBAAC,GAAD,MACC,yBAAK4C,UAAU,WACd,kBAAC,GAAD,QA8CD2H,GAxCJ,WACC,GAAItK,EAAMb,MAAMqG,SAASzF,QACxB,OACC,kBAAC,GAAD,MAsCCwK,S,GAjEgB5I,IAAMC,WA2Eb7C,qBACb,SAAClQ,GACD,OAAOA,GAFMkQ,CAIbmL,ICjFaM,GAdJ,SAACrL,GACX,OACE,6BACK,wBAAIwD,UAAU,cAAa,yCAA3B,qCACJ,yBAAKA,UAAU,eACd,gCAAK,uBAAGjB,KAAK,2BAAR,gBAAL,gBACA,sDAA2B,uBAAGA,KAAK,qBAAR,6CAC3B,0CAAe,uBAAGA,KAAK,2BAAR,qBAEZ,kBAAC,GAAD,Q,SCCJ+I,I,cAAQzL,EAAQ,KAA0B0L,aAI9CD,GAAME,UAAU,WACHF,GAAM7b,aAMnB6b,GAAM9b,SAASN,+BAAoB,KAEnCoc,GAAM9b,SAASiC,oCACf6Z,GAAM9b,SAAS4C,qCACfkZ,GAAM9b,SAASD,mCACf+b,GAAM9b,SAASyF,mCACfqW,GAAM9b,SAASkF,4CACf4W,GAAM9b,SAASqD,sCACfyY,GAAM9b,SAASgG,8BACf8V,GAAM9b,SAASqG,+BACfyV,GAAM9b,SAAS8G,yBAafmV,IAASC,OACR,kBAAC,WAAD,CAAUJ,MAAOA,IAChB,kBAAC,GAAD,OAED3N,SAASsF,eAAe,U,umBCnDlB,IAAI0I,EAAgB,WAAyB,IAAxBjc,EAAuB,uDAAf,GAAIkc,EAAW,uCACjD,OAAQA,EAAO3c,MACb,IAAK,0BACH,OAAO,EAAP,GACKS,EADL,CAEEP,iBAAkB,KAEtB,IAAK,wBACH,OAAO,EAAP,GACKO,EADL,CAEEP,iBAAkByc,EAAOzc,mBAE7B,IAAK,2BACD,OAAO,EAAP,GACKO,EADL,CAEEe,YAAa,KAEnB,IAAK,8BACH,OAAO,EAAP,GACKf,EADL,CAEEe,YAAamb,EAAOtc,cAExB,IAAK,gCACD,OAAO,EAAP,GACKI,EADL,CAEE8R,iBAAkB,KAExB,IAAK,mCACH,OAAO,EAAP,GACK9R,EADL,CAEE8R,iBAAkBoK,EAAOpa,UAE7B,IAAK,iCACD,OAAO,EAAP,GACK9B,EADL,CAEEwS,kBAAmB,KAEzB,IAAK,oCACH,OAAO,EAAP,GACKxS,EADL,CAEEwS,kBAAmB0J,EAAOpa,UAE9B,IAAK,mCACD,OAAO,EAAP,GACK9B,EADL,CAEEkD,mBAAoB,KAE1B,IAAK,sCACH,OAAO,EAAP,GACKlD,EADL,CAEEkD,mBAAoBgZ,EAAOhZ,qBAE/B,IAAK,mCACH,OAAO,EAAP,GACKlD,EADL,CAEEgS,mBAAoB,KAExB,IAAK,sCACH,OAAO,EAAP,GACKhS,EADL,CAEEgS,mBAAoBkK,EAAOxY,QAE/B,IAAK,+BACH,OAAO,EAAP,GACK1D,EADL,CAEEyS,gBAAiB,KAErB,IAAK,kCACH,OAAO,EAAP,GACKzS,EADL,CAEEyS,gBAAiByJ,EAAOxY,QAE5B,IAAK,8BACD,OAAO,EAAP,GACK1D,EADL,CAEEsF,gBAAiB,KAEvB,IAAK,iCACH,OAAO,EAAP,GACKtF,EADL,CAEEsF,gBAAiB4W,EAAO5W,kBAE5B,IAAK,wCACD,OAAO,EAAP,GACKtF,EADL,CAEE+E,yBAA0B,KAEhC,IAAK,2CACH,OAAO,EAAP,GACK/E,EADL,CAEE+E,yBAA0BmX,EAAOnX,2BAErC,IAAK,0BACD,OAAO,EAAP,GACK/E,EADL,CAEE6F,WAAY,KAElB,IAAK,6BACH,OAAO,EAAP,GACK7F,EADL,CAEE6F,WAAYqW,EAAOrW,aAEvB,IAAK,2BACD,OAAO,EAAP,GACK7F,EADL,CAEEkG,YAAa,KAEnB,IAAK,8BACH,OAAO,EAAP,GACKlG,EADL,CAEEkG,YAAagW,EAAOhW,cAExB,QACE,OAAOlG,I,mjBCjHN,IAAImc,EAAe,WAAyB,IAAxBnc,EAAuB,uDAAf,GAAIkc,EAAW,uCAChD,OAAQA,EAAO3c,MACb,IAAK,uBACD,OAAO,KACFS,EADL,CAEEkR,SAAUgL,EAAO1V,UAEvB,IAAK,oBACD,OAAO,KACFxG,EADL,CAEE2G,MAAO,KAEb,IAAK,uBACH,OAAO,KACF3G,EADL,CAEE2G,MAAOuV,EAAOvV,QAElB,QACE,OAAO3G,I,mjBClBN,IAAIoc,EAAgB,WAAyB,IAAxBpc,EAAuB,uDAAf,GAAIkc,EAAW,uCACjD,OAAQA,EAAO3c,MACb,IAAK,wBACD,OAAO,KACFS,EADL,CAEEkR,SAAUgL,EAAO1V,UAOvB,IAAK,qBACD,OAAO,KACFxG,EADL,CAEE8H,OAAQ,KAEd,IAAK,wBACH,OAAO,KACF9H,EADL,CAEE8H,OAAQoU,EAAOpU,SAEnB,QACE,OAAO9H,I,2jBCvBN,IAAIqc,EAAoB,WAAyB,IAAxBrc,EAAuB,uDAAf,GAAIkc,EAAW,uCACrD,OAAQA,EAAO3c,MACb,IAAK,iBAKL,IAAK,iBACH,MAAM,GAAN,mBACKS,GADL,YAEKkc,EAAO9T,aAEd,IAAK,mBACH,MAAO,GACT,IAAK,yBAEH,MAAO,WACT,IAAK,4BACH,OAAO8T,EAAO9T,WAAWjH,IAAI,SAAC+H,GAC5B,MAAO,CACLJ,GAAII,EAAUA,UAAU5H,MACxB4H,UAAWA,EAAUoT,eAAehb,MACpCyS,MAAO7K,EAAUqT,0BAA0Bjb,MAC3CI,OAAQwH,EAAUsT,aAAalb,MAC/B2T,SAAS,EACT/B,aAAchK,EAAUgK,aAAehK,EAAUgK,aAAa5R,MAAQ,KACtEiL,OAAQrD,EAAUqD,OAASrD,EAAUqD,OAAOjL,MAAQ,KACpD2S,SAAU/K,EAAU+K,SAAW/K,EAAU+K,SAAS3S,MAAQ,KAC1D0S,QAAS9K,EAAU8K,QAAU9K,EAAU8K,QAAQ1S,MAAQ,KACvDiT,QAASrL,EAAUqL,QAAUrL,EAAUqL,QAAQjT,MAAM0P,MAAM,cAAcyL,UAAU,GAAK,QAG9F,IAAK,0BACH,IAAIC,EAAe1c,EAAMmB,IAAI,SAAC+H,GAC5B,OAAIA,EAAUJ,KAAOoT,EAAOpT,GAC1B,KACKI,EADL,CAEE+L,SAAS,IAIX,KACK/L,EADL,CAEE+L,SAAS,MAIf,OAAO,YACFyH,GAEP,QACE,OAAO1c,ICnDF2c,EAA0B,WAAyB,IAAxB3c,EAAuB,uDAAf,GAAIkc,EAAW,uCAC3D,OAAQA,EAAO3c,MACb,IAAK,2BACH,OAAO2c,EAAOhT,UAChB,IAAK,0BACH,MAAO,GACT,QACE,OAAOlJ,ICPF4c,EAA4B,WAAyB,IAAxB5c,EAAuB,uDAAf,GAAIkc,EAAW,uCAC7D,OAAQA,EAAO3c,MACb,IAAK,6BACH,OAAO2c,EAAOhT,UAChB,IAAK,4BACH,OAAO,KACT,QACE,OAAOlJ,I,mjBCPN,IAAI6c,EAA6B,WAAyB,IAAxB7c,EAAuB,uDAAf,GAAIkc,EAAW,uCAC9D,OAAQA,EAAO3c,MACb,IAAK,2BACH,MAAM,GAAN,mBACKS,GADL,YAEKkc,EAAO9T,aAEd,IAAK,6BAEL,IAAK,mCACH,MAAO,GACT,IAAK,sCAEH,OAAO8T,EAAOxS,oBAAoBvI,IAAI,SAAC+H,GACrC,MAAO,CACLJ,GAAII,EAAUA,UAAU5H,MACxB4H,UAAWA,EAAUoT,eAAehb,MACpC2S,SAAU/K,EAAU+K,SAAW/K,EAAU+K,SAAS3S,MAAQ,4BAC1D2T,SAAS,KAGf,IAAK,mCACH,OAAOjV,EAAMmB,IAAI,SAAC+H,GAChB,YACKA,EADL,CAEE+L,SAAS,MAGf,IAAK,oCACH,IAAIyH,EAAe1c,EAAMmB,IAAI,SAAC+H,GAC5B,OAAIA,EAAUJ,KAAOoT,EAAOpT,GAC1B,KACKI,EADL,CAEE+L,SAAS,IAIX,KACK/L,EADL,CAEE+L,SAAS,MAIf,OAAO,YACFyH,GAEP,QACE,OAAO1c,I,mjBC9CN,IAAI8c,EAAiC,WAAyB,IAAxB9c,EAAuB,uDAAf,GAAIkc,EAAW,uCAClE,OAAQA,EAAO3c,MACb,IAAK,+BACH,MAAM,GAAN,mBACKS,GADL,YAEKkc,EAAO9T,aAEd,IAAK,iCAEL,IAAK,uCACH,MAAO,GACT,IAAK,0CAEH,OAAO8T,EAAO/R,wBAAwBhJ,IAAI,SAAC+H,GACzC,MAAO,CACLJ,GAAII,EAAUA,UAAU5H,MACxB4H,UAAWA,EAAUoT,eAAehb,MACpC2T,SAAS,EACTW,kBAAmB1M,EAAU0M,kBAAoB1M,EAAU0M,kBAAkBtU,MAAQ,KACrFwU,uBAAwB5M,EAAU4M,uBAAyB5M,EAAU4M,uBAAuBxU,MAAQ,QAG1G,IAAK,uCACH,OAAOtB,EAAMmB,IAAI,SAAC+H,GAChB,YACKA,EADL,CAEE+L,SAAS,MAGf,IAAK,wCACH,IAAIyH,EAAe1c,EAAMmB,IAAI,SAAC+H,GAC5B,OAAIA,EAAUJ,KAAOoT,EAAOpT,GAC1B,KACKI,EADL,CAEE+L,SAAS,IAIX,KACK/L,EADL,CAEE+L,SAAS,MAIf,OAAO,YACFyH,GAEP,QACE,OAAO1c,I,mjBCjDN,IAAI+c,EAAmB,WAAyB,IAAxB/c,EAAuB,uDAAf,GAAIkc,EAAW,uCACpD,OAAQA,EAAO3c,MACb,IAAK,gBACH,OAAO2c,EAAOlU,UAChB,IAAK,kBAEL,IAAK,wBACH,MAAO,GACT,IAAK,2BACH,OAAOkU,EAAOlU,UAChB,IAAK,qBACH,OAAOhI,EACT,IAAK,wBACH,OAAO,KACFA,EADL,CAEEgM,OAAQkQ,EAAOlQ,SAEnB,QACE,OAAOhM,I,mjBClBN,IAAIgd,EAAyB,WAAyB,IAAxBhd,EAAuB,uDAAf,GAAIkc,EAAW,uCAC1D,OAAQA,EAAO3c,MACb,IAAK,uBACH,OAAO2c,EAAO7P,gBAChB,IAAK,yBAEL,IAAK,+BACH,MAAO,GACT,IAAK,kCACH,OAAO6P,EAAO7P,gBAChB,IAAK,sCACH,OAAOrM,EACT,IAAK,yCACH,OAAO,KACFA,EADL,CAEEgM,OAAQkQ,EAAOlQ,SAEnB,QACE,OAAOhM,I,mjBCjBN,IAAIid,EAAkB,WAAyB,IAAxBjd,EAAuB,uDAAf,GAAIkc,EAAW,uCACnD,OAAQA,EAAO3c,MACb,IAAK,2BACH,OAAO,KACFS,EADL,CAEEkR,SAAUgL,EAAO1V,UAErB,IAAK,gBACH,OAAO,KACFxG,EADL,CAEEmb,SAAUe,EAAOnP,OAErB,IAAK,kBAKL,IAAK,wBACH,OAAO,KACF/M,EADL,CAEEmb,SAAU,KAEd,IAAK,2BACH,OAAO,KACFnb,EADL,CAEEmb,SAAUe,EAAOnP,OAErB,QACE,OAAO/M,IC1Bb,wCAYA,IAAIkd,EAAQ/M,EAAQ,IAChBgN,EAAQhN,EAAQ,KAAeiN,QAExBvB,EAAY,WAAwB,IAAvBwB,EAAsB,uDAAP,GACjCC,EAAUJ,EAAMK,gBAAgB,CAClCrd,OAAQ+b,EACR7T,WAAYiU,EACZ/R,iBAAkBqS,EAClB9T,mBAAoB+T,EACpBlT,oBAAqBmT,EACrB1S,wBAAyB2S,EACzB9U,UAAW+U,EACX1Q,gBAAiB2Q,EACjB/L,MAAOkL,EACPrU,OAAQsU,EACRzF,SAAUsG,IAIRrB,EAAQsB,EAAMM,YAAYF,EAASD,EAAcH,EAAMO,QACzDP,EAAMQ,gBAAgBP,GACtBQ,OAAOC,kBAAmBD,OAAOC,oBAAsB,SAAAC,GAAC,OAAIA,KAE9D,OAAOjC,I,yDCtCLkC,EAAY3N,EAAQ,KAClB4N,E,WAEF,WAAYC,GAKR,GALc,oBACdtQ,KAAKuQ,IAAM,GACXvQ,KAAKoQ,UAAY,GACjBpQ,KAAKwQ,UAAW,EAChBxQ,KAAKyQ,SAAW,GACZH,EACFtQ,KAAKsQ,KAAOA,OAEZ,IACML,SACFjQ,KAAKsQ,KAAOL,OAAOS,SAASvL,KAAK/H,QAAQ,YAAa,MAExD,MAAO+F,GACPnD,KAAKsQ,KAAO,GAGhBtQ,KAAKoQ,UAAUO,KAAKP,GAEpBpQ,KAAK4Q,kBAAoBrQ,SAASe,KAAKuP,kBAAoBtQ,SAASe,KAAKwP,a,qDAQpEC,EAASC,EAAUC,GAAc,IAAD,OA2BrC,OA1BIhB,OAAOS,SAASvL,KAAK+L,WAAWlR,KAAKsQ,OAAUS,EAAQI,QAAQ,MAAQ,IACzEnR,KAAKsQ,KAAOS,EAAQ3T,QAAQ,YAAa,MAG7B,IAAIgU,QAAS,SAAUC,EAASC,GAC1C,IAAIC,EAAS,IAAIC,eAEjBD,EAAOE,KAAK,MAAOV,GACnBQ,EAAOG,OAEPH,EAAOI,OAAS,WACV3R,KAAK4R,QAAU,KAAO5R,KAAK4R,OAAS,IACtCP,EAAQrR,KAAK6R,UAEbP,EAAOtR,KAAK8R,aAGhBP,EAAOQ,QAAU,WACfT,EAAOtR,KAAK8R,eAGjB9T,MAAO,SAASgU,GAEb9T,QAAQC,IAAI6T,KAGD7e,KAAK,SAAC8e,GACjB,OAAO,EAAK7I,UAAU6I,EAAKjB,EAAUC,O,gCAQnCgB,EAAKjB,EAAUC,GAEvB,IAAIiB,GAAY,IAAIC,WAAcC,gBAAgBH,EAAK,YACnDI,EAAMrS,KAAKsS,WAAWJ,EAASlB,EAAUC,GAC7C,OAAOjR,KAAKuS,oBAAoBF,EAAKrB,K,iCAO5BkB,EAASlB,EAAUC,GAAc,IAAD,OAEzCjR,KAAKwS,SAASN,GA6Fd,OAAOlS,KAAKyS,IA3FI,SAAZC,EAAaC,GAIb,IAAIC,EACAC,GAAO,EACX,OAAQF,EAAGG,cACT,IAAK,8BACHF,EAAarS,SAASC,cAAc,OAASmS,EAAGI,SAChD,MACF,IAAK,mCACH,GAAkB,SAAdJ,EAAGI,QAAoB,CACzBH,EAAarS,SAASC,cAAc,SAAWmS,EAAGI,SAClD,MAEJ,IAAK,sCACHH,EAAarS,SAASC,cAAc,OAASmS,EAAGI,SAChD,MACF,QACEH,EAAarS,SAASyS,WAAWL,GAAI,GACrCE,GAAO,EAIX,cAAgBpS,MAAMC,KAAKiS,EAAG/Q,YAA9B,eAA2C,CAAtC,IAAIqR,EAAG,MACHA,EAAIlR,KAAKmP,WAAW,UAAY2B,EACnCD,EAAW9Q,aAAamR,EAAIlR,KAAMkR,EAAIrf,OAEtB,SAAZqf,EAAIlR,MACR6Q,EAAW9Q,aAAa,aAAcmR,EAAIrf,OAE5B,UAAZqf,EAAIlR,MAAqB8Q,GAC3BD,EAAW9Q,aAAa,KAAMmR,EAAIrf,OAEpB,YAAZqf,EAAIlR,MAAuB8Q,GAC7BD,EAAW9Q,aAAa,OAAQmR,EAAIrf,OAEtB,aAAZqf,EAAIlR,MACN6Q,EAAW9Q,aAAa,QAASmR,EAAIrf,MAAMwJ,QAAQ,KAAM,KAU/D,GANAwV,EAAW9Q,aAAa,eAAgB6Q,EAAG5R,WAEf,GAAxB4R,EAAGnJ,WAAW9C,QAChBkM,EAAW9Q,aAAa,aAAc,IAGpB,YAAhB6Q,EAAG5R,UAAyB,CAE9B,IADA,IAAIuK,EAAQ/K,SAASC,cAAc,SACnC,MAAiBC,MAAMC,KAAKiS,EAAGnJ,YAA/B,eAA2C,CAAtC,IAAI+B,EAAI,KACX,GAAIA,EAAK3K,UAAYC,KAAKC,cAAkC,aAAlByK,EAAKxK,WAA2D,OAA/BwK,EAAKrL,aAAa,UAAoB,CAC/G,IAAIgT,EAAO,GACP3H,EAAKpL,aAAa,aAEpB+S,GAAQ3H,EAAKrL,aAAa,YAAY9C,QAAQ,iBAAkB,UAAUA,QAAQ,SAAU,KAAO,MACnG8V,GAAQ3H,EAAK4H,cAEbD,GAAQ,IAAM3H,EAAKrL,aAAa,UAAY,MAC5CgT,GAAQ3H,EAAK4H,aAEfD,GAAQ,QACR5H,EAAMpK,YAAYX,SAASmJ,eAAewJ,KAG1C5H,EAAM9B,WAAW9C,OAAS,IAC5BkM,EAAW1R,YAAYoK,GACvB,EAAKkF,UAAW,GAIA,aAAhBmC,EAAG5R,YACL,EAAK0P,SAASE,KAAKgC,EAAGzS,aAAa,UACnC,EAAKuQ,SAASkC,EAAGzS,aAAa,UAC5B,CAAC,aAAgByS,EAAGzS,aAAa,gBACjC,mBAAsByS,EAAGzS,aAAa,wBAE1C,cAAiBO,MAAMC,KAAKiS,EAAGnJ,YAA/B,eAA2C,CAAtC,IAAI+B,EAAI,KACLA,EAAK3K,UAAYC,KAAKC,aACtB8R,EAAW1R,YAAcwR,EAAUnH,IAGnCqH,EAAW1R,YAAYqK,EAAK6H,aAMpC,OAHInC,GACFA,EAAa2B,GAERA,EAGOF,CAAUR,EAAQmB,mB,0CAKlBhB,EAAKrB,GAQvB,GANIqB,EAAIiB,gBACNtT,KAAKuT,YAAYvT,KAAKuQ,KAEtBvQ,KAAKwT,SAASxT,KAAKuQ,KAErBvQ,KAAKyT,MAAO,GACRzC,EAIA,OAAOhR,KAAKyS,IAHZzB,EAAShR,KAAKyS,IAAKzS,Q,+BAWhBqS,EAAK/e,GACR0M,KAAKwQ,UACP6B,EAAIqB,qBAAqB,QAAQ7H,KAAK,GAAG3K,YAAY5N,EAAKogB,qBAAqB,SAAS7H,KAAK,GAAGuH,WAAU,M,qCAO/FO,GACT3T,KAAK4T,YACPD,EAAO1S,UAAY,uBAA+BjB,KAAK4T,UAAY,cAAiBD,EAAO1S,a,mCAQlF4S,GACPA,EAAI,UAAgBA,EAAI,UAC1B7T,KAAKoQ,UAAUO,KAAKkD,GAEpB3V,QAAQC,IAAI,4C,iCAQLmS,GACTtQ,KAAKsQ,KAAOA,I,+BAIL4B,GACL,IAAI4B,EAAU5B,EAAQmB,gBACtBrT,KAAKuQ,IAAM,IAAIwD,IAAKtT,MAAMC,KAAKoT,EAAQE,uBAAuB,8BAA+B,KAAM,SAAAC,GAAC,OAAIA,EAAElB,WAC1G/S,KAAKuQ,IAAI2D,IAAI,SACblU,KAAKuQ,IAAI2D,IAAIJ,EAAQf,W,8BAIjBnT,EAAKuU,GACX,IAAIC,EAAO7T,SAASC,cAAc,QAclC,OAbI2T,EAAQzN,OAAS,EACfyN,EAAQ,GAAGvN,SAAS,MAAQuN,EAAQ,GAAGvN,SAAS,MAClDwN,EAAKnT,UAAYkT,EAAQ,GAAKvU,EAAIqB,UAAYkT,EAAQ,GAEtDC,EAAKnT,UAAY,SAAWkT,EAAQ,GAAK,UAAYvU,EAAIqB,UAAY,SAAWkT,EAAQ,GAAK,UAG3FA,EAAQ,GAAGvN,SAAS,KACtBwN,EAAKnT,UAAYkT,EAAQ,GAAKvU,EAAIqB,UAElCmT,EAAKnT,UAAY,SAAWkT,EAAQ,GAAK,UAAYvU,EAAIqB,UAGzDmT,EAAKzT,SAAS+F,OAAS,EAClB0N,EAEAA,EAAKzT,SAAS,K,gCAKf0T,EAAKzU,GACb,IAAIlM,EAAS2gB,EACb,GAAIA,EAAI7hB,OAAO,gBAGb,IAFA,IACI8hB,EADAC,EAAK,iBAEFD,EAAeC,EAAGC,KAAKH,IACxBzU,EAAIO,aAAamU,EAAa,MAE9B5gB,EADE4gB,EAAa,IAAMtU,KAAKsU,EAAa,IAC9B5gB,EAAO0J,QAAQkX,EAAa,GAAItU,KAAKsU,EAAa,IAAIG,KAAKzU,KAAMJ,EAAIM,aAAaoU,EAAa,MAE/F5gB,EAAO0J,QAAQkX,EAAa,GAAI1U,EAAIM,aAAaoU,EAAa,MAK/E,OAAO5gB,I,8BAGDqO,GACN,MAAY,SAARA,EACK,SAAWA,EAEX,OAASA,I,gCASVoS,GACR,IAAIO,EAAY1U,KAChB,OAAO,SAAUJ,GAEf,IADA,IAAIiT,EAAO,GACFtI,EAAI,EAAGA,EAAI4J,EAAQzN,OAAQ6D,IAClCsI,EAAKlC,KAAK+D,EAAUC,UAAUR,EAAQ5J,GAAI3K,IAE5C,OAAO8U,EAAUE,QAAQhV,EAAKiT,M,iCAOvBgC,GACT,IAAK,IAAItK,EAAIvK,KAAKoQ,UAAU1J,OAAS,EAAG6D,GAAK,EAAGA,IAC9C,GAAIvK,KAAKoQ,UAAU7F,GAAf,SAA8BsK,GAChC,OAAIpU,MAAMqU,QAAQ9U,KAAKoQ,UAAU7F,GAAf,SAA8BsK,IACvC7U,KAAKqL,OAAOrL,KAAK+U,UAAU/U,KAAKoQ,UAAU7F,GAAf,SAA8BsK,KAEzD7U,KAAKqL,OAAOrL,KAAKoQ,UAAU7F,GAAf,SAA8BsK,M,kCAS7CA,GACV,IAAK,IAAItK,EAAIvK,KAAKoQ,UAAU1J,OAAS,EAAG6D,GAAK,EAAGA,IAC9C,GAAIvK,KAAKoQ,UAAU7F,GAAf,SAA8BsK,GAChC,OAAIpU,MAAMqU,QAAQ9U,KAAKoQ,UAAU7F,GAAf,SAA8BsK,IACvC7U,KAAK+U,UAAU/U,KAAKoQ,UAAU7F,GAAf,SAA8BsK,IAE7C7U,KAAKoQ,UAAU7F,GAAf,SAA8BsK,K,6BAYtCA,EAAIjV,GACT,IAAIA,EASG,CACL,IAAIoV,EAAOhV,KACX,OAAIA,KAAK4Q,kBACA,WACL,IAAI/Q,EAAUgV,EAAGJ,KAAKO,EAAMhV,MACxBH,GACFmV,EAAKC,cAAcjV,KAAMH,IAItB,WACL,IAAIA,EAAUgV,EAAGJ,KAAKO,EAAMhV,MACxBH,IAAaG,KAAKuJ,cAAc,YAAc1J,EAAQqV,WACxDF,EAAKG,aAAanV,KAAMH,IArB9B,IAAIA,EAAUgV,EAAGJ,KAAKzU,KAAMJ,GACxBC,IAAaD,EAAI2J,cAAc,YAAc1J,EAAQqV,YACnDlV,KAAK4Q,kBACP5Q,KAAKiV,cAAcrV,EAAKC,GAExBG,KAAKmV,aAAavV,EAAKC,M,oCAyBjBD,EAAKC,GACjB,IAAI8T,EAAS/T,EAAIkR,aAAa,CAACsE,KAAK,SACpCpV,KAAKqV,eAAe1B,GACpBA,EAAOzS,YAAYrB,K,mCAMRD,EAAKC,GAChBG,KAAKsV,YAAY1V,GACjBA,EAAIsB,YAAYrB,K,kCAON0V,GAAQ,IAAD,uBACjB,YAAiBA,EAAjB,+CAAwB,CAAC,IAAhBxT,EAAe,QAClByT,EAAQC,OAAOC,OAAOC,YAAYC,WAClCf,EAAK7U,KAAK6V,WAAW9T,GACrB8S,IACFW,EAAMM,gBAAkBjB,GAE1B,IAAIkB,EAAe/V,KAAK+S,QAAQhR,GAChC,IACExB,SAAS+S,gBAAgByC,EAAc,CAACH,UAAWJ,IACnD,MAAOQ,GACP9X,QAAQC,IAAI4X,EAAe,qDAC3B7X,QAAQC,IAAI6X,KAZC,qF,+BAuBVT,GAAQ,IAAD,uBACd,YAAiBA,EAAjB,+CAAwB,CAAC,IAAhBxT,EAAe,QAClB8S,EAAK7U,KAAKiW,YAAYlU,GAC1B,GAAI8S,EACF,cAAgBpU,MAAMC,KAAKV,KAAKyS,IAAIiB,qBAAqB1T,KAAK+S,QAAQhR,KAAtE,eAA+E,CAA1E,IAAInC,EAAG,KACVI,KAAKqL,OAAOwJ,EAAIjV,KALR,qF,yBAiBbpF,GACD,OAAKA,EAAI0b,MAAM,iCAGN1b,EAFAwF,KAAKsQ,KAAO9V,I,4BASjB2b,GACJ,OAAOA,EAAK/Y,QAAQ,OAAQ,M,gCAMpBuV,EAAIyD,GACZ,IAAI/B,EAAM,GACV,IAAK+B,EAAU,CACb/B,GAAO,OAAS1B,EAAGzS,aAAa,gBAChC,cAAiBO,MAAMC,KAAKiS,EAAG/Q,YAA/B,eAA4C,CAAvC,IAAIC,EAAI,KACNA,EAAKE,KAAKmP,WAAW,UAAc,CAAC,KAAM,OAAQ,SAAStK,SAAS/E,EAAKE,QAC5EsS,GAAO,IAAMxS,EAAKE,KAAO,KAAQF,EAAKjO,MAAQ,KAE/B,cAAbiO,EAAKE,OACPsS,GAAO,WAAcxS,EAAKjO,MAAO,KAGjC+e,EAAGnJ,WAAW9C,OAAS,EACzB2N,GAAO,IAEPA,GAAO,KAGX,cAAiB5T,MAAMC,KAAKiS,EAAGnJ,YAA/B,eAA4C,CAAvC,IAAI+B,EAAI,KACX,OAAQA,EAAK3K,UACX,KAAKC,KAAKC,aACRuT,GAAOrU,KAAKqC,UAAUkJ,GACtB,MACF,KAAK1K,KAAKwV,4BACRhC,GAAO,QAAU9I,EAAK+K,UAAY,KAClC,MACF,KAAKzV,KAAK0V,aACRlC,GAAO,UAAY9I,EAAK+K,UAAY,SACpC,MACF,QACEjC,GAAO9I,EAAK+K,UAAUlZ,QAAQ,KAAM,SAM1C,OAHKgZ,GAAYzD,EAAGnJ,WAAW9C,OAAS,IACtC2N,GAAO,QAAU1B,EAAGzS,aAAa,gBAAkB,KAE9CmU,I,kCAMGzU,GACV,GAAIA,EAAI4J,WAAW9C,OAAS,EAAG,CAC7B,IAAI7G,EAAUD,EAAIqB,UAClBrB,EAAIqB,UAAY,GAChB,IAAIuV,EAASjW,SAASC,cAAc,QACpCgW,EAAO1U,aAAa,QAAS,iBAC7B0U,EAAO1U,aAAa,QAAS,QAC7B0U,EAAOvV,UAAYpB,EACnBD,EAAIsB,YAAYsV,M,uCAIHnC,GACf,OAAOA,EAAIjX,QAAQ,OAAQ,KAChBA,QAAQ,SAAU,KAClBA,QAAQ,SAAU,KAClBA,QAAQ,QAAS,O,qCAI5BqZ,aAAaC,QAAQ,SAASzG,OAAO0G,W,wCAIjCF,aAAaG,QAAQ,WACvB3G,OAAO4G,SAAS,EAAGJ,aAAaG,QAAQ,a,0CAmBhD,IACM3G,SACAA,OAAOI,MAAQA,EACfJ,OAAO6G,OAASzG,EAAM0G,aACtB9G,OAAO+G,KAAO3G,EAAM4G,iBAExB,MAAO9T,IAKMkN,a","file":"static/js/main.d60a25f6.chunk.js","sourcesContent":["import axios from 'axios';\n\nconst sparqlEndpoint = \"https://sparql-docker.scta.info/ds/query\"\n//const sparqlEndpoint = \"http://sparql-staging.scta.info/ds/query\"\n//const sparqlEndpoint = \"http://localhost:3030/ds/query\"\n\n///search actions\n//===============\nexport var clearSearchParameters = () => {\n  return {\n    type: \"CLEAR_SEARCH_PARAMETERS\",\n  };\n};\nexport var setSearchParameters = (searchParameters) => {\n  return {\n    type: \"SET_SEARCH_PARAMETERS\",\n    searchParameters\n  };\n};\nexport var startSearchWorksFetch = () => {\n  return{\n    type: \"START_SEARCH_WORKS_FETCH\"\n  };\n};\nexport var completeSearchWorksFetch = (listOfWorks) => {\n  return{\n    type: \"COMPLETE_SEARCH_WORKS_FETCH\",\n    listOfWorks\n  };\n};\nexport var fetchSearchWorksList = () =>{\n  return (dispatch, getState) => {\n    var state = getState();\n    var workGroupSparql = \"\"\n    if (state.search.searchParameters.workGroup){\n      workGroupSparql = [\n      \"<http://scta.info/resource/\" + state.search.searchParameters.workGroup + \"> <http://scta.info/property/hasExpression> ?expression .\"\n      ].join('');\n    }\n    let expressionAuthorTypeSparql = \"\"\n    if (state.search.searchParameters.expressionAuthorType){\n      expressionAuthorTypeSparql = [\n      \"?expression <http://www.loc.gov/loc.terms/relators/AUT> ?expressionAuthor . \",\n      \"?expressionAuthor <http://scta.info/property/personType> <http://scta.info/resource/\" + state.search.searchParameters.expressionAuthorType + \"> .\"\n      ].join('');\n    }\n\n    var authorSparql = \"\"\n    if (state.search.searchParameters.expressionAuthor){\n      authorSparql = [\n      \"?expression <http://www.loc.gov/loc.terms/relators/AUT> <http://scta.info/resource/\" + state.search.searchParameters.expressionAuthor + \"> .\"\n      ].join('');\n    }\n    var query = [\n        \"SELECT ?type ?expression ?expressionShortId ?expressionTitle ?author ?authorTitle ?workGroup ?workGroupTitle\",\n        \"WHERE { \",\n          \"?expression a <http://scta.info/resource/expression> .\",\n          \"?expression a ?type .\",\n          \"?expression <http://scta.info/property/level> '1' . \",\n          expressionAuthorTypeSparql,\n          workGroupSparql,\n          authorSparql,\n          \"?expression <http://scta.info/property/shortId> ?expressionShortId .\",\n          \"?expression <http://scta.info/property/shortId> ?expressionShortId .\",\n          \"?expression <http://purl.org/dc/elements/1.1/title> ?expressionTitle .\",\n          \"?expression <http://www.loc.gov/loc.terms/relators/AUT> ?author . \",\n          \"?author <http://purl.org/dc/elements/1.1/title> ?authorTitle .\",\n          \"?expression <http://purl.org/dc/terms/isPartOf> ?workGroup .\",\n          \"?workGroup <http://purl.org/dc/elements/1.1/title> ?workGroupTitle .\",\n          \"}\",\n        \"ORDER BY ?expressionTitle\"].join('');\n\n  dispatch(startSearchWorksFetch());\n  axios.get(sparqlEndpoint, {params: {\"query\" : query, \"output\": \"json\"}}).then(function(res){\n    var results = res.data.results.bindings;\n    var searchWorks = results.map((result) => {\n      var workInfo = {\n          expression: result.expression.value,\n          expressionShortId: result.expressionShortId ? result.expressionShortId.value : \"\",\n          expressionTitle: result.expressionTitle.value,\n          workGroup: result.workGroup ? result.workGroup.value : \"\",\n          workGroupTitle: result.workGroupTitle ? result.workGroupTitle.value : \"\",\n          author: result.author ? result.author.value : \"\",\n          authorTitle: result.author ? result.authorTitle.value : \"\",\n          type: result.type.value\n\n        }\n        return workInfo\n\n      });\n      dispatch(completeSearchWorksFetch(searchWorks));\n    });\n  }\n};\n\n//Begin Quotations Authors Fetch\nexport var startQuotationAuthorsFetch = () => {\n  return{\n    type: \"START_QUOTATION_AUTHORS_FETCH\"\n  };\n};\nexport var completeQuotationAuthorsFetch = (authors) => {\n  return{\n    type: \"COMPLETE_QUOTATION_AUTHORS_FETCH\",\n    authors\n  };\n};\nexport var fetchQuotationAuthors = () =>{\n  return (dispatch, getState) => {\n    var state = getState();\n    let quotationAuthorTypeSparql = \"\";\n    if (state.search.searchParameters.quotationAuthorType){\n\n      quotationAuthorTypeSparql = [\n      \"?author <http://scta.info/property/personType> <http://scta.info/resource/\" + state.search.searchParameters.quotationAuthorType + \"> .\"\n      ].join('');\n    }\n    // Begin Author date sparql filters\n    let quotationAuthorDateSparql = \"\";\n    if (state.search.searchParameters.quotationAuthorDateAfter || state.search.searchParameters.quotationAuthorDateBefore){\n      quotationAuthorDateSparql = \"?author <http://scta.info/property/dateOfBirth> ?dateOfBirth .\"\n    }\n    let quotationAuthorDateAfterSparqlFilter = \"\";\n    if (state.search.searchParameters.quotationAuthorDateAfter){\n      quotationAuthorDateAfterSparqlFilter = \"FILTER (?dateOfBirth >= '\" + state.search.searchParameters.quotationAuthorDateAfter + \"').\"\n    }\n    let quotationAuthorDateBeforeSparqlFilter = \"\";\n    if (state.search.searchParameters.quotationAuthorDateBefore){\n      quotationAuthorDateBeforeSparqlFilter = \"FILTER (?dateOfBirth <= '\" + state.search.searchParameters.quotationAuthorDateBefore + \"').\"\n    }\n    // END author date sparql filter\n    var query = [\n        \"SELECT DISTINCT ?author ?authorTitle ?authorShortId \",\n        \"WHERE { \",\n        \"?author a <http://scta.info/resource/person> .\",\n        quotationAuthorTypeSparql,\n        quotationAuthorDateSparql,\n        \"?resource a <http://scta.info/resource/expression> .\",\n        \"?resource <http://scta.info/property/level> '1' .\",\n        \"?resource <http://www.loc.gov/loc.terms/relators/AUT> ?author .\",\n        \"?author <http://scta.info/property/shortId> ?authorShortId .\",\n        \"?author <http://purl.org/dc/elements/1.1/title> ?authorTitle .\",\n        quotationAuthorDateAfterSparqlFilter,\n        quotationAuthorDateBeforeSparqlFilter,\n        \"}\",\n        \"ORDER BY ?authorTitle\"].join('');\n  dispatch(startQuotationAuthorsFetch());\n  axios.get(sparqlEndpoint, {params: {\"query\" : query, \"output\": \"json\"}}).then(function(res){\n    var results = res.data.results.bindings;\n    var authors = results.map((result) => {\n        var authorInfo = {\n          author: result.author.value,\n          authorShortId: result.authorShortId.value,\n          authorTitle: result.authorTitle.value,\n        }\n        return authorInfo\n\n      });\n      dispatch(completeQuotationAuthorsFetch(authors));\n    });\n  }\n};\n// End Quotation Authors Fetch\n// Begin Expression Authors Fetch\nexport var startExpressionAuthorsFetch = () => {\n  return{\n    type: \"START_EXPRESSION_AUTHORS_FETCH\"\n  };\n};\nexport var completeExpressionAuthorsFetch = (authors) => {\n  return{\n    type: \"COMPLETE_EXPRESSION_AUTHORS_FETCH\",\n    authors\n  };\n};\nexport var fetchExpressionAuthors = () =>{\n  return (dispatch, getState) => {\n    var state = getState();\n    let expressionAuthorTypeSparql = \"\";\n    if (state.search.searchParameters.expressionAuthorType){\n\n      expressionAuthorTypeSparql = [\n      \"?author <http://scta.info/property/personType> <http://scta.info/resource/\" + state.search.searchParameters.expressionAuthorType + \"> .\"\n      ].join('');\n    }\n\n    // Begin expression author filter\n    let expressionAuthorDateSparql = \"\";\n    if (state.search.searchParameters.expressionAuthorDateAfter || state.search.searchParameters.expressionAuthorDateBefore){\n      expressionAuthorDateSparql = \"?author <http://scta.info/property/dateOfBirth> ?dateOfBirth .\"\n    }\n\n    let expressionAuthorDateAfterSparqlFilter = \"\";\n    if (state.search.searchParameters.expressionAuthorDateAfter){\n      expressionAuthorDateAfterSparqlFilter = \"FILTER (?dateOfBirth >= '\" + state.search.searchParameters.expressionAuthorDateAfter + \"').\"\n    }\n\n    let expressionAuthorDateBeforeSparqlFilter = \"\";\n    if (state.search.searchParameters.expressionAuthorDateBefore){\n      expressionAuthorDateBeforeSparqlFilter = \"FILTER (?dateOfBirth <= '\" + state.search.searchParameters.expressionAuthorDateBefore + \"').\"\n    }\n    // End expression author filter\n    var query = [\n        \"SELECT DISTINCT ?author ?authorTitle ?authorShortId \",\n        \"WHERE { \",\n        \"?author a <http://scta.info/resource/person> .\",\n        expressionAuthorTypeSparql,\n        expressionAuthorDateSparql,\n        \"?resource a <http://scta.info/resource/expression> .\",\n        \"?resource <http://scta.info/property/level> '1' .\",\n        \"?resource <http://www.loc.gov/loc.terms/relators/AUT> ?author .\",\n        \"?author <http://scta.info/property/shortId> ?authorShortId .\",\n        \"?author <http://purl.org/dc/elements/1.1/title> ?authorTitle .\",\n        expressionAuthorDateAfterSparqlFilter,\n        expressionAuthorDateBeforeSparqlFilter,\n        \"}\",\n        \"ORDER BY ?authorTitle\"].join('');\n\n  dispatch(startExpressionAuthorsFetch());\n  axios.get(sparqlEndpoint, {params: {\"query\" : query, \"output\": \"json\"}}).then(function(res){\n    var results = res.data.results.bindings;\n    var authors = results.map((result) => {\n        var authorInfo = {\n          author: result.author.value,\n          authorShortId: result.authorShortId.value,\n          authorTitle: result.authorTitle.value,\n        }\n        return authorInfo\n\n      });\n      dispatch(completeExpressionAuthorsFetch(authors));\n    });\n  }\n};\n// END Expression Authors Actions\nexport var startQuotationWorksListFetch = () => {\n  return{\n    type: \"START_QUOTATION_WORKS_LIST_FETCH\"\n  };\n};\nexport var completeQuotationWorksListFetch = (quotationWorksList) => {\n  return{\n    type: \"COMPLETE_QUOTATION_WORKS_LIST_FETCH\",\n    quotationWorksList\n  };\n};\nexport var fetchQuotationWorksList = () =>{\n  return (dispatch, getState) => {\n    var state = getState();\n    var quotationWorkGroupSparql = \"\"\n    if (state.search.searchParameters.quotationWorkGroup){\n      quotationWorkGroupSparql = [\n      \"<http://scta.info/resource/\" + state.search.searchParameters.quotationWorkGroup + \"> <http://scta.info/property/hasExpression> ?expression .\"\n      ].join('');\n    }\n    var quotationAuthorSparql = \"\"\n    if (state.search.searchParameters.quotationAuthor){\n      quotationAuthorSparql = [\n      \"?expression <http://www.loc.gov/loc.terms/relators/AUT> <http://scta.info/resource/\" + state.search.searchParameters.quotationAuthor + \"> .\"\n      ].join('');\n    }\n    let quotationAuthorTypeSparql = \"\"\n    if (state.search.searchParameters.quotationAuthorType){\n      quotationAuthorTypeSparql = [\n      \"?expression <http://www.loc.gov/loc.terms/relators/AUT> ?quotationAuthor . \",\n      \"?quotationAuthor <http://scta.info/property/personType> <http://scta.info/resource/\" + state.search.searchParameters.quotationAuthorType + \"> .\"\n      ].join('');\n    }\n\n    // var query = [\n    //     \"SELECT ?type ?expression ?expressionShortId ?expressionTitle ?author ?authorTitle ?workGroup ?workGroupTitle\",\n    //     \"WHERE { \",\n    //     \"{\",\n    //     \"?expression a <http://scta.info/resource/work> .\",\n    //     \"?expression a ?type .\",\n    //     \"?expression <http://purl.org/dc/elements/1.1/title> ?expressionTitle .\",\n    //     \"}\",\n    //     \"UNION{\",\n    //     \"?expression a <http://scta.info/resource/expression> .\",\n    //     \"?expression a ?type .\",\n    //     \"?expression <http://scta.info/property/level> '1' . \",\n    //     \"?expression <http://scta.info/property/shortId> ?expressionShortId .\",\n    //     \"?expression <http://purl.org/dc/elements/1.1/title> ?expressionTitle .\",\n    //     \"OPTIONAL { \",\n    //     \"?expression <http://www.loc.gov/loc.terms/relators/AUT> ?author . \",\n    //     \"?author <http://purl.org/dc/elements/1.1/title> ?authorTitle .\",\n    //     \"}\",\n    //     \"?expression <http://purl.org/dc/terms/isPartOf> ?workGroup .\",\n    //     \"?workGroup <http://purl.org/dc/elements/1.1/title> ?workGroupTitle .\",\n    //     \"}\",\n    //     \"}\",\n    //     \"ORDER BY ?expressionTitle\"].join('');\n    var query = [\n        \"SELECT ?type ?expression ?expressionShortId ?expressionTitle ?author ?authorTitle ?workGroup ?workGroupTitle\",\n        \"WHERE { \",\n        \"?expression a <http://scta.info/resource/expression> .\",\n        \"?expression a ?type .\",\n        \"?expression <http://scta.info/property/level> '1' . \",\n        quotationAuthorTypeSparql,\n        quotationWorkGroupSparql,\n        quotationAuthorSparql,\n        \"?expression <http://scta.info/property/shortId> ?expressionShortId .\",\n        \"?expression <http://purl.org/dc/elements/1.1/title> ?expressionTitle .\",\n        \"OPTIONAL { \",\n        \"?expression <http://www.loc.gov/loc.terms/relators/AUT> ?author . \",\n        \"?author <http://purl.org/dc/elements/1.1/title> ?authorTitle .\",\n        \"}\",\n        \"?expression <http://purl.org/dc/terms/isPartOf> ?workGroup .\",\n        \"?workGroup <http://purl.org/dc/elements/1.1/title> ?workGroupTitle .\",\n        \"}\",\n        \"ORDER BY ?expressionTitle\"].join('');\n\n  dispatch(startQuotationWorksListFetch());\n  axios.get(sparqlEndpoint, {params: {\"query\" : query, \"output\": \"json\"}}).then(function(res){\n    var results = res.data.results.bindings;\n    var quotationWorksList = results.map((result) => {\n      var quotationWorkInfo = {\n          expression: result.expression.value,\n          expressionShortId: result.expressionShortId ? result.expressionShortId.value : \"\",\n          expressionTitle: result.expressionTitle.value,\n          workGroup: result.workGroup ? result.workGroup.value : \"\",\n          workGroupTitle: result.workGroupTitle ? result.workGroupTitle.value : \"\",\n          author: result.author ? result.author.value : \"\",\n          authorTitle: result.author ? result.authorTitle.value : \"\",\n          type: result.type.value\n\n        }\n        return quotationWorkInfo\n      });\n      dispatch(completeQuotationWorksListFetch(quotationWorksList));\n    });\n  }\n};\nexport var startQuotationWorkPartsFetch = () => {\n  return{\n    type: \"START_QUOTATION_WORK_PARTS_FETCH\"\n  };\n};\nexport var completeQuotationWorkPartsFetch = (parts) => {\n  return{\n    type: \"COMPLETE_QUOTATION_WORK_PARTS_FETCH\",\n    parts\n  };\n};\nexport var fetchQuotationWorkParts = () =>{\n  return (dispatch, getState) => {\n    var state = getState();\n    var currentNode = \"\";\n    if (state.search.searchParameters.quotationWorkPart != \"\"){\n      currentNode = state.search.searchParameters.quotationWorkPart;\n    }\n    else if (state.search.searchParameters.quotationWork != \"\"){\n      currentNode = state.search.searchParameters.quotationWork;\n    }\n    else{\n      currentNode = \"\";\n    }\n\n    var query = [\n        \"SELECT ?grandparent ?grandparent_title ?parent_title ?parent ?child ?child_title \",\n        \"WHERE { \",\n        \"BIND(<http://scta.info/resource/\" + currentNode + \"> AS ?parent)\",\n        \"OPTIONAL {\",\n          \"?parent <http://purl.org/dc/elements/1.1/title> ?parent_title\",\n        \"}\",\n        \"OPTIONAL {\",\n        \"?parent <http://purl.org/dc/terms/hasPart> ?child .\",\n        \"?child <http://purl.org/dc/elements/1.1/title> ?child_title .\",\n        //\"MINUS{?child <http://scta.info/property/structureType> <http://scta.info/resource/structureDivision> .}\",\n        \"}\",\n        \"OPTIONAL {\",\n        \"?parent <http://purl.org/dc/terms/isPartOf> ?grandparent .\",\n        //\"?grandparent <http://scta.info/property/structureType> <http://scta.info/resource/structureCollection> .\",\n        \"?grandparent <http://purl.org/dc/elements/1.1/title> ?grandparent_title\",\n        \"}\",\n        \"}\"\n        ].join('');\n    //conditional here prevents running query if the node is blank\n    //if (currentNode){\n    dispatch(startQuotationWorkPartsFetch());\n    axios.get(sparqlEndpoint, {params: {\"query\" : query, \"output\": \"json\"}}).then(function(res){\n      var results = res.data.results.bindings;\n      var parts = results.map((result) => {\n          var partInfo = {\n            grandparent: result.grandparent ? result.grandparent.value : \"\",\n            grandparent_title: result.grandparent_title ? result.grandparent_title.value : \"\",\n            parent: result.parent.value,\n            parent_title: result.parent_title ? result.parent_title.value : \"\",\n            child: result.child ? result.child.value : \"\",\n            child_title: result.child_title ? result.child_title.value : \"\"\n          }\n          return partInfo\n\n        });\n        dispatch(completeQuotationWorkPartsFetch(parts));\n      });\n    //}\n  }\n};\n\nexport var startExpressionPartsFetch = () => {\n  return{\n    type: \"START_EXPRESSION_PARTS_FETCH\"\n  };\n};\nexport var completeExpressionPartsFetch = (parts) => {\n  return{\n    type: \"COMPLETE_EXPRESSION_PARTS_FETCH\",\n    parts\n  };\n};\nexport var fetchExpressionParts = () =>{\n  return (dispatch, getState) => {\n    var state = getState();\n    var currentNode = \"\";\n    if (state.search.searchParameters.expressionPart != \"\"){\n      currentNode = state.search.searchParameters.expressionPart;\n    }\n    else if (state.search.searchParameters.expressionId != \"\"){\n      currentNode = state.search.searchParameters.expressionId;\n    }\n    else{\n      currentNode = \"\";\n    }\n    var query = [\n        \"SELECT ?grandparent ?grandparent_title ?grandparent_level ?parent_title ?parent ?parent_level ?child ?child_level ?child_title \",\n        \"WHERE { \",\n        \"BIND(<http://scta.info/resource/\" + currentNode + \"> AS ?parent)\",\n        \"OPTIONAL {\",\n          \"?parent <http://purl.org/dc/elements/1.1/title> ?parent_title .\",\n          \"?parent <http://scta.info/property/level> ?parent_level .\",\n        \"}\",\n        \"OPTIONAL {\",\n        \"?parent <http://purl.org/dc/terms/hasPart> ?child .\",\n        \"?child <http://purl.org/dc/elements/1.1/title> ?child_title .\",\n        \"?child <http://scta.info/property/level> ?child_level .\",\n        //\"MINUS{?child <http://scta.info/property/structureType> <http://scta.info/resource/structureDivision> .}\",\n        \"}\",\n        \"OPTIONAL {\",\n        \"?parent <http://purl.org/dc/terms/isPartOf> ?grandparent .\",\n        //\"?grandparent <http://scta.info/property/structureType> <http://scta.info/resource/structureCollection> .\",\n        \"?grandparent <http://purl.org/dc/elements/1.1/title> ?grandparent_title .\",\n        \"?grandparent <http://scta.info/property/level> ?grandparent_level .\",\n        \"}\",\n        \"}\"\n        ].join('');\n  //conditional prevents running query if current node is blank\n  if (currentNode){\n    dispatch(startExpressionPartsFetch());\n    axios.get(sparqlEndpoint, {params: {\"query\" : query, \"output\": \"json\"}}).then(function(res){\n      var results = res.data.results.bindings;\n      var parts = results.map((result) => {\n          var partInfo = {\n            grandparent: result.grandparent ? result.grandparent.value : \"\",\n            grandparent_title: result.grandparent_title ? result.grandparent_title.value : \"\",\n            grandparent_level: result.grandparent_level ? result.grandparent_level.value : \"\",\n            parent: result.parent.value,\n            parent_title: result.parent_title ? result.parent_title.value : \"\",\n            parent_level: result.parent_level ? result.parent_level.value : \"\",\n            child: result.child ? result.child.value : \"\",\n            child_title: result.child_title ? result.child_title.value : \"\",\n            child_level: result.child_level ? result.child_level.value : \"\",\n          }\n          return partInfo\n\n        });\n        dispatch(completeExpressionPartsFetch(parts));\n      });\n    }\n  }\n};\n\nexport var startQuotationExpressionTypeFetch = () => {\n  return{\n    type: \"START_QUOTATION_EXPRESSION_TYPE_FETCH\"\n  };\n};\nexport var completeQuotationExpressionTypeFetch = (quotationExpressionTypes) => {\n  return{\n    type: \"COMPLETE_QUOTATION_EXPRESSION_TYPE_FETCH\",\n    quotationExpressionTypes\n  };\n};\nexport var fetchQuotationExpressionTypes = () =>{\n  return (dispatch, getState) => {\n    var state = getState();\n    var query = [\n        \"SELECT ?quotationExpressionType ?quotationExpressionTypeTitle ?quotationExpressionTypeShortId \",\n        \"WHERE { \",\n        \"?quotationExpressionType a <http://scta.info/resource/expressionType> .\",\n        \"?quotationExpressionType <http://scta.info/property/shortId> ?quotationExpressionTypeShortId .\",\n        \"?quotationExpressionType <http://purl.org/dc/elements/1.1/title> ?quotationExpressionTypeTitle .\",\n        \"}\",\n        \"ORDER BY ?quotationExpressionTypeTitle\"].join('');\n\n  dispatch(startQuotationExpressionTypeFetch());\n  axios.get(sparqlEndpoint, {params: {\"query\" : query, \"output\": \"json\"}}).then(function(res){\n    var results = res.data.results.bindings;\n\n    var quotationExpressionTypes = results.map((result) => {\n      var quotationExpressionTypeInfo = {\n          quotationExpressionType: result.quotationExpressionType.value,\n          quotationExpressionTypeShortId: result.quotationExpressionTypeShortId.value,\n          quotationExpressionTypeTitle: result.quotationExpressionTypeTitle.value\n        }\n        return quotationExpressionTypeInfo\n      });\n      dispatch(completeQuotationExpressionTypeFetch(quotationExpressionTypes));\n    });\n  }\n};\n\n\nexport var startExpressionTypeFetch = () => {\n  return{\n    type: \"START_EXPRESSION_TYPE_FETCH\"\n  };\n};\nexport var completeExpressionTypeFetch = (expressionTypes) => {\n  return{\n    type: \"COMPLETE_EXPRESSION_TYPE_FETCH\",\n    expressionTypes\n  };\n};\nexport var fetchExpressionTypes = () =>{\n  return (dispatch, getState) => {\n    var state = getState();\n    var query = [\n        \"SELECT ?expressionType ?expressionTypeTitle ?expressionTypeShortId \",\n        \"WHERE { \",\n        \"?expressionType a <http://scta.info/resource/expressionType> .\",\n        \"?expressionType <http://scta.info/property/shortId> ?expressionTypeShortId .\",\n        \"?expressionType <http://purl.org/dc/elements/1.1/title> ?expressionTypeTitle .\",\n        \"}\",\n        \"ORDER BY ?expressionTypeTitle\"].join('');\n\n  dispatch(startExpressionTypeFetch());\n  axios.get(sparqlEndpoint, {params: {\"query\" : query, \"output\": \"json\"}}).then(function(res){\n    var results = res.data.results.bindings;\n    var expressionTypes = results.map((result) => {\n      var expressionTypeInfo = {\n          expressionType: result.expressionType.value,\n          expressionTypeShortId: result.expressionTypeShortId.value,\n          expressionTypeTitle: result.expressionTypeTitle.value\n        }\n        return expressionTypeInfo\n      });\n      dispatch(completeExpressionTypeFetch(expressionTypes));\n    });\n  }\n};\nexport var startWorkGroupsFetch = () => {\n  return{\n    type: \"START_WORK_GROUPS_FETCH\"\n  };\n};\nexport var completeWorkGroupsFetch = (workGroups) => {\n  return{\n    type: \"COMPLETE_WORK_GROUPS_FETCH\",\n    workGroups\n  };\n};\nexport var fetchWorkGroups = () =>{\n  return (dispatch, getState) => {\n    var state = getState();\n    var query = [\n        \"SELECT ?workGroup ?workGroupShortId ?workGroupTitle \",\n        \"WHERE { \",\n        \"?workGroup a <http://scta.info/resource/workGroup> .\",\n        \"?workGroup <http://scta.info/property/shortId> ?workGroupShortId .\",\n        \"?workGroup <http://purl.org/dc/elements/1.1/title> ?workGroupTitle .\",\n        \"}\",\n        \"ORDER BY ?workGroupTitle\"].join('');\n  dispatch(startWorkGroupsFetch());\n  axios.get(sparqlEndpoint, {params: {\"query\" : query, \"output\": \"json\"}}).then(function(res){\n    var results = res.data.results.bindings;\n    var workGroups = results.map((result) => {\n      var workGroupInfo = {\n          workGroup: result.workGroup.value,\n          workGroupShortId: result.workGroupShortId.value,\n          workGroupTitle: result.workGroupTitle.value\n        }\n        return workGroupInfo\n      });\n      dispatch(completeWorkGroupsFetch(workGroups));\n    });\n  }\n};\n// Author types fetch\n\nexport var startAuthorTypesFetch = () => {\n  return{\n    type: \"START_AUTHOR_TYPES_FETCH\"\n  };\n};\nexport var completeAuthorTypesFetch = (authorTypes) => {\n  return{\n    type: \"COMPLETE_AUTHOR_TYPES_FETCH\",\n    authorTypes\n  };\n};\nexport var fetchAuthorTypes = () =>{\n  return (dispatch, getState) => {\n    var state = getState();\n    var query = [\n      \"SELECT ?authorType ?authorTypeTitle ?authorTypeShortId \",\n      \"WHERE { \",\n      \"?authorType a <http://scta.info/resource/personType> .\",\n      \"?authorType <http://scta.info/property/shortId> ?authorTypeShortId .\",\n      \"?authorType <http://purl.org/dc/elements/1.1/title> ?authorTypeTitle .\",\n      \"}\",\n      \"ORDER BY ?authorTypeTitle\"].join('');\n  dispatch(startAuthorTypesFetch());\n  axios.get(sparqlEndpoint, {params: {\"query\" : query, \"output\": \"json\"}}).then(function(res){\n    var results = res.data.results.bindings;\n    var authorTypes = results.map((result) => {\n      var authorTypeInfo = {\n          authorType: result.authorType.value,\n          authorTypeShortId: result.authorTypeShortId.value,\n          authorTypeTitle: result.authorTypeTitle.value\n        }\n        return authorTypeInfo\n      });\n      dispatch(completeAuthorTypesFetch(authorTypes));\n    });\n  }\n};\n\n\n\n///Chart Actions\nexport var toggleGraphDisplay = (current) => {\n  return{\n    type: \"TOGGLE_GRAPH_DISPLAY\",\n    current\n  };\n}\nexport var startChartFetch = () => {\n  return{\n    type: \"START_CHART_FETCH\"\n  };\n};\nexport var completeChartFetch = (count) => {\n  return{\n    type: \"COMPLETE_CHART_FETCH\",\n    count\n  };\n};\nexport var fetchChart = () =>{\n  return (dispatch, getState) => {\n    var state = getState();\n    var level = parseInt(state.search.searchParameters.expressionLevel)\n    if (level === 1){\n      level = 2;\n    }\n    var searchText = state.search.searchParameters.searchText || \"\";\n\n    let expressionWorkGroupSparql = \"\";\n    if (state.search.searchParameters.workGroup){\n      const workGroup = state.search.searchParameters.workGroup;\n      expressionWorkGroupSparql = [\n        \"?ref <http://purl.org/dc/terms/isPartOf> <http://scta.info/resource/\" + workGroup + \">  . \"\n      ].join('');\n    }\n\n// BEGIN Expression author queries\n    let expressionAuthorTypeSparql = \"\"\n    if (state.search.searchParameters.expressionAuthorType){\n      expressionAuthorTypeSparql = \"?author <http://scta.info/property/personType> <http://scta.info/resource/\" + state.search.searchParameters.expressionAuthorType + \"> .\"\n    }\n\n    //Begin expression author date filter for expression author\n    let expressionAuthorDateSparql = \"\";\n    if (state.search.searchParameters.expressionAuthorDateAfter || state.search.searchParameters.expressionAuthorDateBefore){\n      expressionAuthorDateSparql = \"?author <http://scta.info/property/dateOfBirth> ?expressionAuthorDateOfBirth .\"\n    }\n    let expressionAuthorDateAfterSparqlFilter = \"\";\n    if (state.search.searchParameters.expressionAuthorDateAfter){\n      expressionAuthorDateAfterSparqlFilter = \"FILTER (?expressionAuthorDateOfBirth >= '\" + state.search.searchParameters.expressionAuthorDateAfter + \"').\"\n    }\n    let expressionAuthorDateBeforeSparqlFilter = \"\";\n    if (state.search.searchParameters.expressionAuthorDateBefore){\n        expressionAuthorDateBeforeSparqlFilter = \"FILTER (?expressionAuthorDateOfBirth <= '\" + state.search.searchParameters.expressionAuthorDateBefore + \"').\"\n    }\n    //END expression author date filter for expression author\n\n    var expressionAuthorSparql = \"\";\n    if (state.search.searchParameters.expressionAuthor){\n      expressionAuthorSparql = \"?ref <http://www.loc.gov/loc.terms/relators/AUT> <http://scta.info/resource/\" + state.search.searchParameters.expressionAuthor + \"> .\"\n    }\n\n    var expressionAuthorCoreSparql = [\n      \"?ref <http://www.loc.gov/loc.terms/relators/AUT> ?author . \",\n      expressionAuthorTypeSparql,\n      expressionAuthorDateSparql,\n      expressionAuthorSparql\n    ].join('');\n// End expression author queries\n\n//BEGIN Quotation Author Queries\n      var quotationAuthorTypeSparql = \"\";\n      if (state.search.searchParameters.quotationAuthorType){\n        var searchShortId = state.search.searchParameters.quotationAuthorType;\n        quotationAuthorTypeSparql = \"?quotationAuthor <http://scta.info/property/personType> <http://scta.info/resource/\" + searchShortId + \">  . \";\n      }\n\n      //Begin quotation author date filter for expression author\n      let quotationAuthorDateSparql = \"\";\n      if (state.search.searchParameters.quotationAuthorDateAfter || state.search.searchParameters.quotationAuthorDateBefore){\n        quotationAuthorDateSparql =\n            \"?quotationAuthor <http://scta.info/property/dateOfBirth> ?quotationAuthorDateOfBirth .\"\n      }\n      let quotationAuthorDateAfterSparqlFilter = \"\";\n      if (state.search.searchParameters.quotationAuthorDateAfter){\n        quotationAuthorDateAfterSparqlFilter = \"FILTER (?quotationAuthorDateOfBirth >= '\" + state.search.searchParameters.quotationAuthorDateAfter + \"').\"\n      }\n      let quotationAuthorDateBeforeSparqlFilter = \"\";\n      if (state.search.searchParameters.quotationAuthorDateBefore){\n          quotationAuthorDateBeforeSparqlFilter = \"FILTER (?quotationAuthorDateOfBirth <= '\" + state.search.searchParameters.quotationAuthorDateBefore + \"').\"\n      }\n      //END quotation author date filter for expression author\n\n      var quotationAuthorSparql = \"\";\n      if (state.search.searchParameters.quotationAuthor){\n        var searchShortId = (state.search.searchParameters.quotationAuthor);\n        quotationAuthorSparql = \"?source_toplevel_expression <http://www.loc.gov/loc.terms/relators/AUT> <http://scta.info/resource/\" + searchShortId + \">  . \"\n      }\n      var quotationAuthorCoreSparql = \"\"\n      if (state.search.searchParameters.quotationAuthorDateAfter\n        || state.search.searchParameters.quotationAuthorDateBefore\n        || state.search.searchParameters.quotationAuthor\n        || state.search.searchParameters.quotationAuthorType\n      ){\n        var quotationAuthorCoreSparql = [\n          \"{\",\n            \"?element <http://scta.info/property/isInstanceOf> ?isInstanceOf .\",\n            \"?isInstanceOf <http://scta.info/property/source> ?source .\",\n            \"?source <http://scta.info/property/isPartOfTopLevelExpression> ?source_toplevel_expression . \",\n            \"?source_toplevel_expression <http://www.loc.gov/loc.terms/relators/AUT> ?quotationAuthor . \",\n            quotationAuthorTypeSparql,\n            quotationAuthorDateSparql,\n            quotationAuthorSparql,\n          \"}\",\n          \"UNION\",\n          \"{\",\n            \"?element <http://scta.info/property/source> ?source .\",\n            \"?source <http://scta.info/property/isPartOfTopLevelExpression> ?source_toplevel_expression . \",\n            \"?source_toplevel_expression <http://www.loc.gov/loc.terms/relators/AUT> ?quotationAuthor . \",\n            quotationAuthorTypeSparql,\n            quotationAuthorDateSparql,\n            quotationAuthorSparql,\n          \"}\"\n        ].join('');\n      }\n\n// END Quotation Author Queries for Quotations List\n\n\n\n    var quotationWorkGroupSparql = \"\";\n    if (state.search.searchParameters.quotationWorkGroup){\n      var searchShortId = (state.search.searchParameters.quotationWorkGroup);\n      quotationWorkGroupSparql = [\n        \"{\",\n          \"?element <http://scta.info/property/isInstanceOf> ?isInstanceOf .\",\n          \"?isInstanceOf <http://scta.info/property/source> ?source .\",\n          \"?source <http://scta.info/property/isPartOfTopLevelExpression> ?source_toplevel_expression . \",\n          \"<http://scta.info/resource/\" + state.search.searchParameters.quotationWorkGroup + \"> <http://scta.info/property/hasExpression> ?source_toplevel_expression .\",\n        \"}\",\n        \"UNION\",\n        \"{\",\n          \"?element <http://scta.info/property/source> ?source .\",\n          \"?source <http://scta.info/property/isPartOfTopLevelExpression> ?source_toplevel_expression . \",\n          \"<http://scta.info/resource/\" + state.search.searchParameters.quotationWorkGroup + \"> <http://scta.info/property/hasExpression> ?source_toplevel_expression .\",\n        \"}\"\n      ].join('');\n    }\n\n\n    var quotationWorkSparql = \"\";\n    if (state.search.searchParameters.quotationWork || state.search.searchParameters.quotationWorkPart){\n      var searchShortId = (state.search.searchParameters.quotationWorkPart) ? state.search.searchParameters.quotationWorkPart : state.search.searchParameters.quotationWork\n      quotationWorkSparql = [\n      \"{\",\n        \"?element <http://scta.info/property/isInstanceOf> ?isInstanceOf .\",\n        \"{\",\n          \"\\n#check for quotation whose canonical source is a member of the search expression\\n\",\n          \"?isInstanceOf  <http://scta.info/property/source> ?source .\",\n          \"?source <http://scta.info/property/isMemberOf> <http://scta.info/resource/\" + searchShortId + \"> .\",\n        \"}\",\n        \"UNION\",\n        \"{\",\n          \"\\n#check for quotation whose canonical source is search expression\\n\",\n          \"?isInstanceOf  <http://scta.info/property/source> <http://scta.info/resource/\" + searchShortId + \"> .\",\n        \"}\",\n      \"}\",\n      \"UNION\",\n      \"{\",\n        \"\\n#check for quotation whose source is a member the search expression\\n\",\n        \"{\",\n          \"?element <http://scta.info/property/source> ?source .\",\n          \"?source <http://scta.info/property/isMemberOf> <http://scta.info/resource/\" + searchShortId + \"> .\",\n        \"}\",\n        \"UNION\",\n        \"\\n#check for quotation whose source is the search expression\\n\",\n        \"{\",\n          \"?element <http://scta.info/property/source> <http://scta.info/resource/\" + searchShortId + \"> .\",\n        \"}\",\n      \"}\"\n    ].join('');\n    }\n\n    //BEGIN condition for choosing ref quote or combo\n        var structureElementTypeSparql = \"\";\n        if (state.search.searchParameters.structureElementType === \"structureElementRef\"){\n          structureElementTypeSparql = [\n            \"{?element <http://scta.info/property/structureElementType> <http://scta.info/resource/structureElementRef> .}\",\n            \"MINUS\",\n            \"{?element <http://scta.info/property/isReferenceTo> ?isReferenceTo . }\",\n            ].join('');\n        }\n        else if (state.search.searchParameters.structureElementType === \"structureElementRefDup\"){\n          structureElementTypeSparql = \"?element <http://scta.info/property/structureElementType> <http://scta.info/resource/structureElementRef> .\"\n        }\n        else if (state.search.searchParameters.structureElementType === \"structureElementQuote\"){\n          structureElementTypeSparql = \"?element <http://scta.info/property/structureElementType> <http://scta.info/resource/structureElementQuote> .\"\n        }\n        else if (state.search.searchParameters.structureElementType === \"allDup\"){\n          structureElementTypeSparql = [\n            \"{?element <http://scta.info/property/structureElementType> <http://scta.info/resource/structureElementQuote> .}\",\n            \"UNION\",\n            \"{?element <http://scta.info/property/structureElementType> <http://scta.info/resource/structureElementRef> . }\"\n          ].join('');\n        }\n        else{\n          structureElementTypeSparql = [\n            \"{?element <http://scta.info/property/structureElementType> <http://scta.info/resource/structureElementQuote> .}\",\n            \"UNION\",\n            \"{{?element <http://scta.info/property/structureElementType> <http://scta.info/resource/structureElementRef> .}\",\n            \"MINUS\",\n            \"{?element <http://scta.info/property/isReferenceTo> ?isReferenceTo . }\",\n\n            \"}\"\n          ].join('');\n        }\n    //END condition for choosing ref quote or combo\n\n\n\n    //var expressionId = state.search.searchParameters.expressionPart ? state.search.searchParameters.expressionPart : state.search.searchParameters.expressionId\n    if (state.search.searchParameters.expressionId){\n      // query for quote frequency within a given expression\n      var expressionId = state.search.searchParameters.expressionId\n      var query = [\n        \"SELECT ?ref ?reftitle ?totalOrderNumber (count(?element) as ?count) \",\n        \"WHERE {\",\n        \"?ref a <http://scta.info/resource/expression> .\",\n        \"?ref <http://scta.info/property/isMemberOf> <http://scta.info/resource/\" + expressionId + \"> .\",\n        \"?ref <http://scta.info/property/level> '\" + level + \"' .\",\n        \"?ref <http://purl.org/dc/elements/1.1/title> ?reftitle .\",\n        \"OPTIONAL {\",\n        \"?ref <http://scta.info/property/totalOrderNumber> ?totalOrderNumber .\",\n        \"}\",\n        \"OPTIONAL {\",\n        \"?element <http://scta.info/property/isMemberOf> ?ref .\",\n        //\"?element <http://scta.info/property/structureElementType> <http://scta.info/resource/structureElementQuote> .\",\n        structureElementTypeSparql,\n        \"?element <http://scta.info/property/structureElementText> ?quotation_text .\",\n        quotationAuthorCoreSparql,\n        quotationWorkGroupSparql,\n        quotationWorkSparql,\n        \"}\",\n        quotationAuthorDateBeforeSparqlFilter,\n        quotationAuthorDateAfterSparqlFilter,\n        \"FILTER (REGEX(STR(?quotation_text), '\" + searchText + \"', 'i')) .\",\n        \"}\",\n        \"group by ?ref ?reftitle ?totalOrderNumber \",\n        \"ORDER BY ?totalOrderNumber \"\n      ].join('');\n    }\n    else {\n      // query for quote frequency across top level expressions\n      var query = [\n        \"SELECT ?ref ?reftitle ?totalOrderNumber (count(?element) as ?count) \",\n        \"WHERE {\",\n        \"?ref a <http://scta.info/resource/expression> .\",\n        \"?ref <http://scta.info/property/level> '1' .\",\n        expressionWorkGroupSparql,\n        expressionAuthorCoreSparql,\n        \"?ref <http://purl.org/dc/elements/1.1/title> ?reftitle .\",\n        \"OPTIONAL {\",\n        \"?ref <http://scta.info/property/totalOrderNumber> ?totalOrderNumber .\",\n        \"}\",\n        \"OPTIONAL {\",\n        \"?element <http://scta.info/property/isMemberOf> ?ref .\",\n        //\"?element <http://scta.info/property/structureElementType> <http://scta.info/resource/structureElementQuote> .\",\n        structureElementTypeSparql,\n        \"?element <http://scta.info/property/structureElementText> ?quotation_text .\",\n        quotationAuthorCoreSparql,\n        quotationWorkGroupSparql,\n        quotationWorkSparql,\n        \"}\",\n        quotationAuthorDateBeforeSparqlFilter,\n        quotationAuthorDateAfterSparqlFilter,\n        expressionAuthorDateBeforeSparqlFilter,\n        expressionAuthorDateAfterSparqlFilter,\n        \"FILTER (REGEX(STR(?quotation_text), '\" + searchText + \"', 'i')) .\",\n        \"}\",\n        \"group by ?ref ?reftitle ?totalOrderNumber \",\n        \"ORDER BY ?totalOrderNumber \"\n      ].join('');\n    }\n\n  dispatch(startChartFetch());\n  axios.get(sparqlEndpoint, {params: {\"query\" : query, \"output\": \"json\"}}).then(function(res){\n    var results = res.data.results.bindings;\n    var count = results.map((result) => {\n        return {\n          \"item\": result.ref ? result.ref.value : \"\",\n          \"title\": result.reftitle ? result.reftitle.value : \"\",\n          \"count\": result.count ? result.count.value : \"\"\n        }\n      });\n      dispatch(completeChartFetch(count));\n    });\n  }\n};\n\n///Chart Actions\nexport var toggleImagesDisplay = (current) => {\n  return{\n    type: \"TOGGLE_IMAGES_DISPLAY\",\n    current\n  };\n}\nexport var startImagesFetch = () => {\n  return{\n    type: \"START_IMAGES_FETCH\"\n  };\n};\nexport var completeImagesFetch = (images) => {\n  return{\n    type: \"COMPLETE_IMAGES_FETCH\",\n    images\n  };\n};\nexport var fetchImages = () =>{\n  return (dispatch, getState) => {\n    var state = getState();\n    var manifestation_id = state.paragraph.manifestation_id\n    var query = [\n      \"SELECT ?url \",\n      \"WHERE { \",\n      \"<\" + manifestation_id + \"> <http://scta.info/property/isOnSurface> ?surface .\",\n      \"?surface <http://scta.info/property/hasISurface> ?isurface .\",\n      \"?isurface <http://scta.info/property/hasCanvas> ?canvas .\",\n      \"?canvas <http://iiif.io/api/presentation/2#hasImageAnnotations> ?anno .\",\n      \"?canvas <http://iiif.io/api/presentation/2#hasImageAnnotations> ?anno .\",\n      \"?anno <http://www.w3.org/1999/02/22-rdf-syntax-ns#first> ?imgres .\",\n      \"?imgres <http://www.w3.org/ns/oa#hasBody> ?body .\",\n      \"?body <http://rdfs.org/sioc/services#has_service> ?url .\",\n      \"}\"\n    ].join('');\n\n  dispatch(startImagesFetch());\n  axios.get(sparqlEndpoint, {params: {\"query\" : query, \"output\": \"json\"}}).then(function(res){\n    var results = res.data.results.bindings;\n    var images = results.map((result) => {\n        return {\n          \"url\": result.url.value,\n        }\n      });\n      dispatch(completeImagesFetch(images));\n    });\n  }\n};\n\n\n// Quotation Actions\n// ==================\nexport var addQuotations = (quotations) => {\n  return{\n    type: \"ADD_QUOTATIONS\",\n    quotations\n  };\n};\nexport var clearQuotations = () => {\n  return{\n    type: \"CLEAR_QUOTATIONS\"\n  };\n};\nexport var startQuotationsFetch = () => {\n  return{\n    type: \"START_QUOTATIONS_FETCH\"\n  };\n};\nexport var clearQuotationsFocus = () => {\n  return{\n    type: \"CLEAR_QUOTATIONS_FOCUS\"\n  };\n};\nexport var completeQuotationsFetch = (quotations) => {\n  return{\n    type: \"COMPLETE_QUOTATIONS_FETCH\",\n    quotations\n  };\n};\nexport var fetchQuotations = () =>{\n  return (dispatch, getState) => {\n    var state = getState();\n    var searchText = state.search.searchParameters.searchText || \"\";\n    var expressionIdSparql = \"\";\n    if (state.search.searchParameters.expressionId || state.search.searchParameters.expressionPart){\n      var searchShortId = (state.search.searchParameters.expressionPart) ? state.search.searchParameters.expressionPart : state.search.searchParameters.expressionId\n      var expressionIdSparql = [\n      \"?quotation <http://scta.info/property/isMemberOf> <http://scta.info/resource/\" + searchShortId + \"> .\"\n      ].join('');\n\n    }\n// BEGIN Expression author queries\n    let expressionAuthorTypeSparql = \"\"\n    if (state.search.searchParameters.expressionAuthorType){\n      expressionAuthorTypeSparql = \"?author <http://scta.info/property/personType> <http://scta.info/resource/\" + state.search.searchParameters.expressionAuthorType + \"> .\"\n    }\n\n    //Begin expression author date filter for expression author\n    let expressionAuthorDateSparql = \"\";\n    if (state.search.searchParameters.expressionAuthorDateAfter || state.search.searchParameters.expressionAuthorDateBefore){\n      expressionAuthorDateSparql = \"?author <http://scta.info/property/dateOfBirth> ?dateOfBirth .\"\n    }\n    let expressionAuthorDateAfterSparqlFilter = \"\";\n    if (state.search.searchParameters.expressionAuthorDateAfter){\n      expressionAuthorDateAfterSparqlFilter = \"FILTER (?dateOfBirth >= '\" + state.search.searchParameters.expressionAuthorDateAfter + \"').\"\n    }\n    let expressionAuthorDateBeforeSparqlFilter = \"\";\n    if (state.search.searchParameters.expressionAuthorDateBefore){\n        expressionAuthorDateBeforeSparqlFilter = \"FILTER (?dateOfBirth <= '\" + state.search.searchParameters.expressionAuthorDateBefore + \"').\"\n    }\n    //END expression author date filter for expression author\n\n    var authorSparql = \"\";\n    if (state.search.searchParameters.expressionAuthor){\n      authorSparql = \"?toplevel_expression <http://www.loc.gov/loc.terms/relators/AUT> <http://scta.info/resource/\" + state.search.searchParameters.expressionAuthor + \"> .\"\n    }\n\n    var expressionAuthorCoreSparql = [\n      \"?toplevel_expression <http://www.loc.gov/loc.terms/relators/AUT> ?author . \",\n      expressionAuthorTypeSparql,\n      expressionAuthorDateSparql,\n      authorSparql,\n      \"?author <http://purl.org/dc/elements/1.1/title> ?author_title . \"\n      ].join('');\n// End expression author queries\n\n\n//BEGIN Quotation Author Queries\n    var quotationAuthorTypeSparql = \"\";\n    if (state.search.searchParameters.quotationAuthorType){\n      var searchShortId = state.search.searchParameters.quotationAuthorType;\n      quotationAuthorTypeSparql = \"?quotationAuthor <http://scta.info/property/personType> <http://scta.info/resource/\" + searchShortId + \">  . \";\n    }\n\n    //Begin quotation author date filter for expression author\n    let quotationAuthorDateSparql = \"\";\n    if (state.search.searchParameters.quotationAuthorDateAfter || state.search.searchParameters.quotationAuthorDateBefore){\n      quotationAuthorDateSparql =\n          \"?quotationAuthor <http://scta.info/property/dateOfBirth> ?quotationAuthorDateOfBirth .\"\n    }\n    let quotationAuthorDateAfterSparqlFilter = \"\";\n    if (state.search.searchParameters.quotationAuthorDateAfter){\n      quotationAuthorDateAfterSparqlFilter = \"FILTER (?quotationAuthorDateOfBirth >= '\" + state.search.searchParameters.quotationAuthorDateAfter + \"').\"\n    }\n    let quotationAuthorDateBeforeSparqlFilter = \"\";\n    if (state.search.searchParameters.quotationAuthorDateBefore){\n        quotationAuthorDateBeforeSparqlFilter = \"FILTER (?quotationAuthorDateOfBirth <= '\" + state.search.searchParameters.quotationAuthorDateBefore + \"').\"\n    }\n    //END quotation author date filter for expression author\n\n    var quotationAuthorSparql = \"\";\n    if (state.search.searchParameters.quotationAuthor){\n      var searchShortId = (state.search.searchParameters.quotationAuthor);\n      quotationAuthorSparql = \"?source_toplevel_expression <http://www.loc.gov/loc.terms/relators/AUT> <http://scta.info/resource/\" + searchShortId + \">  . \"\n    }\n    var quotationAuthorCoreSparql = \"\"\n    if (state.search.searchParameters.quotationAuthorDateAfter\n      || state.search.searchParameters.quotationAuthorDateBefore\n      || state.search.searchParameters.quotationAuthor\n      || state.search.searchParameters.quotationAuthorType\n    ){\n    var quotationAuthorCoreSparql = [\n      \"{\",\n        \"?quotation <http://scta.info/property/isInstanceOf> ?isInstanceOf .\",\n        \"?isInstanceOf <http://scta.info/property/source> ?source .\",\n        \"?source <http://scta.info/property/isPartOfTopLevelExpression> ?source_toplevel_expression . \",\n        \"?source_toplevel_expression <http://www.loc.gov/loc.terms/relators/AUT> ?quotationAuthor . \",\n        quotationAuthorTypeSparql,\n        quotationAuthorDateSparql,\n        quotationAuthorSparql,\n      \"}\",\n      \"UNION\",\n      \"{\",\n        \"?quotation <http://scta.info/property/source> ?source .\",\n        \"?source <http://scta.info/property/isPartOfTopLevelExpression> ?source_toplevel_expression . \",\n        \"?source_toplevel_expression <http://www.loc.gov/loc.terms/relators/AUT> ?quotationAuthor . \",\n        quotationAuthorTypeSparql,\n        quotationAuthorDateSparql,\n        quotationAuthorSparql,\n      \"}\"\n    ].join('');\n    }\n\n// END Quotation Author Queries for Quotations List\n\n    var quotationWorkGroupSparql = \"\";\n    if (state.search.searchParameters.quotationWorkGroup){\n      var searchShortId = (state.search.searchParameters.quotationWorkGroup);\n      quotationWorkGroupSparql = [\n        \"{\",\n          \"?quotation <http://scta.info/property/isInstanceOf> ?isInstanceOf .\",\n          \"?isInstanceOf <http://scta.info/property/source> ?source .\",\n          \"?source <http://scta.info/property/isPartOfTopLevelExpression> ?source_toplevel_expression . \",\n          \"<http://scta.info/resource/\" + state.search.searchParameters.quotationWorkGroup + \"> <http://scta.info/property/hasExpression> ?source_toplevel_expression .\",\n        \"}\",\n        \"UNION\",\n        \"{\",\n          \"?quotation <http://scta.info/property/source> ?source .\",\n          \"?source <http://scta.info/property/isPartOfTopLevelExpression> ?source_toplevel_expression . \",\n          \"<http://scta.info/resource/\" + state.search.searchParameters.quotationWorkGroup + \"> <http://scta.info/property/hasExpression> ?source_toplevel_expression .\",\n        \"}\"\n      ].join('');\n    }\n\n\n    //NEW QUERY\n    var quotationWorkSparql = \"\";\n    if (state.search.searchParameters.quotationWork || state.search.searchParameters.quotationWorkPart){\n      var searchShortId = (state.search.searchParameters.quotationWorkPart) ? state.search.searchParameters.quotationWorkPart : state.search.searchParameters.quotationWork\n      quotationWorkSparql = [\n      \"{\",\n        \"?quotation <http://scta.info/property/isInstanceOf> ?isInstanceOf .\",\n        \"{\",\n          \"\\n#check for quotation whose canonical source is a member of the search expression\\n\",\n          \"?isInstanceOf  <http://scta.info/property/source> ?source .\",\n          \"?source <http://scta.info/property/isMemberOf> <http://scta.info/resource/\" + searchShortId + \"> .\",\n        \"}\",\n        \"UNION\",\n        \"{\",\n          \"\\n#check for quotation whose canonical source is search expression\\n\",\n          \"?isInstanceOf  <http://scta.info/property/source> <http://scta.info/resource/\" + searchShortId + \"> .\",\n        \"}\",\n      \"}\",\n      \"UNION\",\n      \"{\",\n        \"\\n#check for quotation whose source is a member the search expression\\n\",\n        \"{\",\n          \"?quotation <http://scta.info/property/source> ?source .\",\n          \"?source <http://scta.info/property/isMemberOf> <http://scta.info/resource/\" + searchShortId + \"> .\",\n        \"}\",\n        \"UNION\",\n        \"\\n#check for quotation whose source is the search expression\\n\",\n        \"{\",\n          \"?quotation <http://scta.info/property/source> <http://scta.info/resource/\" + searchShortId + \"> .\",\n        \"}\",\n      \"}\"\n    ].join('');\n    }\n\n    //NEW QUERY\n    let quotationExpressionTypeSparql = \"\";\n    if (state.search.searchParameters.quotationExpressionType){\n      const quotationExpressionTypeShortId = state.search.searchParameters.quotationExpressionType;\n      quotationExpressionTypeSparql = [\n      \"{\",\n        \"?quotation <http://scta.info/property/isInstanceOf> ?isInstanceOf .\",\n        \"{\",\n          \"\\n#check for quotation whose canonical source is a member an expression with the designated type\\n\",\n          \"?isInstanceOf  <http://scta.info/property/source> ?source .\",\n          \"?source <http://scta.info/property/isMemberOf> ?memberOf .\",\n          \"?memberOf <http://scta.info/property/expressionType> <http://scta.info/resource/\" + quotationExpressionTypeShortId + \"> .\",\n        \"}\",\n        \"UNION\",\n        \"{\",\n          \"\\n#check for quotation whose canonical source is has designated type\\n\",\n          \"?isInstanceOf  <http://scta.info/property/source> ?source .\",\n          \"?source <http://scta.info/property/expressionType> <http://scta.info/resource/\" + quotationExpressionTypeShortId + \"> .\",\n        \"}\",\n      \"}\",\n      \"UNION\",\n      \"{\",\n        \"\\n#check for quotation whose source is a member the search expression\\n\",\n        \"{\",\n          \"?quotation <http://scta.info/property/source> ?source .\",\n          \"?source <http://scta.info/property/isMemberOf> ?memberOf .\",\n          \"?memberOf <http://scta.info/property/expressionType> <http://scta.info/resource/\" + quotationExpressionTypeShortId + \"> .\",\n        \"}\",\n        \"UNION\",\n        \"\\n#check for quotation whose source is the search expression\\n\",\n        \"{\",\n          \"?quotation <http://scta.info/property/source> ?source .\",\n          \"?source <http://scta.info/property/expressionType> <http://scta.info/resource/\" + quotationExpressionTypeShortId + \"> .\",\n        \"}\",\n      \"}\"\n    ].join('');\n    }\n\n    var workGroupSparql = \"\";\n    if (state.search.searchParameters.workGroup){\n      workGroupSparql = [\n      \"<http://scta.info/resource/\" + state.search.searchParameters.workGroup + \"> <http://scta.info/property/hasExpression> ?toplevel_expression .\",\n      ].join('');\n    }\n\n    var expressionTypeSparql = \"\";\n    if (state.search.searchParameters.expressionType){\n      expressionTypeSparql = [\n        \"?quotation <http://scta.info/property/isMemberOf> ?expressionIsmemberOf .\",\n        \"?expressionIsmemberOf <http://scta.info/property/expressionType> <http://scta.info/resource/\" + state.search.searchParameters.expressionType + \"> .\",\n      ].join('');\n    }\n//BEGIN condition for choosing ref quote or combo\n    var structureElementTypeSparql = \"\";\n    if (state.search.searchParameters.structureElementType === \"structureElementRef\"){\n      structureElementTypeSparql = [\n        \"{?quotation <http://scta.info/property/structureElementType> <http://scta.info/resource/structureElementRef> .}\",\n        \"MINUS\",\n        \"{?quotation <http://scta.info/property/isReferenceTo> ?isReferenceTo . }\",\n        ].join('');\n    }\n    else if (state.search.searchParameters.structureElementType === \"structureElementRefDup\"){\n      structureElementTypeSparql = \"?quotation <http://scta.info/property/structureElementType> <http://scta.info/resource/structureElementRef> .\"\n    }\n    else if (state.search.searchParameters.structureElementType === \"structureElementQuote\"){\n      structureElementTypeSparql = \"?quotation <http://scta.info/property/structureElementType> <http://scta.info/resource/structureElementQuote> .\"\n    }\n    else if (state.search.searchParameters.structureElementType === \"allDup\"){\n      structureElementTypeSparql = [\n        \"{?quotation <http://scta.info/property/structureElementType> <http://scta.info/resource/structureElementQuote> .}\",\n        \"UNION\",\n        \"{?quotation <http://scta.info/property/structureElementType> <http://scta.info/resource/structureElementRef> . }\"\n      ].join('');\n    }\n    else{\n      structureElementTypeSparql = [\n        \"{?quotation <http://scta.info/property/structureElementType> <http://scta.info/resource/structureElementQuote> .}\",\n        \"UNION\",\n        \"{{?quotation <http://scta.info/property/structureElementType> <http://scta.info/resource/structureElementRef> .}\",\n        \"MINUS\",\n        \"{?quotation <http://scta.info/property/isReferenceTo> ?isReferenceTo . }\",\n\n        \"}\"\n      ].join('');\n    }\n//END condition for choosing ref quote or combo\n    var query = \"\"\n    if (state.canonicalQuotation){\n      var canonicalQuotationId = state.canonicalQuotation.id;\n      var query = [\n            \"SELECT ?quotation ?isInstanceOf ?quotation_text ?toplevel_expression_title ?author_title ?citation ?ref ?refText \",\n            \"WHERE {\",\n            \"<\" + canonicalQuotationId + \"> <http://scta.info/property/hasInstance> ?quotation .\",\n            \"OPTIONAL {\",\n            \"?quotation <http://scta.info/property/isInstanceOf> ?isInstanceOf .\",\n            \"}\",\n            \"OPTIONAL {\",\n            \"?quotation <http://scta.info/property/source> ?source .\",\n            \"}\",\n            expressionIdSparql,\n            quotationAuthorCoreSparql,\n            quotationWorkGroupSparql,\n            quotationWorkSparql,\n            quotationExpressionTypeSparql,\n            \"?quotation <http://scta.info/property/structureElementText> ?quotation_text .\",\n            //\"?quotation <http://scta.info/property/structureElementText> ?quotation_text .\",\n            \"?quotation <http://scta.info/property/isPartOfTopLevelExpression> ?toplevel_expression . \",\n            expressionTypeSparql,\n            workGroupSparql,\n            \"?toplevel_expression <http://purl.org/dc/elements/1.1/title> ?toplevel_expression_title . \",\n            expressionAuthorCoreSparql,\n            \"OPTIONAL {\",\n              \"?quotation <http://scta.info/property/citation> ?citation . \",\n            \"}\",\n            \"OPTIONAL {\",\n              \"?ref <http://scta.info/property/isReferenceTo> ?quotation . \",\n              \"?ref <http://scta.info/property/structureElementText> ?refText . \",\n            \"}\",\n            expressionAuthorDateAfterSparqlFilter,\n            expressionAuthorDateBeforeSparqlFilter,\n            quotationAuthorDateAfterSparqlFilter,\n            quotationAuthorDateBeforeSparqlFilter,\n            \"}\",\n            \"LIMIT 100\"\n          ].join('');\n    }\n    else{\n      var query = [\n          \"SELECT ?quotation ?source ?isInstanceOf ?quotation_text ?toplevel_expression_title ?author_title ?citation ?ref ?refText ?refType \",\n          \"WHERE {\",\n          structureElementTypeSparql,\n          \"?quotation <http://scta.info/property/structureElementType> ?refType . \",\n          \"?quotation a <http://scta.info/resource/expression> .\",\n          \"OPTIONAL {\",\n          \"?quotation <http://scta.info/property/isInstanceOf> ?isInstanceOf .\",\n          \"}\",\n          \"OPTIONAL {\",\n          \"?quotation <http://scta.info/property/source> ?source .\",\n          \"}\",\n          expressionIdSparql,\n          quotationAuthorCoreSparql,\n          quotationWorkGroupSparql,\n          quotationWorkSparql,\n          quotationExpressionTypeSparql,\n          \"?quotation <http://scta.info/property/structureElementText> ?quotation_text .\",\n          \"?quotation <http://scta.info/property/isPartOfTopLevelExpression> ?toplevel_expression . \",\n          expressionTypeSparql,\n          workGroupSparql,\n          authorSparql,\n          \"?toplevel_expression <http://purl.org/dc/elements/1.1/title> ?toplevel_expression_title . \",\n          expressionAuthorCoreSparql,\n          \"OPTIONAL {\",\n            \"?quotation <http://scta.info/property/citation> ?citation . \",\n          \"}\",\n          \"OPTIONAL {\",\n            \"?ref <http://scta.info/property/isReferenceTo> ?quotation . \",\n            \"?ref <http://scta.info/property/structureElementText> ?refText . \",\n          \"}\",\n          expressionAuthorDateAfterSparqlFilter,\n          expressionAuthorDateBeforeSparqlFilter,\n          quotationAuthorDateAfterSparqlFilter,\n          quotationAuthorDateBeforeSparqlFilter,\n          \"FILTER (REGEX(STR(?quotation_text), '\" + searchText + \"', 'i')) .\",\n          \"}\",\n          \"ORDER BY ?quotation_text \",\n          \"LIMIT 100\"\n        ].join('');\n      }\n    dispatch(startQuotationsFetch());\n    axios.get(sparqlEndpoint, {params: {\"query\" : query, \"output\": \"json\"}}).then(function(res){\n      var results = res.data.results.bindings\n\n      dispatch(completeQuotationsFetch(results));\n    });\n  };\n}\n\n// Focused Quotation actions\nexport var changeQuotationsFocus = (id) => {\n  return{\n    type: \"CHANGE_QUOTATIONS_FOCUS\",\n    id\n  }\n}\n\nexport var clearFocusedQuotation = () => {\n  return{\n    type: \"CLEAR_FOCUSED_QUOTATION\"\n  }\n}\n\nexport var createFocusedQuotation = (quotation) => {\n  return{\n    type: \"CREATE_FOCUSED_QUOTATION\",\n    quotation\n  };\n};\n\n// Canonical Quotation\nexport var createCanonicalQuotation = (quotation) => {\n  return{\n    type: \"CREATE_CANONICAL_QUOTATION\",\n    quotation\n  };\n};\nexport var clearCanonicalQuotation = () => {\n  return{\n    type: \"CLEAR_CANONICAL_QUOTATION\"\n  };\n};\n\n\n// CanonicalQuotations (plural) Actions\nexport var changeCanonicalQuotationsFocus = (id) => {\n  return{\n    type: \"CHANGE_CANONICAL_QUOTATIONS_FOCUS\",\n    id\n  }\n}\nexport var clearCanonicalQuotationsFocus = () =>{\n  return{\n    type: \"CLEAR_CANONICAL_QUOTATIONS_FOCUS\",\n  }\n}\nexport var clearCanonicalQuotations = () => {\n  return{\n    type: \"CLEAR_CANONICAL_QUOTATIONS\"\n  };\n};\nexport var startCanonicalQuotationsFetch = () => {\n  return{\n    type: \"START_CANONICAL_QUOTATIONS_FETCH\"\n  };\n};\nexport var completeCanonicalQuotationsFetch = (canonicalQuotations) => {\n  return{\n    type: \"COMPLETE_CANONICAL_QUOTATIONS_FETCH\",\n    canonicalQuotations\n  };\n};\nexport var fetchCanonicalQuotations = () =>{\n  return (dispatch, getState) => {\n    var state = getState();\n    var searchText = state.search.searchParameters.searchText || \"\";\n\n\n    var quotationInstanceSparql = \"\"\n    if (state.search.searchParameters.expressionId || state.search.searchParameters.expressionAuthor || state.search.searchParameters.workGroup){\n      quotationInstanceSparql = [\n      \"?quotation <http://scta.info/property/hasInstance> ?quotationInstance .\",\n      ].join('');\n    }\n    var topLevelExpressionSparql = \"\"\n    if (state.search.searchParameters.expressionAuthor || state.search.searchParameters.workGroup){\n      topLevelExpressionSparql = [\n      \"?quotationInstance <http://scta.info/property/isPartOfTopLevelExpression> ?toplevel_expression .\",\n      ].join('');\n    }\n\n    // var quotationTypeSparql = \"\"\n    // if (state.search.searchParameters.quotationType){\n    //   var quotationTypeSparql = \"?quotation <http://scta.info/property/quotationType>\t<http://scta.info/resource/\" + state.search.searchParameters.quotationType + \"> .\"\n    // }\n    var expressionIdSparql = \"\";\n    if (state.search.searchParameters.expressionId || state.search.searchParameters.expressionPart){\n      var searchShortId = (state.search.searchParameters.expressionPart) ? state.search.searchParameters.expressionPart : state.search.searchParameters.expressionId\n      var expressionIdSparql = [\n      \"?quotationInstance <http://scta.info/property/isMemberOf> <http://scta.info/resource/\" + searchShortId + \"> .\",\n      ].join('');\n    }\n\n//END Expression author sparql for canonical quotations\n    let expressionAuthorTypeSparql = \"\";\n    if (state.search.searchParameters.expressionAuthorType){\n      expressionAuthorTypeSparql = \"?expressionAuthor <http://scta.info/property/personType> <http://scta.info/resource/\" + state.search.searchParameters.expressionAuthorType + \">  . \"\n    }\n    //Begin expression author date filter for expression author\n    let expressionAuthorDateSparql = \"\";\n    if (state.search.searchParameters.expressionAuthorDateAfter || state.search.searchParameters.expressionAuthorDateBefore){\n      expressionAuthorDateSparql =\n          \"?expressionAuthor <http://scta.info/property/dateOfBirth> ?expressionAuthorDateOfBirth .\"\n    }\n    let expressionAuthorDateAfterSparqlFilter = \"\";\n    if (state.search.searchParameters.expressionAuthorDateAfter){\n      expressionAuthorDateAfterSparqlFilter = \"FILTER (?expressionAuthorDateOfBirth >= '\" + state.search.searchParameters.expressionAuthorDateAfter + \"').\"\n    }\n    let expressionAuthorDateBeforeSparqlFilter = \"\";\n    if (state.search.searchParameters.expressionAuthorDateBefore){\n        expressionAuthorDateBeforeSparqlFilter = \"FILTER (?expressionAuthorDateOfBirth <= '\" + state.search.searchParameters.expressionAuthorDateBefore + \"').\"\n    }\n    //END expression author date filter for expression author\n\n    var authorSparql = \"\";\n    if (state.search.searchParameters.expressionAuthor){\n      authorSparql = \"?toplevel_expression <http://www.loc.gov/loc.terms/relators/AUT> <http://scta.info/resource/\" + state.search.searchParameters.expressionAuthor + \"> .\"\n    }\n\n    var expressionAuthorCoreSparql = [\n      \"?quotation <http://scta.info/property/hasInstance> ?quotationInstance .\",\n      \"?quotationInstance <http://scta.info/property/isPartOfTopLevelExpression> ?toplevel_expression .\",\n      \"?toplevel_expression <http://www.loc.gov/loc.terms/relators/AUT> ?expressionAuthor . \",\n      expressionAuthorTypeSparql,\n      expressionAuthorDateSparql,\n      authorSparql\n    ].join('');\n\n//END Expression author sparql for canonical quotations\n\n//BEGIN Quotation author sparql for canonical quotations\n    let quotationAuthorTypeSparql = \"\";\n    if (state.search.searchParameters.quotationAuthorType){\n      const searchShortId = state.search.searchParameters.quotationAuthorType;\n      quotationAuthorTypeSparql = \"?quotationAuthor <http://scta.info/property/personType> <http://scta.info/resource/\" + searchShortId + \">  . \"\n    }\n    //Begin quotation author date filter for expression author\n    let quotationAuthorDateSparql = \"\";\n    if (state.search.searchParameters.quotationAuthorDateAfter || state.search.searchParameters.quotationAuthorDateBefore){\n      quotationAuthorDateSparql =\n          \"?quotationAuthor <http://scta.info/property/dateOfBirth> ?quotationAuthorDateOfBirth .\"\n    }\n    let quotationAuthorDateAfterSparqlFilter = \"\";\n    if (state.search.searchParameters.quotationAuthorDateAfter){\n      quotationAuthorDateAfterSparqlFilter = \"FILTER (?quotationAuthorDateOfBirth >= '\" + state.search.searchParameters.quotationAuthorDateAfter + \"').\"\n    }\n    let quotationAuthorDateBeforeSparqlFilter = \"\";\n    if (state.search.searchParameters.quotationAuthorDateBefore){\n        quotationAuthorDateBeforeSparqlFilter = \"FILTER (?quotationAuthorDateOfBirth <= '\" + state.search.searchParameters.quotationAuthorDateBefore + \"').\"\n    }\n    //END quotation author date filter for expression author\n    var quotationAuthorSparql = \"\";\n    if (state.search.searchParameters.quotationAuthor){\n      var searchShortId = (state.search.searchParameters.quotationAuthor);\n      quotationAuthorSparql = \"?source_toplevel_expression <http://www.loc.gov/loc.terms/relators/AUT> <http://scta.info/resource/\" + searchShortId + \">  . \"\n    }\n    var quotationAuthorCoreSparql = [\n      \"?quotation <http://scta.info/property/source> ?source .\",\n      \"?source <http://scta.info/property/isPartOfTopLevelExpression> ?source_toplevel_expression . \",\n      \"?source_toplevel_expression <http://www.loc.gov/loc.terms/relators/AUT> ?quotationAuthor .\",\n      quotationAuthorTypeSparql,\n      quotationAuthorDateSparql,\n      quotationAuthorSparql\n    ].join('');\n\n//END Quotation author sparql for canonical quotations\n\n    var quotationWorkGroupSparql = \"\";\n    if (state.search.searchParameters.quotationWorkGroup){\n      var searchShortId = (state.search.searchParameters.quotationWorkGroup);\n      quotationWorkGroupSparql = [\n        \"?quotation <http://scta.info/property/source> ?source .\",\n        \"?source <http://scta.info/property/isPartOfTopLevelExpression> ?source_toplevel_expression . \",\n        \"<http://scta.info/resource/\" + state.search.searchParameters.quotationWorkGroup + \"> <http://scta.info/property/hasExpression> ?source_toplevel_expression .\",\n      ].join('');\n    }\n\n    var quotationWorkSparql = \"\";\n    if (state.search.searchParameters.quotationWork || state.search.searchParameters.quotationWorkPart){\n      var searchShortId = (state.search.searchParameters.quotationWorkPart) ? state.search.searchParameters.quotationWorkPart : state.search.searchParameters.quotationWork\n\n\n    quotationWorkSparql = [\n      \"{\",\n        \"\\n#check for canonical quotation whose source is memberOf the search expression\\n\",\n        \"?quotation <http://scta.info/property/source> ?source .\",\n        \"?source <http://scta.info/property/isMemberOf> <http://scta.info/resource/\" + searchShortId + \"> . \",\n      \"}\",\n      \"UNION\",\n      \"\\n#check for canonical quotation whose source IS the search expression\\n\",\n      \"{\",\n        \"?quotation <http://scta.info/property/source> <http://scta.info/resource/\" + searchShortId + \"> .\",\n      \"}\"\n      ].join('');\n    }\n\n    let quotationExpressionTypeSparql = \"\";\n    if (state.search.searchParameters.quotationExpressionType){\n      const quotationExpressionTypeShortId = state.search.searchParameters.quotationExpressionType\n\n      quotationExpressionTypeSparql = [\n        \"{\",\n          \"\\n#check for canonical quotation whose source is memberOf the search expression\\n\",\n          \"?quotation <http://scta.info/property/source> ?source .\",\n          \"?source <http://scta.info/property/isMemberOf> ?memberOf .\",\n          \"?memberOf <http://scta.info/property/expressionType> <http://scta.info/resource/\" + quotationExpressionTypeShortId + \"> . \",\n        \"}\",\n        \"UNION\",\n        \"\\n#check for canonical quotation whose source IS the search expression\\n\",\n        \"{\",\n          \"?quotation <http://scta.info/property/source> ?source .\",\n          \"?source <http://scta.info/property/expressionType> <http://scta.info/resource/\" + quotationExpressionTypeShortId + \"> .\",\n        \"}\"\n        ].join('');\n      }\n\n  var workGroupSparql = \"\";\n    if (state.search.searchParameters.workGroup){\n      workGroupSparql = [\n      // \"?quotation <http://scta.info/property/hasInstance> ?quotationInstance .\",\n      // \"?quotationInstance <http://scta.info/property/isPartOfTopLevelExpression> ?toplevel_expression .\",\n      \"<http://scta.info/resource/\" + state.search.searchParameters.workGroup + \"> <http://scta.info/property/hasExpression> ?toplevel_expression .\",\n      ].join('');\n\n    }\n\n    let expressionTypeSparql = \"\";\n    if (state.search.searchParameters.expressionType){\n      expressionTypeSparql = [\n\n        \"?quotation <http://scta.info/property/hasInstance> ?quotationInstance .\",\n        \"?quotationInstance <http://scta.info/property/isMemberOf> ?expressionIsMemberOf .\",\n        \"?expressionIsMemberOf <http://scta.info/property/expressionType> <http://scta.info/resource/\" + state.search.searchParameters.expressionType + \"> .\",\n      ].join('');\n    }\n\n\n    var query = [\n          \"SELECT DISTINCT ?quotation ?citation ?quotation_text \",\n          \"WHERE {\",\n          \"?quotation a <http://scta.info/resource/quotation> .\",\n          \"?quotation <http://scta.info/property/quotation> ?quotation_text .\",\n          expressionTypeSparql,\n          quotationInstanceSparql,\n          topLevelExpressionSparql,\n          expressionAuthorCoreSparql,\n          workGroupSparql,\n          quotationAuthorCoreSparql,\n          quotationWorkGroupSparql,\n          quotationWorkSparql,\n          quotationExpressionTypeSparql,\n          expressionIdSparql,\n          \"OPTIONAL { \",\n          \"?quotation <http://scta.info/property/citation> ?citation .\",\n          \"}\",\n          quotationAuthorDateAfterSparqlFilter,\n          quotationAuthorDateBeforeSparqlFilter,\n          expressionAuthorDateBeforeSparqlFilter,\n          expressionAuthorDateAfterSparqlFilter,\n          \"FILTER (REGEX(STR(?quotation_text), '\" + searchText + \"', 'i')) .\",\n          \"}\",\n          \"ORDER BY ?citation \",\n          \"LIMIT 1000\"\n        ].join('');\n    dispatch(startQuotationsFetch());\n    axios.get(sparqlEndpoint, {params: {\"query\" : query, \"output\": \"json\"}}).then(function(res){\n      var results = res.data.results.bindings\n      dispatch(completeCanonicalQuotationsFetch(results));\n    });\n  };\n}\n\n//maifestation Quotations Actions\n// CanonicalQuotations (plural) Actions\nexport var changeManifestationQuotationsFocus = (id) => {\n  return{\n    type: \"CHANGE_MANIFESTATION_QUOTATIONS_FOCUS\",\n    id\n  }\n}\nexport var clearManifestationQuotationsFocus = () =>{\n  return{\n    type: \"CLEAR_MANIFESTATION_QUOTATIONS_FOCUS\",\n  }\n}\nexport var clearManifestationQuotations = () => {\n  return{\n    type: \"CLEAR_MANIFESTATION_QUOTATIONS\"\n  };\n};\nexport var startManifestationQuotationsFetch = () => {\n  return{\n    type: \"START_MANIFESTATION_QUOTATIONS_FETCH\"\n  };\n};\nexport var completeManifestationQuotationsFetch = (manifestationQuotations) => {\n  return{\n    type: \"COMPLETE_MANIFESTATION_QUOTATIONS_FETCH\",\n    manifestationQuotations\n  };\n};\nexport var fetchManifestationQuotations = () =>{\n  return (dispatch, getState) => {\n    var state = getState();\n    var searchText = state.search.searchParameters.searchText || \"\";\n\n    var query = \"\"\n\n    if (state.focusedQuotation.id != undefined){\n      var expressionQuotationId = state.focusedQuotation.id;\n      query = [\n            \"SELECT ?quotation ?isManifestationOf ?quotation_text ?canonicalTranscription \",\n            \"WHERE {\",\n            \"<\" + expressionQuotationId + \"> <http://scta.info/property/hasManifestation> ?quotation .\",\n            \"?quotation <http://scta.info/property/isManifestationOf> ?isManifestationOf .\",\n            \"?quotation <http://scta.info/property/structureElementText> ?quotation_text .\",\n            \"OPTIONAL\",\n            \"{\",\n              \"?quotation <http://scta.info/property/hasCanonicalTranscription> ?canonicalTranscription .\",\n            \"}\",\n            \"}\"\n          ].join('');\n    }\n    else{\n      query = [\n          \"SELECT ?quotation ?isManifestationOf ?quotation_text ?canonicalTranscription \",\n          \"WHERE {\",\n          \"?quotation <http://scta.info/property/structureElementType> <http://scta.info/resource/structureElementQuote> .\",\n          \"?quotation a <http://scta.info/resource/manifestation> .\",\n          \"?quotation <http://scta.info/property/isManifestationOf> ?isManifestationOf .\",\n          \"?quotation <http://scta.info/property/structureElementText> ?quotation_text .\",\n          \"OPTIONAL\",\n          \"{\",\n            \"?quotation <http://scta.info/property/hasCanonicalTranscription> ?canonicalTranscription .\",\n          \"}\",\n          \"FILTER (REGEX(STR(?quotation_text), '\" + searchText + \"', 'i')) .\",\n          \"}\",\n          \"ORDER BY ?isInstanceOf \",\n          \"LIMIT 100\"\n        ].join('');\n      }\n\n    dispatch(startManifestationQuotationsFetch());\n    axios.get(sparqlEndpoint, {params: {\"query\" : query, \"output\": \"json\"}}).then(function(res){\n      var results = res.data.results.bindings\n\n      dispatch(completeManifestationQuotationsFetch(results));\n    });\n  };\n}\n\n//paragraph actions\n\nexport var clearParagraph = () => {\n  return{\n    type: \"CLEAR_PARAGRAPH\"\n  };\n};\n\nexport var startParagraphFetch = () => {\n  return{\n    type: \"START_PARAGRAPH_FETCH\"\n  };\n};\nexport var completeParagraphFetch = (paragraph) => {\n  return{\n    type: \"COMPLETE_PARAGRAPH_FETCH\",\n    paragraph\n  };\n};\nexport var fetchParagraph = () =>{\n  return (dispatch, getState) => {\n    var state = getState();\n\n    if (state.focusedQuotation){\n      var quotationId = state.focusedQuotation.id;\n      //var expressionQuotationId = quotationid;\n      var query = \"\";\n      var idType = state.focusedQuotation.type\n\n      if (idType === \"expression\"){\n        query = [\n          \"CONSTRUCT\",\n          \"{\",\n            \"?expression_paragraph <http://scta.info/property/hasDefaultManifestation> ?manifestation_paragraph ;\",\n            \"<http://scta.info/property/hasManifestations> ?manifestations ;\",\n            \"<http://scta.info/property/hasDefaultTranscription> ?transcription_paragraph ;\",\n            \"<http://scta.info/property/isPartOfStructureItem> ?transcription_item ;\",\n            \"<http://scta.info/property/hasDocument> ?transcription_item_file ;\",\n            \"<http://scta.info/property/hasXML> ?xml_url .\",\n          \"}\",\n          \"WHERE { \",\n            \"<\" + quotationId + \"> <http://scta.info/property/isPartOfStructureBlock> ?expression_paragraph .\",\n            \"?expression_paragraph <http://scta.info/property/hasCanonicalManifestation> ?manifestation_paragraph .\",\n            \"?expression_paragraph <http://scta.info/property/hasManifestation> ?manifestations .\",\n            \"?manifestation_paragraph <http://scta.info/property/isManifestationOf> ?expression_paragraph .\",\n            \"?manifestation_paragraph <http://scta.info/property/hasCanonicalTranscription> ?transcription_paragraph .\",\n            \"?transcription_paragraph <http://scta.info/property/isPartOfStructureItem> ?transcription_item .\",\n            \"?transcription_item <http://scta.info/property/hasDocument> ?transcription_item_file .\",\n            \"?transcription_paragraph <http://scta.info/property/hasXML> ?xml_url .\",\n          \"}\"\n          ].join('');\n        }\n      else if (idType === \"manifestation\"){\n        query = [\n          \"CONSTRUCT\",\n          \"{\",\n            \"?expression_paragraph <http://scta.info/property/hasDefaultManifestation> ?manifestation_paragraph ;\",\n             \"<http://scta.info/property/hasManifestations> ?manifestations ;\",\n             \"<http://scta.info/property/hasDefaultTranscription> ?transcription_paragraph ;\",\n             \"<http://scta.info/property/isPartOfStructureItem> ?transcription_item ;\",\n             \"<http://scta.info/property/hasDocument> ?transcription_item_file ;\",\n             \"<http://scta.info/property/hasXML> ?xml_url .\",\n          \"}\",\n          \"WHERE { \",\n            \"<\" + quotationId + \"> <http://scta.info/property/isPartOfStructureBlock> ?manifestation_paragraph . \",\n            \"?manifestation_paragraph <http://scta.info/property/isManifestationOf> ?expression_paragraph .\",\n            \"?expression_paragraph <http://scta.info/property/hasManifestation> ?manifestations .\",\n            \"?manifestation_paragraph <http://scta.info/property/hasCanonicalTranscription> ?transcription_paragraph .\",\n            \"?transcription_paragraph <http://scta.info/property/isPartOfStructureItem> ?transcription_item .\",\n            \"?transcription_item <http://scta.info/property/hasDocument> ?transcription_item_file .\",\n            \"?transcription_paragraph <http://scta.info/property/hasXML> ?xml_url .\",\n          \"}\"\n        ].join('');\n      }\n\n      dispatch(startParagraphFetch());\n      axios.get(sparqlEndpoint, {params: {\"query\" : query, \"output\": \"json\"}}).then(function(res){\n        var results = res.data\n        if (results.hasXML){\n          axios.get(results.hasXML.replace(\"http://\", \"https://\")).then(function(res2){\n            var paragraph = {\n              expression_id: results[\"@id\"],\n              manifestations: results.hasManifestations,\n              manifestation_id: results.hasDefaultManifestation,\n              transcription_id: results.hasDefaultTranscription,\n              transcription_item_file: results.hasDocument.replace(\"http://\", \"https://\"),\n              paragraph_text: res2.data\n            }\n            dispatch(completeParagraphFetch(paragraph));\n            dispatch(fetchReview());\n          });\n        }\n      }).catch((err) => {\n        console.log(\"error:\", err)\n      })\n      ;\n    };\n  };\n};\nexport var startReviewFetch = () => {\n  return{\n    type: \"START_REVIEW_FETCH\"\n  };\n};\nexport var completeReviewFetch = (review) => {\n  return{\n    type: \"COMPLETE_REVIEW_FETCH\",\n    review\n  };\n};\nexport var fetchReview = () =>{\n  return (dispatch, getState) => {\n    var state = getState();\n\n    if (state.paragraph.transcription_item_file){\n      var url = state.paragraph.transcription_item_file;\n      var reviewUrl = \"https://dll-review-registry.scta.info/api/v1/reviews?url=\" + url + \"&society=MAA\";\n      dispatch(startReviewFetch());\n      axios.get(reviewUrl).then(function(res){\n        var review = res.data[0];\n        dispatch(completeReviewFetch(review));\n      });\n    };\n  };\n};\n\n//Source Paragraph Actions\n\nexport var clearSourceParagraph = () => {\n  return{\n    type: \"CLEAR_SOURCE_PARAGRAPH\"\n  };\n};\n\nexport var startSourceParagraphFetch = () => {\n  return{\n    type: \"START_SOURCE_PARAGRAPH_FETCH\"\n  };\n};\nexport var completeSourceParagraphFetch = (sourceParagraph) => {\n  return{\n    type: \"COMPLETE_SOURCE_PARAGRAPH_FETCH\",\n    sourceParagraph\n  };\n};\nexport var fetchSourceParagraph = () =>{\n  return (dispatch, getState) => {\n    var state = getState();\n\n    if (state.focusedQuotation){\n      var sourceParagraphid = state.focusedQuotation.source;\n      //var expressionQuotationId = quotationid;\n      var query = [\n        \"CONSTRUCT\",\n        \"{\",\n          \"?expression_paragraph <http://scta.info/property/hasDefaultManifestation> ?manifestation_paragraph ;\",\n           \"<http://scta.info/property/hasManifestations> ?manifestations ;\",\n           \"<http://scta.info/property/hasDefaultTranscription> ?transcription_paragraph ;\",\n           \"<http://scta.info/property/isPartOfStructureItem> ?transcription_item ;\",\n           \"<http://scta.info/property/hasDocument> ?transcription_item_file ;\",\n           \"<http://scta.info/property/hasXML> ?xml_url .\",\n        \"}\",\n          \"WHERE { \",\n          \"BIND(<\" + sourceParagraphid + \"> as ?expression_paragraph) .\",\n          \"?expression_paragraph <http://scta.info/property/hasCanonicalManifestation> ?manifestation_paragraph .\",\n          \"?expression_paragraph <http://scta.info/property/hasManifestation> ?manifestations .\",\n          \"?manifestation_paragraph <http://scta.info/property/hasCanonicalTranscription> ?transcription_paragraph .\",\n          \"?transcription_paragraph <http://scta.info/property/isPartOfStructureItem> ?transcription_item .\",\n          \"?transcription_item <http://scta.info/property/hasDocument> ?transcription_item_file .\",\n          \"?transcription_paragraph <http://scta.info/property/hasXML> ?xml_url .\",\n          \"}\"\n        ].join('');\n\n      dispatch(startSourceParagraphFetch());\n      axios.get(sparqlEndpoint, {params: {\"query\" : query, \"output\": \"json\"}}).then(function(res){\n        var results = res.data\n        if (results.hasXML){\n          axios.get(results.hasXML.replace(\"http://\", \"https://\")).then(function(res2){\n            var sourceParagraph = {\n              expression_id: results[\"@id\"],\n              manifestations: results.hasManifestations,\n              manifestation_id: results.hasDefaultManifestation,\n              transcription_id: results.hasDefaultTranscription,\n              transcription_item_file: results.hasDocument.replace(\"http://\", \"https://\"),\n              paragraph_text: res2.data\n            }\n            dispatch(completeSourceParagraphFetch(sourceParagraph));\n          //dispatch(fetchSourceParagraphReview());\n          });\n        }\n      });\n    };\n  };\n};\nexport var startSourceParagraphReviewFetch = () => {\n  return{\n    type: \"START_SOURCE_PARAGRAPH_REVIEW_FETCH\"\n  };\n};\nexport var completeSourceParagraphReviewFetch = (review) => {\n  return{\n    type: \"COMPLETE_SOURCE_PARAGRAPH_FETCH\",\n    review\n  };\n};\nexport var fetchSourceParagraphReview = () =>{\n  return (dispatch, getState) => {\n    var state = getState();\n\n    if (state.sourceParagraph.transcription_item_file){\n      var url = state.sourceParagraph.transcription_item_file;\n      var reviewUrl = \"https://dll-review-registry.scta.info/api/v1/reviews?url=\" + url + \"&society=MAA\";\n      dispatch(startSourceParagraphFetch());\n      axios.get(reviewUrl).then(function(res){\n        var review = res.data[0];\n        dispatch(completeSourceParagraphReviewFetch(review));\n      });\n    };\n  };\n};\n\n// Full text actions\n\n//paragraph actions\n\nexport var toggleFullTextDisplay = (current) => {\n  return{\n    type: \"TOGGLE_FULL_TEXT_DISPLAY\",\n    current\n  };\n}\nexport var clearFullText = () => {\n  return{\n    type: \"CLEAR_FULL_TEXT\"\n  };\n};\n\nexport var startFullTextFetch = () => {\n  return{\n    type: \"START_FULL_TEXT_FETCH\"\n  };\n};\nexport var completeFullTextFetch = (text) => {\n  return{\n    type: \"COMPLETE_FULL_TEXT_FETCH\",\n    text\n  };\n};\nexport var fetchFullText = (source=false) =>{\n  return (dispatch, getState) => {\n    var state = getState();\n    var query = \"\";\n    if (state.focusedQuotation){\n      var quotationId = state.focusedQuotation.id;\n      //var expressionQuotationId = quotationid;\n      var idType = state.focusedQuotation.type\n\n      if (source === true){\n        query = [\n          \"SELECT ?expression_item ?manifestation_item ?transcription_item ?xml_url ?transcription_item_file \",\n          \"WHERE { \",\n          \"BIND(<\" + state.focusedQuotation.source + \"> AS ?expression_block) .\",\n          \"?expression_block <http://scta.info/property/isPartOfStructureItem> ?expression_item .\",\n          \"?expression_item <http://scta.info/property/hasCanonicalManifestation> ?manifestation_item .\",\n          \"?manifestation_item <http://scta.info/property/hasCanonicalTranscription> ?transcription_item .\",\n          \"?transcription_item <http://scta.info/property/hasDocument> ?transcription_item_file .\",\n          \"?transcription_item <http://scta.info/property/hasXML> ?xml_url .\",\n          \"}\"\n        ].join('');\n      }\n      else if (idType === \"expression\"){\n        query = [\n            \"SELECT ?expression_item ?manifestation_item ?transcription_item ?xml_url ?transcription_item_file \",\n            \"WHERE { \",\n            \"<\" + quotationId + \"> <http://scta.info/property/isPartOfStructureBlock> ?expression_block .\",\n            \"?expression_block <http://scta.info/property/isPartOfStructureItem> ?expression_item .\",\n            \"?expression_item <http://scta.info/property/hasCanonicalManifestation> ?manifestation_item .\",\n            \"?manifestation_item <http://scta.info/property/hasCanonicalTranscription> ?transcription_item .\",\n            \"?transcription_item <http://scta.info/property/hasDocument> ?transcription_item_file .\",\n            \"?transcription_item <http://scta.info/property/hasXML> ?xml_url .\",\n            \"}\"\n          ].join('');\n        }\n      else if (idType === \"manifestation\"){\n        query = [\n            \"SELECT ?expression_item ?manifestation_item ?transcription_item ?xml_url ?transcription_item_file \",\n            \"WHERE { \",\n            \"<\" + quotationId + \"> <http://scta.info/property/isPartOfStructureBlock> ?manifestation_block . \",\n            \"?manifestation_block <http://scta.info/property/isPartOfStructureItem> ?manifestation_item .\",\n            \"?manifestation_item <http://scta.info/property/isManifestationOf> ?expression_item .\",\n            \"?manifestation_item <http://scta.info/property/hasCanonicalTranscription> ?transcription_item .\",\n            \"?transcription_item <http://scta.info/property/hasDocument> ?transcription_item_file .\",\n            \"?transcription_item <http://scta.info/property/hasXML> ?xml_url .\",\n            \"}\"\n          ].join('');\n      }\n      console.log(query)\n      dispatch(startFullTextFetch());\n      axios.get(sparqlEndpoint, {params: {\"query\" : query, \"output\": \"json\"}}).then(function(res){\n        var results = res.data.results.bindings[0];\n        console.log(\"full text results\", results)\n        axios.get(results.xml_url.value.replace(\"http://\", \"https://\")).then(function(res2){\n          var text = {\n            expression_id: results.expression_item.value,\n            manifestation_id: results.manifestation_item.value,\n            transcription_id: results.transcription_item.value,\n            transcription_item_file: results.transcription_item_file ? results.transcription_item_file.value.replace(\"http://\", \"https://\") : \"\",\n            text: res2.data\n          }\n          dispatch(completeFullTextFetch(text));\n          dispatch(fetchReview());\n        });\n      });\n    };\n  };\n};\n","var test =  {\n  \"handlers\": {\n    \"eg\": [\"<pre>\",\"</pre>\"],\n    // inserts a link inside <ptr> using the @target; the link in the\n    // @href is piped through the rw (rewrite) function before insertion\n    \"ptr\": [\"<a href=\\\"$rw@target\\\">$@target</a>\"],\n    // wraps the content of the <ref> in an HTML link\n    //\"ref\": [\"<a href=\\\"$rw@target\\\">\",\"</a>\"],\n    \"graphic\": function(elt) {\n      let content = new Image();\n      content.src = this.rw(elt.getAttribute(\"url\"));\n      if (elt.hasAttribute(\"width\")) {\n        content.width = elt.getAttribute(\"width\").replace(/[^.0-9]/g, \"\");\n      }\n      if (elt.hasAttribute(\"height\")) {\n        content.height = elt.getAttribute(\"height\").replace(/[^.0-9]/g, \"\");\n      }\n      return content;\n    },\n    \"list\": function(elt) {\n      if (elt.hasAttribute(\"type\") && elt.getAttribute(\"type\") == \"gloss\") {\n        let dl = document.createElement(\"dl\");\n        for (let child of Array.from(elt.children)) {\n          if (child.nodeType == Node.ELEMENT_NODE) {\n            if (child.localName == \"tei-label\") {\n              let dt = document.createElement(\"dt\");\n              dt.innerHTML = child.innerHTML;\n              dl.appendChild(dt);\n            }\n            if (child.localName == \"tei-item\") {\n              let dd = document.createElement(\"dd\");\n              dd.innerHTML = child.innerHTML;\n              dl.appendChild(dd);\n            }\n          }\n        }\n        return dl;\n      } else {\n        return null;\n      }\n    },\n    \"table\": function(elt) {\n      let table = document.createElement(\"table\");\n      table.innerHTML = elt.innerHTML;\n      if (table.firstElementChild.localName == \"tei-head\") {\n        let head = table.firstElementChild;\n        head.remove();\n        let caption = document.createElement(\"caption\");\n        caption.innerHTML = head.innerHTML;\n        table.appendChild(caption);\n      }\n      for (let row of Array.from(table.querySelectorAll(\"tei-row\"))) {\n        let tr = document.createElement(\"tr\");\n        tr.innerHTML = row.innerHTML;\n        for (let attr of Array.from(row.attributes)) {\n          tr.setAttribute(attr.name, attr.value);\n        }\n        row.parentElement.replaceChild(tr, row);\n      }\n      for (let cell of Array.from(table.querySelectorAll(\"tei-cell\"))) {\n        let td = document.createElement(\"td\");\n        if (cell.hasAttribute(\"cols\")) {\n          td.setAttribute(\"colspan\", cell.getAttribute(\"cols\"));\n        }\n        td.innerHTML = cell.innerHTML;\n        for (let attr of Array.from(cell.attributes)) {\n          td.setAttribute(attr.name, attr.value);\n        }\n        cell.parentElement.replaceChild(td, cell);\n      }\n      return table;\n    },\n    \"egXML\": function(elt) {\n      let pre = document.createElement(\"pre\");\n      pre.innerHTML = this.serialize(elt, true);\n      return pre;\n    }\n  }\n}\nmodule.exports = test;\n","import React from 'react';\nimport Form from 'react-bootstrap/Form';\nimport Button from 'react-bootstrap/Button';\nvar {connect} = require('react-redux');\nvar actions = require('../actions/actions');\n\nclass Search extends React.Component{\n  constructor(props){\n    super(props)\n    this.handleSetSearchText = this.handleSetSearchText.bind(this)\n    this.handleOnShowQuotationsWithoutAssociation = this.handleOnShowQuotationsWithoutAssociation.bind(this)\n    this.handleRunQuery = this.handleRunQuery.bind(this)\n    this.handleGraph = this.handleGraph.bind(this)\n    this.handleClearFilters = this.handleClearFilters.bind(this)\n  }\n  handleSetSearchText(e){\n    var {dispatch, search} = this.props;\n    var searchText = this.refs.searchText.value;\n    var searchParameters = {\n      ...this.props.search.searchParameters,\n      searchText\n    }\n    dispatch(actions.setSearchParameters(searchParameters));\n  }\n  handleOnShowQuotationsWithoutAssociation(e){\n\t\te.preventDefault();\n\t\tvar {dispatch, search} = this.props;\n    //var searchText = this.refs.searchText.value;\n    var quotationWorkGroup = this.refs.quotationWorkGroup.value;\n    var quotationExpressionType = this.refs.quotationExpressionType.value;\n    var quotationWork = this.refs.quotationWork.value;\n    var quotationWorkPart = this.refs.quotationWorkPart.value\n    var expressionId = this.refs.expressionId.value;\n    var expressionPart = this.refs.expressionPart.value ? this.refs.expressionPart.value.split(\"/\")[0] : this.refs.expressionPart.value\n    var expressionLevel = this.refs.expressionPart.value ? this.refs.expressionPart.value.split(\"/\")[1] : 1 ;\n    var expressionAuthor = this.refs.expressionAuthor.value;\n    var expressionAuthorType = this.refs.expressionAuthorType.value;\n    var quotationAuthor = this.refs.quotationAuthor.value;\n    var quotationAuthorType = this.refs.quotationAuthorType.value;\n    var expressionType = this.refs.expressionType.value;\n    var workGroup = this.refs.workGroup.value;\n    var quotationAuthorDateAfter = this.refs.quotationAuthorDateAfter.value;\n    var quotationAuthorDateBefore = this.refs.quotationAuthorDateBefore.value;\n    var expressionAuthorDateAfter = this.refs.expressionAuthorDateAfter.value;\n    var expressionAuthorDateBefore = this.refs.expressionAuthorDateBefore.value;\n    var structureElementType = this.refs.structureElementType.value;\n\n    //var retainCanonical = this.refs.retainCanonical.checked;\n    var searchParameters = {\n      //searchText,\n      expressionId,\n      expressionPart,\n      expressionLevel,\n      expressionAuthor,\n      quotationAuthor,\n      quotationExpressionType,\n      quotationWork,\n      quotationWorkPart,\n      quotationWorkGroup,\n      quotationAuthorType,\n      expressionAuthorType,\n      expressionType,\n      workGroup,\n      quotationAuthorDateAfter,\n      quotationAuthorDateBefore,\n      expressionAuthorDateAfter,\n      expressionAuthorDateBefore,\n      structureElementType\n\n    }\n\n    dispatch(actions.setSearchParameters(searchParameters));\n    //search filters options update\n    dispatch(actions.fetchQuotationWorkParts());\n    dispatch(actions.fetchExpressionParts());\n    dispatch(actions.fetchSearchWorksList());\n    dispatch(actions.fetchQuotationWorksList());\n    dispatch(actions.fetchQuotationAuthors());\n    dispatch(actions.fetchExpressionAuthors());\n    //fetch expression types, should adjust based on types that would apply for a select work group author or expression\n    // there are no filters for this yet\n    //dispatch(actions.fetchExpressionTypes());\n\n    // actually quotation query Actions\n    // comment these out, if you want to add search button and turn off automatic\n    // on change search <button id=\"runQuery\" onClick={this.handleRunQuery}>Search</button>\n\n      // if (!retainCanonical) dispatch(actions.clearCanonicalQuotation());\n  \t\t// dispatch(actions.clearFocusedQuotation());\n  \t\t// dispatch(actions.clearParagraph());\n  \t\t// if (!retainCanonical) dispatch(actions.fetchCanonicalQuotations());\n  \t\t// dispatch(actions.fetchQuotations());\n  \t\t// dispatch(actions.clearManifestationQuotations());\n      // dispatch(actions.fetchChart());\n    }\n  handleRunQuery(e){\n\t\te.preventDefault();\n    var {dispatch, search} = this.props;\n\t\t// var searchText = this.refs.searchText.value;\n    // var quotationWorkGroup = this.refs.quotationWorkGroup.value;\n    // var quotationWork = this.refs.quotationWork.value;\n    // var quotationWorkPart = this.refs.quotationWorkPart.value\n    // var expressionId = this.refs.expressionId.value;\n    // var expressionPart = this.refs.expressionPart.value ? this.refs.expressionPart.value.split(\"/\")[0] : this.refs.expressionPart.value\n    // var expressionLevel = this.refs.expressionPart.value ? this.refs.expressionPart.value.split(\"/\")[1] : 1 ;\n    // var expressionAuthor = this.refs.expressionAuthor.value;\n    // var expressionAuthorType = this.refs.expressionAuthorType.value;\n    // var quotationAuthor = this.refs.quotationAuthor.value;\n    // var quotationAuthorType = this.refs.quotationAuthorType.value;\n    // var expressionType = this.refs.expressionType.value;\n    // var quotationExpressionType = this.refs.quotationExpressionType.value;\n    // var workGroup = this.refs.workGroup.value;\n\n    //var retainCanonical = this.refs.retainCanonical.checked;\n    var retainCanonical = false;\n    // var searchParameters = {\n    //   searchText,\n    //   expressionId,\n    //   expressionPart,\n    //   expressionLevel,\n    //   expressionAuthor,\n    //   quotationAuthor,\n    //   quotationExpressionType,\n    //   quotationWork,\n    //   quotationWorkPart,\n    //   quotationWorkGroup,\n    //   quotationAuthorType,\n    //   expressionAuthorType,\n    //   expressionType,\n    //   workGroup\n    // }\n\n    if (!retainCanonical) dispatch(actions.clearCanonicalQuotation());\n\t\tdispatch(actions.clearFocusedQuotation());\n    dispatch(actions.clearManifestationQuotations());\n\t\tdispatch(actions.clearParagraph());\n    dispatch(actions.clearSourceParagraph());\n\t\tif (!retainCanonical) dispatch(actions.fetchCanonicalQuotations());\n\t\tdispatch(actions.fetchQuotations());\n\t\tdispatch(actions.fetchChart());\n\t}\n  handleClearFilters(e){\n    e.preventDefault();\n    var {dispatch, search} = this.props;\n    dispatch(actions.clearSearchParameters());\n    dispatch(actions.clearCanonicalQuotations());\n    dispatch(actions.clearQuotations());\n    dispatch(actions.fetchQuotationWorkParts());\n    dispatch(actions.fetchExpressionParts());\n    //dispatch(actions.fetchCanonicalQuotations());\n    dispatch(actions.fetchQuotationAuthors());\n    dispatch(actions.fetchExpressionAuthors());\n    dispatch(actions.fetchSearchWorksList());\n    //store.dispatch(actions.fetchExpressionTypes());\n    dispatch(actions.fetchQuotationWorksList());\n    dispatch(actions.fetchWorkGroups());\n    dispatch(actions.fetchAuthorTypes());\n    //dispatch(actions.fetchManifestationQuotations(searchText, quotationType, expressionId));\n    dispatch(actions.clearManifestationQuotations());\n    dispatch(actions.clearParagraph());\n    dispatch(actions.clearSourceParagraph());\n    this.refs.quotationAuthorDateAfter.value = \"\";\n    this.refs.quotationAuthorDateBefore.value = \"\";\n    this.refs.expressionAuthorDateAfter.value = \"\";\n    this.refs.expressionAuthorDateBefore.value = \"\";\n    this.refs.searchText.value = \"\";\n\n\n\n  }\n  handleGraph(e){\n\t\te.preventDefault();\n\t\tvar {dispatch} = this.props;\n\t\tdispatch(actions.toggleGraphDisplay(this.props.chart.visible));\n\t}\n\trender(){\n    var _this = this;\n    function displaySearchWorksList(){\n      var searchWorks = _this.props.search.searchWorks;\n      return searchWorks.map((work) => {\n        return(\n          <option value={work.expressionShortId}>{work.expressionTitle}</option>\n          )\n        }\n      )\n    }\n    function displayQuotationWorksList(){\n      var quotationWorksList = _this.props.search.quotationWorksList;\n      return quotationWorksList.map((work) => {\n        var id = work.expressionShortId ? work.expressionShortId : work.expression.split(\"http://scta.info/resource/\")[1];\n        return(\n          <option value={id}>{work.expressionTitle}</option>\n          )\n        }\n      )\n    }\n    function displayQuotationWorkPartsParent(){\n      var quotationWorkParts = _this.props.search.quotationWorkParts;\n      if (quotationWorkParts){\n        var part = quotationWorkParts[0];\n        if (part){\n          var parentid = part.parent.split(\"http://scta.info/resource/\")[1];\n          return(\n            <option value={parentid}>Current: {part.parent_title}</option>\n          )\n        }\n      }\n    }\n    function displayQuotationWorkPartsGrandparent(){\n      var quotationWorkParts = _this.props.search.quotationWorkParts;\n      if (quotationWorkParts){\n        var part = quotationWorkParts[0];\n        if (part){\n          var grandparentid = part.grandparent.split(\"http://scta.info/resource/\")[1];\n          if (grandparentid != undefined){\n            return(\n              <option value={grandparentid}>Up: {part.grandparent_title}</option>\n            )\n          }\n        }\n      }\n    }\n    function displayQuotationWorkParts(){\n      var quotationWorkParts = _this.props.search.quotationWorkParts;\n      if (quotationWorkParts){\n        return quotationWorkParts.map((part) => {\n          var id = part.childShortId ? part.childShortId : part.child.split(\"http://scta.info/resource/\")[1];\n          if (part.child){\n            return(\n              <option value={id}>{part.child_title}</option>\n              )\n            }\n          }\n        )\n      }\n    }\n    function displayExpressionPartsParent(){\n      var expressionParts = _this.props.search.expressionParts;\n      if (expressionParts){\n        var part = expressionParts[0];\n        if (part){\n          var parentid = part.parent.split(\"http://scta.info/resource/\")[1];\n          return(\n            <option value={parentid+ \"/\" + part.parent_level}>Current: {part.parent_title}</option>\n          )\n        }\n      }\n    }\n    function displayExpressionPartsGrandparent(){\n      var expressionParts = _this.props.search.expressionParts;\n      if (expressionParts){\n        var part = expressionParts[0];\n        if (part){\n          var grandparentid = part.grandparent.split(\"http://scta.info/resource/\")[1];\n          if (grandparentid != undefined){\n            return(\n              <option value={grandparentid + \"/\" + part.grandparent_level}>Up: {part.grandparent_title}</option>\n            )\n          }\n        }\n      }\n    }\n    function displayExpressionParts(){\n      var expressionParts = _this.props.search.expressionParts;\n      if (expressionParts){\n        return expressionParts.map((part) => {\n          var id = part.childShortId ? part.childShortId : part.child.split(\"http://scta.info/resource/\")[1];\n          if (part.child){\n            return(\n              <option value={id + \"/\" + part.child_level}>{part.child_title}</option>\n              )\n            }\n          }\n        )\n      }\n    }\n\n    function displayQuotationAuthorsList(){\n      var authors = _this.props.search.quotationAuthors;\n      return authors.map((author) => {\n        return(\n          <option value={author.authorShortId}>{author.authorTitle}</option>\n          )\n        }\n      )\n    }\n    function displayExpressionAuthorsList(){\n      var authors = _this.props.search.expressionAuthors;\n      return authors.map((author) => {\n        return(\n          <option value={author.authorShortId}>{author.authorTitle}</option>\n          )\n        }\n      )\n    }\n    function displayExpressionTypeList(){\n      var expressionTypes = _this.props.search.expressionTypes;\n      return expressionTypes.map((type) => {\n        return(\n          <option value={type.expressionTypeShortId}>{type.expressionTypeTitle}</option>\n          )\n        }\n      )\n    }\n    function displayQuotationExpressionTypeList(){\n      var quotationExpressionTypes = _this.props.search.quotationExpressionTypes;\n      return quotationExpressionTypes.map((type) => {\n        return(\n          <option value={type.quotationExpressionTypeShortId}>{type.quotationExpressionTypeTitle}</option>\n          )\n        }\n      )\n    }\n    function displayWorkGroupsList(){\n      var workGroups = _this.props.search.workGroups;\n      return workGroups.map((workGroup) => {\n        return(\n          <option value={workGroup.workGroupShortId}>{workGroup.workGroupTitle}</option>\n          )\n        }\n      )\n    }\n    function displayQuotationAuthorTypes(){\n      const authorTypes = _this.props.search.authorTypes;\n      return authorTypes.map((authorType) => {\n        return(\n          <option value={authorType.authorTypeShortId}>{authorType.authorTypeTitle}</option>\n          )\n        }\n      )\n    }\n    function displayExpressionAuthorTypes(){\n      const authorTypes = _this.props.search.authorTypes;\n      return authorTypes.map((authorType) => {\n        return(\n          <option value={authorType.authorTypeShortId}>{authorType.authorTypeTitle}</option>\n          )\n        }\n      )\n    }\n    return(\n      <div>\n        <Form onSubmit={this.handleOnShowQuotationsWithoutAssociation}>\n          <div>\n\n            <div>\n              {\n                // turn this on, if you want  add search button turn off automatic\n                // on change search\n                <Button id=\"runQuery\" onClick={this.handleRunQuery}>Run Search</Button>\n              }\n\n              <Button id=\"clearFilter\" onClick={this.handleClearFilters}>Clear Filters</Button>\n            </div>\n            {\n              /*<div>\n              <label><input id=\"checkbox1\" ref=\"retainCanonical\" type=\"checkbox\"/>Restrict to Can. Quotation</label>\n            </div>\n            */\n            }\n            <div>\n            <p>Search Parameters</p>\n            <Form.Group>\n              <Form.Label>Quotation/ReferenceType</Form.Label>\n              <Form.Control as=\"select\" ref=\"structureElementType\" onChange={this.handleOnShowQuotationsWithoutAssociation}>\n                <option value=\"structureElementQuote\">Quotations</option>\n                <option value=\"structureElementRef\">References</option>\n                <option value=\"structureElementRefDup\">References (With Quotation Overlap)</option>\n                <option value=\"\">All</option>\n                <option value=\"allDup\">All (with quotation overlap)</option>\n              </Form.Control>\n            </Form.Group>\n            <Form.Group>\n              <Form.Label>\n                <Form.Control as=\"input\" type=\"text\" ref=\"searchText\" placeholder=\"search quotation text\" onChange={this.handleSetSearchText}/>\n              </Form.Label>\n            </Form.Group>\n            <hr/>\n            <p>Quotation Parameters</p>\n            <Form.Group>\n            <Form.Label>Quotation Author Type</Form.Label>\n              <Form.Control as=\"select\" ref=\"quotationAuthorType\" onChange={this.handleOnShowQuotationsWithoutAssociation}>\n                <option value=\"\">All</option>\n                {displayQuotationAuthorTypes()}\n              </Form.Control>\n\n            </Form.Group>\n            <Form.Group>\n              <Form.Label>Quotation Author Birth Date</Form.Label>\n              <br/>\n              After <Form.Control as=\"input\" ref=\"quotationAuthorDateAfter\" onBlur={this.handleOnShowQuotationsWithoutAssociation} placeholder=\"e.g. 1200\"/>\n              <br/>\n              Before <Form.Control as=\"input\" ref=\"quotationAuthorDateBefore\" onBlur={this.handleOnShowQuotationsWithoutAssociation} placeholder=\"e.g. 1400\"/>\n            </Form.Group>\n            <Form.Group>\n              <Form.Label>Quotation Author</Form.Label>\n              <Form.Control as=\"select\" ref=\"quotationAuthor\" onChange={this.handleOnShowQuotationsWithoutAssociation} value={_this.props.search.searchParameters.quotationAuthor}>\n                <option value=\"\">All</option>\n                {displayQuotationAuthorsList()}\n              </Form.Control>\n            </Form.Group>\n            <Form.Group>\n              <Form.Label>Quotation Work Group</Form.Label>\n                <Form.Control as=\"select\" ref=\"quotationWorkGroup\" onChange={this.handleOnShowQuotationsWithoutAssociation}>\n                  <option value=\"\">All</option>\n                  {displayWorkGroupsList()}\n                </Form.Control>\n\n            </Form.Group>\n            <Form.Group>\n              <Form.Label>Quotation Text Type</Form.Label>\n                <Form.Control as=\"select\" ref=\"quotationExpressionType\" onChange={this.handleOnShowQuotationsWithoutAssociation}>\n                  <option value=\"\">All</option>\n                  {displayQuotationExpressionTypeList()}\n                </Form.Control>\n            </Form.Group>\n            <Form.Group>\n              <Form.Label>Quotation Text Title</Form.Label>\n                <Form.Control as=\"select\" ref=\"quotationWork\" onChange={this.handleOnShowQuotationsWithoutAssociation} value={_this.props.search.searchParameters.quotationWork}>\n                  <option value=\"\">All</option>\n                  {displayQuotationWorksList()}\n                </Form.Control>\n            </Form.Group>\n            <Form.Group>\n              <Form.Label>Quotation Text Part</Form.Label>\n                <Form.Control as=\"select\" ref=\"quotationWorkPart\" onChange={this.handleOnShowQuotationsWithoutAssociation} value={_this.props.search.searchParameters.quotationWorkPart}>\n                  <option value=\"\">All</option>\n                  {displayQuotationWorkPartsGrandparent()}\n                  {displayQuotationWorkPartsParent()}\n                  {displayQuotationWorkParts()}\n                </Form.Control>\n            </Form.Group>\n            <hr/>\n            <p>Text Parameters</p>\n            <Form.Group>\n              <Form.Label>Text Author Type</Form.Label>\n              <Form.Control as=\"select\" ref=\"expressionAuthorType\" onChange={this.handleOnShowQuotationsWithoutAssociation}>\n                <option value=\"\">All</option>\n                {displayExpressionAuthorTypes()}\n              </Form.Control>\n            </Form.Group>\n            <Form.Group>\n              <Form.Label>Text Author Birth Date</Form.Label>\n              <br/>\n              After <Form.Control as=\"input\" ref=\"expressionAuthorDateAfter\" onBlur={this.handleOnShowQuotationsWithoutAssociation} placeholder=\"e.g. 1200\"/>\n              <br/>\n              Before <Form.Control as=\"input\" ref=\"expressionAuthorDateBefore\" onBlur={this.handleOnShowQuotationsWithoutAssociation} placeholder=\"e.g. 1400\"/>\n            </Form.Group>\n            <Form.Group>\n              <Form.Label>Text Author</Form.Label>\n                <Form.Control as=\"select\" ref=\"expressionAuthor\" onChange={this.handleOnShowQuotationsWithoutAssociation} value={_this.props.search.searchParameters.expressionAuthor}>\n                  <option value=\"\">All</option>\n                  {displayExpressionAuthorsList()}\n                </Form.Control>\n            </Form.Group>\n            <Form.Group>\n              <Form.Label>Text Work Group</Form.Label>\n                <Form.Control as=\"select\" ref=\"workGroup\" onChange={this.handleOnShowQuotationsWithoutAssociation}>\n                  <option value=\"\">All</option>\n                  {displayWorkGroupsList()}\n                </Form.Control>\n            </Form.Group>\n            <Form.Group>\n              <Form.Label>Text Type</Form.Label>\n                <Form.Control as=\"select\" ref=\"expressionType\" onChange={this.handleOnShowQuotationsWithoutAssociation}>\n                  <option value=\"\">All</option>\n                  {displayExpressionTypeList()}\n                </Form.Control>\n            </Form.Group>\n            <Form.Group>\n              <Form.Label>Text Title</Form.Label>\n                <Form.Control as=\"select\" ref=\"expressionId\" onChange={this.handleOnShowQuotationsWithoutAssociation} value={_this.props.search.searchParameters.expressionId}>\n                  <option value=\"\">All</option>\n                  {displaySearchWorksList()}\n                </Form.Control>\n            </Form.Group>\n            <Form.Group>\n              <Form.Label>Text Part</Form.Label>\n              <Form.Control as=\"select\" ref=\"expressionPart\" onChange={this.handleOnShowQuotationsWithoutAssociation} value={_this.props.search.searchParameters.expressionPart + \"/\" + _this.props.search.searchParameters.expressionLevel}>\n                <option value=\"\">All</option>\n                {displayExpressionPartsGrandparent()}\n                {displayExpressionPartsParent()}\n                {displayExpressionParts()}\n              </Form.Control>\n            </Form.Group>\n            </div>\n          </div>\n        </Form>\n        <p><a href=\"#\" onClick={this.handleGraph}>Toggle Historgram</a></p>\n      </div>\n\n\n\t\t)\n\t}\n}\n\nexport default connect(\n  (state) => {\n\t\treturn state\n\t}\n)(Search);\n","import React from 'react'\nimport $ from 'jquery';\nvar {connect} = require('react-redux');\nvar actions = require('../actions/actions');\n\n\n\nclass Quotation extends React.Component{\n\tconstructor(props){\n\t\tsuper(props)\n\t\tthis.handleOnClick = this.handleOnClick.bind(this)\n\t}\n\thandleOnClick(){\n\t\tvar {isInstanceOf, id, quotation, dispatch, source} = this.props;\n\t\tdispatch(actions.changeQuotationsFocus(this.props.id));\n\t\tvar newFocusedQuotationObject = {\n\t\t\tid,\n\t\t\tquotation,\n\t\t\tsource,\n\t\t\ttype: \"expression\"\n\t\t}\n\t\t// example of why all these different dispatches called here might be a problem\n\t\t//fetchParagraph() requires that the createFocusedQuotation() is set.\n\t\t//seems to be working as is, but i'm not sure if this is the best way\n\t\tdispatch(actions.createFocusedQuotation(newFocusedQuotationObject));\n\t\tdispatch(actions.fetchParagraph());\n\t\tdispatch(actions.fetchSourceParagraph());\n\t\t//dispatch(actions.fetchSourceParagraph());\n\t\t//this fetch also seems to rely on focusedQuotation state being set.\n\t\t// seems to work as is though\n\t\tdispatch(actions.fetchManifestationQuotations());\n\n\n\t\tif (isInstanceOf != null){\n\t\t\t// create canonicalQuotation\n\t\t\tvar canonicalQuotationObject = this.props.canonicalQuotations.find((quotation) => {\n\t\t\t\treturn quotation.id === isInstanceOf\n\n\t\t\t});\n\n\t\t\tif (canonicalQuotationObject != undefined){\n\t\t\t\tdispatch(actions.createCanonicalQuotation(canonicalQuotationObject));\n\t\t\t\t// focus canonicalquotation List Item\n\t\t\t\tdispatch(actions.changeCanonicalQuotationsFocus(isInstanceOf));\n\t\t\t\t// scroll\n\t\t\t\tvar topPos = document.getElementById(isInstanceOf).offsetTop;\n\t\t\t\t$('#CanonicalQuotationList').animate({ scrollTop: topPos-10 }, 400);\n\t\t\t\t//scroll self to top\n\t\t\t\tvar selfTopPos = document.getElementById(id).offsetTop;\n\t\t\t\t$('#quotationsList').animate({ scrollTop: selfTopPos-10 }, 400);\n\t\t\t}\n\t\t\telse{\n\t\t\t\talert(\"this quotation is assigned to a canonicalQuotation, but either there is an error in the id assigned or a canonicalQuotation record still needs to be made\")\n\t\t\t\tdispatch(actions.clearCanonicalQuotationsFocus());\n\t\t\t\tdispatch(actions.clearCanonicalQuotation());\n\t\t\t}\n\n\t\t}\n\t\telse{\n\t\t\tdispatch(actions.clearCanonicalQuotationsFocus());\n\t\t\tdispatch(actions.clearCanonicalQuotation());\n\n\t\t}\n\n\n\n\t}\n\trender(){\n\n\t\tvar {isInstanceOf, quotation, className, title, author, id, refText, citation} = this.props;\n\n\t\tvar className = isInstanceOf === null ? className + \" isNotInstance\" : className;\n\n\t\treturn(\n\t\t\t<div className=\"quotation-wrapper\">\n\t\t\t\t<p id={id} className={className} onClick={this.handleOnClick}>\n\t\t\t\t{quotation}\n\t\t\t\t</p>\n\t\t\t\t<a href={id} target=\"_blank\" className=\"quotation-citation\">{author}, {title}</a>\n\t\t\t\t<a href={id} target=\"_blank\" className=\"quotation-citation\">Original Ref: {refText}</a>\n\t\t\t\t<a href={id} target=\"_blank\" className=\"quotation-citation\">Modern Citation: {citation}</a>\n\t\t\t</div>\n\n\n\t\t)\n\t}\n}\n\nexport default connect(\n\t(state) => {\n\t\treturn state\n\t}\n)(Quotation);\n","import React from 'react';\nimport {connect} from 'react-redux';\n\nimport Quotation from \"./Quotation\"\n\nclass QuotationList extends React.Component{\n\trender(){\n    var {quotations, focusedQuotation} = this.props;\n    var renderQuotations = () => {\n\t\t\tif (quotations === \"fetching\"){\n\t\t\t\treturn <p>Fetching...</p>\n\t\t\t}\n\t\t\telse if (quotations.length === 0){\n        return(\n            <p className=\"container__message\">No Quotations</p>\n        );\n      }\n\t\t\telse {\n\t\t\t\treturn quotations.map( (quotation) => {\n\t\t\t\t\t//var quotationClass = quotation.focused ? \"quotation focused\" : \"quotation\"\n\t\t\t\t\tlet quotationClass = \"\"\n\t\t\t\t\tif (focusedQuotation.id){\n\t\t\t\t\t\tif (focusedQuotation.id.includes(quotation.id)){\n\t\t\t\t\t\t\tquotationClass = \"quotation focused\"\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tquotationClass = \"quotation\"\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tquotationClass = \"quotation\"\n\t\t\t\t\t}\n\t\t\t\t\tvar refType = quotation.refType\n\t\t\t\t\tvar classes = quotationClass + \" \" + quotation.refType\n\t        return (\n\n\t          <Quotation className={classes} key={quotation.id} {...quotation}/>\n\t        );\n\t      });\n\t\t\t}\n    };\n\n\t\treturn(\n\t\t\t<div>\n\t\t\t\t<p>List of Expression Quotations</p>\n\t\t\t\t{this.props.quotations !== \"fetching\" && <p>Count {quotations.length}</p>}\n\t\t\t\t{renderQuotations()}\n\t\t\t</div>\n\t\t)\n\t}\n}\n\nexport default connect(\n\t(state) => {\n\t\treturn state\n\t}\n)(QuotationList);\n","import React from 'react'\nvar {connect} = require('react-redux');\n\nclass FocusedQuotation extends React.Component{\n\trender(){\n    var {focusedQuotation} = this.props;\n\t\tvar {quotation} = focusedQuotation\n\t\tvar {id} = focusedQuotation\n\n\t\treturn(\n\t\t\t<div className=\"container\">\n\t\t\t\t<p>Focused Quotation: {quotation}</p>\n\t\t\t\t<p><a href={id}>{id}</a></p>\n\t\t\t</div>\n\t\t)\n\t}\n}\n\nexport default connect(\n\t(state) => {\n\t\treturn state\n\t}\n)(FocusedQuotation);\n","import React from 'react';\nvar {connect} = require('react-redux');\n\nclass CanonicalQuotation extends React.Component{\n\trender(){\n    var {canonicalQuotation} = this.props;\n\t\tvar displayQuotation = canonicalQuotation ? canonicalQuotation.quotation : \"No canonical quotation id assigned\";\n\t\tvar displayQuotationId = canonicalQuotation ? canonicalQuotation.id : \"\";\n\t\tvar citation = canonicalQuotation ? canonicalQuotation.citation : \"\";\n\n\t\t//var {quotation} = canonicalQuotation\n\n\t\treturn(\n\t\t\t<div className=\"container\">\n\t\t\t\t<p>Canonical Quotation: {displayQuotation}</p>\n\t\t\t\t<p>{citation}</p>\n\t\t\t\t<p><a href={displayQuotationId}>{displayQuotationId}</a></p>\n\t\t\t</div>\n\t\t)\n\t}\n}\n\nexport default connect(\n\t(state) => {\n\t\treturn state\n\t}\n)(CanonicalQuotation);\n","import React from 'react'\nimport $ from 'jquery';\nvar {connect} = require('react-redux');\nvar actions = require('../actions/actions');\n\n\n\nclass CanonicalQuotationListItem extends React.Component{\n\tconstructor(props){\n\t\tsuper(props)\n\t\tthis.handleOnClick = this.handleOnClick.bind(this)\n\t}\n\thandleOnClick(){\n\t\tvar {id, quotation, citation, dispatch} = this.props;\n\t\tdispatch(actions.changeCanonicalQuotationsFocus(this.props.id));\n\t\tvar quotationObject = {\n\t\t\tid,\n\t\t\tquotation,\n\t\t\tcitation\n\t\t}\n\t\tdispatch(actions.createCanonicalQuotation(quotationObject));\n\t\t// doesn't seem like the way to do it, because this dispatch might get of sync.\n\t\t//The second one requires the state to be set by the first\n\t\t// should be done in subscribe, but I'm not sure how yet\n\t\tdispatch(actions.fetchQuotations());\n\t\tdispatch(actions.clearQuotationsFocus());\n\t\tdispatch(actions.clearFocusedQuotation());\n\t\tdispatch(actions.clearManifestationQuotations());\n\t\tdispatch(actions.clearParagraph());\n\n\t\tvar selfTopPos = document.getElementById(id).offsetTop;\n\t\t$('#CanonicalQuotationList').animate({ scrollTop: selfTopPos-10 }, 400);\n\t}\n\trender(){\n    var {id, quotation, className, citation} = this.props\n    return(\n\t\t\t<div className=\"quotation-wrapper\">\n\t\t\t\t<p id={id} className={className} onClick={this.handleOnClick}>{quotation}</p>\n\t\t\t\t<a href={id} target=\"_blank\" className=\"quotation-citation\">{citation}</a>\n\t\t\t</div>\n\t\t)\n\t}\n}\n\nexport default connect()(CanonicalQuotationListItem);\n","import React from 'react';\nimport {connect} from 'react-redux'\nimport CanonicalQuotationListItem from \"./CanonicalQuotationListItem\"\n\nvar actions = require('../actions/actions');\n\nclass CanonicalQuotationList extends React.Component{\n\tconstructor(props){\n\t\tsuper(props)\n\t\tthis.handleOnShowQuotationsWithoutAssociation = this.handleOnShowQuotationsWithoutAssociation.bind(this)\n\t}\n\thandleOnShowQuotationsWithoutAssociation(e){\n\t\te.preventDefault();\n\t\tvar {dispatch} = this.props;\n\t\tvar searchText = this.refs.searchText.value;\n\n\t\tdispatch(actions.clearCanonicalQuotation());\n\t\tdispatch(actions.clearFocusedQuotation());\n\t\tdispatch(actions.clearParagraph());\n\t\t//dispatch(actions.clearCanonicalQuotationsFocus());\n\t\t//TODO change app so that searchText does need to be passed as parameters\n\t\t//but is retrieved from the searchState\n\t\tdispatch(actions.fetchCanonicalQuotations(searchText));\n\t\tdispatch(actions.fetchQuotations(searchText));\n\t\t//dispatch(actions.fetchManifestationQuotations(searchText));\n\t}\n\trender(){\n    var {canonicalQuotations} = this.props;\n\t\tvar renderQuotations = () => {\n      if (canonicalQuotations.length === 0){\n        return(\n            <p className=\"container__message\">No Quotations</p>\n        );\n      }\n\n      return canonicalQuotations.map( (quotation) => {\n\t\t\t\tvar quotationClass = quotation.focused ? \"quotation focused\" : \"quotation\"\n\t\t\t\t//var quotationClass = \"quotation\"\n        return (\n\t\t\t\t\t<CanonicalQuotationListItem className={quotationClass} key={quotation.id} {...quotation}/>\n        );\n      });\n    };\n\n\t\treturn(\n\t\t\t<div>\n\t\t\t\t<p>List of Canonical Quotations</p>\n\t\t\t\t<p>Count {canonicalQuotations.length}</p>\n\t\t\t\t{renderQuotations()}\n\t\t\t</div>\n\t\t)\n\t}\n}\n\nexport default connect(\n\t(state) => {\n\t\treturn state\n\t}\n)(CanonicalQuotationList);\n","import React from 'react'\nimport $ from 'jquery';\n\nimport Surface3Wrapper from '@bit/jeffreycwitt.lbp.surface3wrapper';\nimport Citation from '@bit/jeffreycwitt.lbp.citation';\n\nimport {FaInfo, FaRegImage} from 'react-icons/fa';\n\nvar {connect} = require('react-redux');\nvar actions = require('../actions/actions');\n\n\n\nclass ManifestationQuotationListItem extends React.Component{\n\tconstructor(props){\n\t\tsuper(props)\n\t\tthis.handleOnClick = this.handleOnClick.bind(this)\n\t\tthis.handleToggleShowImage = this.handleToggleShowImage.bind(this)\n\t\tthis.handleToggleShowCitation = this.handleToggleShowCitation.bind(this)\n\t\tthis.handleImageWrapperWraperClick = this.handleImageWrapperWraperClick.bind(this)\n\t\tthis.state = {\n      imageSize: \"200\",\n\t\t\timageFocus: false,\n\t\t\tshowImage: false,\n\t\t\tshowCitation: false\n    }\n\t}\n\thandleImageWrapperWraperClick(){\n    this.setState((prevState) => {\n      const imageSize = prevState.imageSize === \"200\" ? \"725\" : \"200\"\n      const imageFocus = prevState.imageFocus ? false : true\n      return{\n        imageSize,\n        imageFocus\n      }\n\t\t})\n\t}\n\thandleToggleShowImage(){\n\t\tconsole.log(\"test\")\n\t\tthis.setState((prevState) => {\n\t\t\treturn({\n\t\t\t\tshowImage: !prevState.showImage\n\t\t\t})\n\t\t})\n\t}\n\thandleToggleShowCitation(){\n\t\tthis.setState((prevState) => {\n\t\t\treturn({\n\t\t\t\tshowCitation: !prevState.showCitation\n\t\t\t})\n\t\t})\n\n\t}\n\thandleOnClick(){\n\t\tvar {isManifestationOf, id, quotation, dispatch} = this.props;\n\n\t\tvar newFocusedQuotationObject = {\n\t\t\tid,\n\t\t\tquotation,\n\t\t\ttype: \"manifestation\"\n\t\t}\n\t\tdispatch(actions.createFocusedQuotation(newFocusedQuotationObject));\n\n\t\tdispatch(actions.changeManifestationQuotationsFocus(id));\n\t\t//dispatch(actions.changeQuotationsFocus(isManifestationOf));\n\t\tdispatch(actions.fetchParagraph());\n\n\t\tvar topPos = document.getElementById(id).offsetTop;\n\t\t$('#ManifestationQuotationsList').animate({ scrollTop: topPos-10 }, 400);\n\n\t\t//synchronize other columns\n\t\tif (isManifestationOf != null){\n\t\t\t// create canonicalQuotation\n\t\t\tvar isManifestationOfObject = this.props.quotations.find((quotation) => {\n\t\t\t\treturn quotation.id === isManifestationOf;\n\n\t\t\t});\n\n\t\t\tif (isManifestationOfObject != undefined){\n\t\t\t\t//dispatch(actions.createCanonicalQuotation(canonicalQuotationObject));\n\t\t\t\t// focus canonicalquotation List Item\n\t\t\t\tdispatch(actions.changeQuotationsFocus(isManifestationOf));\n\t\t\t\t// scroll\n\t\t\t\tvar topPos = document.getElementById(isManifestationOf).offsetTop;\n\t\t\t\t$('#quotationsList').animate({ scrollTop: topPos-10 }, 400);\n\n\t\t\t\t//the following is repeated in quotation App; it should be abstracted and not repeated\n\t\t\t\tvar isInstanceOf = isManifestationOfObject.isInstanceOf\n\t\t\t\tif (isInstanceOf != null){\n\t\t\t\t\t// create canonicalQuotation\n\t\t\t\t\tvar canonicalQuotationObject = this.props.canonicalQuotations.find((quotation) => {\n\t\t\t\t\t\treturn quotation.id === isInstanceOf\n\n\t\t\t\t\t});\n\n\t\t\t\t\tif (canonicalQuotationObject != undefined){\n\t\t\t\t\t\tdispatch(actions.createCanonicalQuotation(canonicalQuotationObject));\n\t\t\t\t\t\t// focus canonicalquotation List Item\n\t\t\t\t\t\tdispatch(actions.changeCanonicalQuotationsFocus(isInstanceOf));\n\t\t\t\t\t\t// scroll\n\t\t\t\t\t\tvar topPos = document.getElementById(isInstanceOf).offsetTop;\n\t\t\t\t\t\t$('#CanonicalQuotationList').animate({ scrollTop: topPos-10 }, 400);\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\t//alert(\"this quotation is assigned to a canonicalQuotation, but either there is an error in the id assigned or a canonicalQuotation record still needs to be made\")\n\t\t\t\t\t\tdispatch(actions.clearCanonicalQuotationsFocus());\n\t\t\t\t\t\tdispatch(actions.clearCanonicalQuotation());\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t}\n\t\t\telse{\n\t\t\t\t//alert(\"this quotation is assigned to a canonicalQuotation, but either there is an error in the id assigned or a canonicalQuotation record still needs to be made\")\n\t\t\t\tdispatch(actions.clearQuotationsFocus());\n\t\t\t\tdispatch(actions.clearCanonicalQuotation());\n\t\t\t}\n\n\t\t}\n\t\telse{\n\t\t\tdispatch(actions.clearQuotationsFocus());\n\t\t\tdispatch(actions.clearCanonicalQuotationsFocus());\n\t\t\tdispatch(actions.clearCanonicalQuotation());\n\n\t\t}\n\n\n\t}\n\n\t\n\n\n\n\trender(){\n\t\tvar {id, quotation, className, canonicalTranscription} = this.props\n\t\tconst newManifestations = [{\n\t\t\tmanifestation: id,\n\t\t\tmanifestationTitle: id.split(\"/resource/\")[1],\n\t\t\ttranscription: \"\"\n\t\t}]\n    return(\n\t\t\t<div>\n\t\t\t\t<p id={id} className={className} onClick={this.handleOnClick}>{quotation} \n\t\t\t\t\t<a href={id} className=\"quotation-citation\">{id}</a>\n\t\t\t\t\t<span onClick={this.handleToggleShowImage}><FaRegImage/></span> \n\t\t\t\t\t<span onClick={this.handleToggleShowCitation}><FaInfo/></span>\n\t\t\t\t</p>\n\t\t\t\t<div id=\"mImageWrapperWrapper\" className={this.state.imageFocus ? \"iww-big\" : \"iww-small\"}>\n          \n\t\t\t\t\t{this.state.showImage &&\n\t\t\t\t\t<div>\n\t\t\t\t\t\t{this.state.imageFocus ? <hr className=\"toggleBar\" title=\"click to minimize\" onClick={this.handleImageWrapperWraperClick}/> : <hr className=\"toggleBar\" title=\"click to maximize\" onClick={this.handleImageWrapperWraperClick}/>}\n\t\t\t\t\t\t<Surface3Wrapper\n\t\t\t\t\t\tmanifestations={newManifestations}\n\t\t\t\t\t\tfocusedManifestation={id}\n\t\t\t\t\t\twidth={this.state.imageSize}\n\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t{this.state.showCitation && canonicalTranscription &&\n\t\t\t\t\t\t\t/* could add citation here (perhaps in hidden drop down) */\n\t\t\t\t\t\t<Citation tresourceid={canonicalTranscription}/>\n\t\t\t\t\t\t}\n\t\t\t\t\t</div>\n\t\t\t\t\t\n\t\t\t</div>\n\t\t)\n\t}\n}\n\nexport default connect(\n\t(state) => {\n\t\treturn state\n\t}\n)(ManifestationQuotationListItem);\n","import React from 'react'\nimport {connect} from 'react-redux';\n\n\nimport ManifestationQuotationListItem from \"./ManifestationQuotationListItem\"\nvar actions = require('../actions/actions');\n\nclass ManifestationQuotationList extends React.Component{\n\trender(){\n    var {manifestationQuotations} = this.props;\n    var renderQuotations = () => {\n      if (manifestationQuotations.length === 0){\n        return(\n            <p className=\"container__message\">No Quotations</p>\n        );\n      }\n\n      return manifestationQuotations.map( (quotation) => {\n\t\t\t\tvar quotationClass = quotation.focused ? \"quotation focused\" : \"quotation\"\n\t\t\t\t//var quotationClass = \"quotation\"\n        return (\n\n          <ManifestationQuotationListItem className={quotationClass} key={quotation.id} {...quotation}/>\n        );\n      });\n    };\n\n\t\treturn(\n\t\t\t<div>\n\t\t\t\t<p>List of Manifestation Quotations</p>\n        <p>Count {manifestationQuotations.length}</p>\n        {renderQuotations()}\n\t\t\t</div>\n\t\t)\n\t}\n}\n\nexport default connect(\n\t(state) => {\n\t\treturn state\n\t}\n)(ManifestationQuotationList);\n","import React from 'react';\nimport cetei from \"../vendor/CETEI\"\nimport Surface3Wrapper from '@bit/jeffreycwitt.lbp.surface3wrapper';\nimport Citation from '@bit/jeffreycwitt.lbp.citation';\n//import {FaExpand, FaCompress} from 'react-icons/fa';\nvar {connect} = require('react-redux');\nvar actions = require('../actions/actions');\n\n//import CETEI from '../../node_modules/CETEIcean/src/CETEI';\n\n\n\n\n\nclass Paragraph extends React.Component{\n  constructor(props){\n    super(props)\n    this.handleShowImages = this.handleShowImages.bind(this)\n    this.handleImageWrapperWraperClick = this.handleImageWrapperWraperClick.bind(this)\n    this.handleShowFullText = this.handleShowFullText.bind(this)\n    this.runQueryForSource = this.runQueryForSource.bind(this)\n    this.addTEICustom = this.addTEICustom.bind(this)\n    this.handleClearFilters = this.handleClearFilters\n    this.state = {\n      imageSize: \"200\",\n      imageFocus: false\n    }\n  }\n  handleImageWrapperWraperClick(){\n    this.setState((prevState) => {\n      const imageSize = prevState.imageSize === \"200\" ? \"725\" : \"200\"\n      const imageFocus = prevState.imageFocus ? false : true\n      return{\n        imageSize,\n        imageFocus\n      }\n    })\n\n\n  }\n  handleShowImages(e){\n    e.preventDefault();\n    var {dispatch} = this.props;\n    dispatch(actions.fetchImages());\n    dispatch(actions.toggleImagesDisplay(this.props.images.visible));\n  }\n  handleShowFullText(e){\n    e.preventDefault();\n    var {dispatch} = this.props;\n    if (this.props.type === \"source\"){\n      dispatch(actions.fetchFullText(true));\n    }\n    else{\n      dispatch(actions.fetchFullText(false));\n    }\n    dispatch(actions.toggleImagesDisplay(true));\n    dispatch(actions.toggleFullTextDisplay(this.props.fullText.visible));\n  }\n  componentDidMount(e){\n    var _this = this;\n    this.addTEICustom()\n  }\n  componentDidUpdate(e){\n    var _this = this;\n    this.addTEICustom()\n  }\n  addTEICustom(){\n    var _this = this;\n    const htmlText = new cetei()\n    let paragraph = {}\n    if (this.props.type === \"source\"){\n      paragraph = this.props.sourceParagraph;\n    }\n    else{\n      paragraph = this.props.paragraph;\n    }\n    if (paragraph.paragraph_text){\n      htmlText.makeHTML5(paragraph.paragraph_text, function(data){\n        // get id of quote\n        if (_this.props.focusedQuotation.id){\n          const quoteid = _this.props.focusedQuotation.id.split(\"/\").pop();\n          // find quote in text if there and change class to highlighted\n          if (data.querySelector(\"#\" + quoteid)){\n            data.querySelector(\"#\" + quoteid).setAttribute(\"class\", \"highlighted\");\n          }\n          //load text in div\n          _this.refs.text.replaceChild(data, _this.refs.text.childNodes[0]);\n        }\n\n      });\n    }\n    else{\n      const emptyTextNode = document.createTextNode(\"\");\n      _this.refs.text.replaceChild(emptyTextNode, _this.refs.text.childNodes[0]);\n    }\n  }\n  runQueryForSource(sourceId){\n\n    var {dispatch, search} = this.props;\n\n    var quotationWorkPart = sourceId\n\n\n\n    var searchParameters = {\n      quotationWorkPart\n    }\n    // clear search parameters\n    this.handleClearFilters()\n\t\t// set new search parameters\n    dispatch(actions.setSearchParameters(searchParameters));\n\t\t// (ideally after the handleClearFilters has finished) set search parameters to include quotationWorkPart\n\t\tdispatch(actions.fetchQuotationWorkParts());\n\t\t// fetch quotations based on the source part id\n\t\tdispatch(actions.fetchQuotations());\n\t\t//fetch chart to match new query\n\t\t// TODO: seems like it would be better for chart fetch only when view is requested\n    dispatch(actions.fetchChart());\n\n  }\n\t//TODO: this function is mostly a repeat of the clearFilters function in the Search component\n\t//this seems like an unnecessary redundancy; perhaps this can become a generic action or common utility function\n  handleClearFilters(e){\n\n    var {dispatch, search} = this.props;\n    dispatch(actions.clearSearchParameters());\n    dispatch(actions.clearCanonicalQuotations());\n    dispatch(actions.clearQuotations());\n\t\tdispatch(actions.fetchQuotationWorkParts());\n    dispatch(actions.fetchExpressionParts());\n    //dispatch(actions.fetchCanonicalQuotations());\n    dispatch(actions.fetchQuotationAuthors());\n    dispatch(actions.fetchExpressionAuthors());\n    dispatch(actions.fetchSearchWorksList());\n    //store.dispatch(actions.fetchExpressionTypes());\n    dispatch(actions.fetchQuotationWorksList());\n    dispatch(actions.fetchWorkGroups());\n    dispatch(actions.fetchAuthorTypes());\n    //dispatch(actions.fetchManifestationQuotations(searchText, quotationType, expressionId));\n    dispatch(actions.clearManifestationQuotations());\n\n    // date refs won't clear until place for them in the store has been created\n\t    // this.refs.quotationAuthorDateAfter.value = \"\";\n\t    // this.refs.quotationAuthorDateBefore.value = \"\";\n\t    // this.refs.expressionAuthorDateAfter.value = \"\";\n\t    // this.refs.expressionAuthorDateBefore.value = \"\";\n\t\t\t//this.refs.searchText.value = \"\";\n\n\n\n  }\n  render(){\n    var _this = this;\n    let paragraph = {}\n    if (this.props.type === \"source\"){\n      paragraph = this.props.sourceParagraph;\n    }\n    else{\n      paragraph = this.props.paragraph;\n    }\n    //var {paragraph} = this.props;\n    var {expression_id, manifestation_id, transcription_id, manifestations, paragraph_text, review} = paragraph\n    // var domParser = new DOMParser();\n    // var xsltProcessor = new XSLTProcessor();\n    //\n    // var xsltText = '<?xml version=\"1.0\" encoding=\"UTF-8\"?><xsl:stylesheet xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\"  xmlns:xs=\"http://www.w3.org/2001/XMLSchema\"  exclude-result-prefixes=\"xs\"  version=\"1.0\" xmlns:tei=\"http://www.tei-c.org/ns/1.0\">  <xsl:output method=\"html\"/>  <xsl:template match=\"/\">    <xsl:apply-templates select=\"//tei:body\"/>  </xsl:template>  <xsl:template match=\"tei:p\">      <xsl:apply-templates/>    </xsl:template>  <xsl:template match=\"tei:quote\">    \"<xsl:apply-templates/>\"  </xsl:template>  <xsl:template match=\"tei:rdg\">      </xsl:template>  <xsl:template match=\"tei:note\">      </xsl:template>  <xsl:template match=\"tei:bibl\">      </xsl:template>  <xsl:template match=\"tei:reg\">      </xsl:template>  <xsl:template match=\"tei:corr\">      </xsl:template>  </xsl:stylesheet>';\n    // var xsltDoc = domParser.parseFromString(xsltText, \"text/xml\");\n    // xsltProcessor.importStylesheet(xsltDoc);\n    //\n    // var xmlText = paragraph_text;\n    // var xmlDoc = domParser.parseFromString(xmlText, \"text/xml\");\n    // var fragment = xsltProcessor.transformToFragment(xmlDoc, document);\n    //\n    // var parent = document.createElement(\"div\");\n    // parent.appendChild(fragment);\n    // var text =  parent.innerHTML;\n\n    function showImageToggle(){\n\n      if (paragraph.expression_id){\n        return(\n          <p>\n            <a onClick={_this.handleShowImages}>Toggle Image</a>\n          </p>\n        )\n      }\n\n    }\n    function showFullTextToggle(){\n\n      if (paragraph.expression_id){\n        return(\n          <p>\n            <a onClick={_this.handleShowFullText}>Show Full Text</a>\n          </p>\n        )\n      }\n\n    }\n\n    function showReview(){\n      if (review){\n        var reviewLink  = \"https://dll-review-registry.scta.info/reviews/\" + review[\"id\"] + \".html\";\n        var ipfsGatewayLink  = \"https://gateway.scta.info/ipfs/\" + review[\"ipfs-hash\"];\n        return(\n          <p>\n            <a href={reviewLink} target=\"_blank\"><img src={review[\"badge-url\"]}/></a> Content extracted from reviewed data source <a href={ipfsGatewayLink} target=\"_blank\">{review[\"ipfs-hash\"]}</a>\n          </p>\n        )\n      }\n    }\n    function showLbpLink(){\n\n    }\n    let newManifestations = []\n    if (manifestations && manifestations.constructor === Array) {\n      newManifestations = manifestations.map((m) => {\n        return {\n          manifestation: m,\n          manifestationTitle: m.split(\"/resource/\")[1],\n          transcription:\"\"\n        }\n      })\n    }\n    else if (typeof manifestations === \"string\")\n    {\n      newManifestations = [{\n        manifestation: manifestations,\n        manifestationTitle: manifestations.split(\"/resource/\")[1],\n        transcription:\"\"\n      }]\n    }\n    return(\n\n\n      <div>\n        <p>Context Paragraph</p>\n        <div id=\"text\" ref=\"text\"><div/></div>\n        {manifestation_id &&\n          <div id=\"imageWrapperWrapper\" className={this.state.imageFocus ? \"iww-big\" : \"iww-small\"}>\n          {this.state.imageFocus ? <hr className=\"toggleBar\" title=\"click to minimize\" onClick={this.handleImageWrapperWraperClick}/> : <hr className=\"toggleBar\" title=\"click to maximize\" onClick={this.handleImageWrapperWraperClick}/>}\n          <Surface3Wrapper\n           manifestations={newManifestations}\n           focusedManifestation={manifestation_id}\n           width={this.state.imageSize}\n         />\n         </div>\n          //showImageToggle()\n        }\n        {showFullTextToggle()}\n        {manifestation_id && <p><a href={\"https://scta.lombardpress.org/#/text?resourceid=\" + manifestation_id} target=\"_blank\">View in LbpWeb</a></p>}\n        {\n        //  showReview()\n        }\n        {(this.props.type === \"source\" && this.props.focusedQuotation.id) && <p className=\"link\" onClick={() => {this.runQueryForSource(this.props.sourceParagraph.expression_id.split(\"/resource/\")[1])}}>Search Quotations of this Passage Only</p>}\n        {\n          // no longer needed since citation component is in place\n          //manifestation_id && <p><a href={manifestation_id}>{manifestation_id}</a></p>\n        }\n        {manifestation_id && <Citation tresourceid={transcription_id}/>}\n      </div>\n    )\n  }\n}\n\nexport default connect(\n  (state) => {\n    return state\n  }\n)(Paragraph);\n","import React, { Component } from 'react'\nvar {connect} = require('react-redux');\n// import { scaleLinear } from 'd3-scale';\n// import { max } from 'd3-array';\n// import { select } from 'd3-selection';\nvar d3 = require(\"d3\");\nvar actions = require('../actions/actions');\n\n\n\n\n\nclass BarChart extends React.Component {\n   constructor(props){\n      super(props)\n      this.createBarChart = this.createBarChart.bind(this)\n  }\n   componentDidMount() {\n     var count = this.props.chart.count;\n     if (count){\n      this.createBarChart(count)\n      }\n   }\n   componentDidUpdate(prevProps, prevState) {\n     var count = this.props.chart.count;\n     if (count != prevProps.chart.count){\n       this.createBarChart(count)\n     }\n   }\n   componentWillUnmount(){\n     d3.selectAll(\".tooltip\").remove();\n   }\n   createBarChart(count) {\n     var svg = d3.select(\"svg\");\n     svg.selectAll(\"*\").remove();\n     d3.selectAll(\".tooltip\").remove();\n\n\n  //    console.log(\"value in createBarChart\", count)\n  //     const node = this.node\n  //     //const dataMax = max(this.props.data)\n  //     const dataMax = max(count)\n  //     const yScale = scaleLinear()\n  //        .domain([0, dataMax])\n  //        .range([0, this.props.size[1]])\n  //  select(node)\n  //     .selectAll('rect')\n  //     //.data(this.props.data)\n  //     .data(count)\n  //     .enter()\n  //     .append('rect')\n   //\n  //  select(node)\n  //     .selectAll('rect')\n  //     //.data(this.props.data)\n  //     .data(count)\n  //     .exit()\n  //     .remove()\n   //\n  //  select(node)\n  //     .selectAll('rect')\n  //     //.data(this.props.data)\n  //     .data(count)\n  //     .style('fill', '#fe9922')\n  //     .attr('x', (d,i) => i * 25)\n  //     .attr('y', d => this.props.size[1] - yScale(d))\n  //     .attr('height', d => yScale(d))\n  //     .attr('width', 25)\n  //  }\n  var data = count\n\n  //above is working chart\n\n  // below is new attempted chart\n  //data.sort(sort)\n\t\t//this filter is required to make sure count is recognized as integers not strings\n\t\t// see: http://stackoverflow.com/questions/10709950/get-the-real-max-of-an-array-in-d3\n\n\tdata.filter(function(d,i) {\n\t  d.count = +d.count;\n\t});\n\n\tvar countArray = [];\n\tvar titleArray = [];\n\n  countArray = data.map(function(d){\n    return d.count\n  });\n  // for (x in data){\n\t// \tcountArray.push(data[x].count);\n  //\n\t// };\n  titleArray = data.map(function(d){\n    return d.title\n  });\n\t// for (x in data){\n\t// \ttitleArray.push(data[x].title);\n\t// };\n\n\tvar margin = {top: 30, right: 30, bottom: 40, left: 50}\n\tvar height = 500 - margin.top - margin.bottom,\n\twidth = 1200 - margin.left - margin.right;\n\t//barWidth = 50,\n\t//barOffset = 5;\n\n\tvar colors = d3.scale.linear()\n\t\t.domain([0, data.length*.80,  data.length])\n\t\t.range(['#FFB832', '#C61C6F']);\n\n\n\t//var xScale = d3.scale.linear()\n\t\t//.domain([0, d3.max(countArray)])\n\t\t//.range([0, height]);\n\n\t//var yScale = d3.scale.ordinal()\n\t\t//.domain(d3.range(0, data.length))\n\t\t//.rangeBands([0, height])\n\n\tvar yScale = d3.scale.linear()\n\t\t.domain([0, d3.max(countArray)])\n\t\t.range([0, height]);\n\n\tvar xScale = d3.scale.ordinal()\n\t\t.domain(d3.range(0, data.length))\n\t\t.rangeBands([0, width], .5)\n\n\n\n\n\tvar tooltip = d3.select('body').append('div')\n\t\t.attr('class', 'tooltip')\n\t\t.style('position', 'absolute')\n\t\t.style('padding', '0 10px')\n\t\t.style('background', 'white')\n\t\t.style('opacity', 0)\n\n    const node = this.node\n    //var canvas = d3.select(\"div#\" + chart).append(\"svg\")\n    var canvas = d3.select(node)\n      //.attr(\"id\", chart)\n\t\t//.style('background', '#E7E0CB')\n\t\t.attr('width', width + margin.left + margin.right)\n\t\t.attr('height', height + margin.top + margin.bottom)\n\t\t.append(\"g\")\n\t\t.attr('transform', 'translate(' + margin.left + ', ' + margin.top +')')\n\t\t.selectAll(\"rect\")\n\t\t\t.data(data)\n\t\t\t.enter()\n\t\t\t.append(\"g\")\n\t\t\t\t.append(\"rect\")\n\t\t\t\t\t.style('fill', function(d,i){\n\t\t\t\t\t\treturn colors(i);\n\t\t\t\t\t})\n\t\t\t\t\t.attr('height', 0)\n\t\t\t\t\t.attr('y', height)\n\t\t\t\t\t.attr(\"width\", xScale.rangeBand())\n\t\t\t\t\t.attr(\"x\", function (d,i) {return xScale(i);})\n\n\n\t\t\t\t\t.on('mouseover', function(d) {\n\t\t\t\t\t\ttooltip.transition()\n\t\t\t\t\t\t\t.style('opacity', .9)\n\n\t\t\t\t\t\ttooltip.html(\"<a href='\" + d.item + \"'>\" + d.title + \"</a>. Quoted \" + d.count + \" times\")\n\t\t\t\t\t\t\t.style('left', (d3.event.pageX + 0) + 'px')\n\t\t\t\t\t\t\t.style('top', (d3.event.pageY + 0) + 'px')\n\t\t\t\t\t\t\t.style('left', d3.select(node).left + 150 + 'px')\n\t\t\t\t\t\t\t.style('top', d3.select(node).top + 125 + 'px')\n\n\t\t\t\t\t\t\td3.select(this)\n\t\t\t\t\t\t\t\t.style('opacity', .5);\n\t\t\t\t\t})\n\t\t\t\t\t.on('mouseout', function(d) {\n\t\t\t\t\t\t//tooltip.transition().style('opacity', 0)\n\t\t\t\t\t\td3.select(this)\n\t\t\t\t\t\t\t.transition()\n\t\t\t\t\t\t\t.style('opacity', 1);\n\t\t\t\t\t})\n\n\n\t\t//canvas.transition()\n    canvas.transition()\n\t\t\t.attr(\"height\", function (d) {return yScale(d.count)})\n\t\t\t.attr(\"y\", function(d) { return height - yScale(d.count) })\n\t\t\t.delay(function(d,i){return i * 10})\n\t\t\t.duration(1000)\n\t\t\t.ease('elastic')\n\n\t\t\tvar vGuideScale = d3.scale.linear()\n\t\t\t\t.domain([0, d3.max(countArray)])\n\t\t\t\t.range([height, 0])\n\n\t\t\tvar vAxis = d3.svg.axis()\n\t\t\t\t.scale(vGuideScale)\n\t\t\t\t.orient('left')\n\t\t\t\t.ticks(10)\n\t\t\tvar vGuide = d3.select(node).append('g')\n\t\t\t\tvAxis(vGuide)\n\t\t\t\tvGuide.attr('transform', 'translate('+ margin.left+', '+margin.top + ')')\n\t\t\t\tvGuide.selectAll('path')\n\t\t\t\t\t.style({fill: 'none', stroke: \"#000\"})\n\t\t\t\tvGuide.selectAll('line')\n\t\t\t\t\t.style({ stroke: \"#000\"})\n\n\t\t\t//var horizontalGuideScale = d3.scale.ordinal()\n\t\t\t\t//.domain([0, d3.max(countArray)])\n\t\t\t\t//.range([height, 0])\n\n\t\t\tvar hAxis = d3.svg.axis()\n\t\t\t\t.scale(xScale)\n\t\t\t\t.orient('bottom')\n\t\t\t\t.tickValues(xScale.domain().filter(function(d, i){\n\t\t\t\t\treturn i % 50 === 0\n\t\t\t\t}\n\t\t\t\t));\n\n        var hGuide = d3.select(node).append('g')\n\t\t\t\thAxis(hGuide)\n\t\t\t\thGuide.attr('transform', 'translate('+ margin.left+', '+ (height + margin.top) + ')')\n\t\t\t\thGuide.selectAll('path')\n\t\t\t\t\t.style({fill: 'none', stroke: \"#000\"})\n\t\t\t\thGuide.selectAll('line')\n\t\t\t\t\t.style({ stroke: \"#000\"})\n\t\t}\nrender() {\n      return(\n          <svg ref={node => this.node = node}\n          width={500} height={500}>\n          </svg>\n\n\n    )\n   }\n}\n//module.exports = BarChart;\n\n// export default connect(\n// \t(state) => {\n// \t\treturn state\n// \t}\n// )(BarChart);\n\nconst mapStateToProps = state => (\n  {\n    chart: state.chart,\n  }\n);\n\nconst mapDispatchToProps = dispatch => ({\n\n});\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps,\n)(BarChart);\n","import React, { Component } from 'react'\nimport Surface3Wrapper from '@bit/jeffreycwitt.lbp.surface3wrapper';\nimport CitationExplanation from '@bit/jeffreycwitt.lbp.citation-explanation'\nvar {connect} = require('react-redux');\nvar actions = require('../actions/actions');\nvar cetei = require(\"../vendor/CETEI\");\n\n\n\n\n\nclass Images extends React.Component {\n   constructor(props){\n      super(props)\n      this.handleToggleImage = this.handleToggleImage.bind(this)\n\n  }\n   componentDidMount() {\n\n   }\n   componentDidUpdate(count) {\n\n   }\n   handleToggleImage(e){\n    e.preventDefault();\n    var {dispatch} = this.props;\n \t\tdispatch(actions.toggleImagesDisplay(this.props.images.visible));\n\n   }\n   render(){\n     var _this = this;\n     function showImages(){\n       var images = _this.props.images;\n       if (images.visible && images.images.length > 0){\n         return images.images.map(function(image){\n           var imageUrl = image.url;\n           return(\n             <img src={imageUrl + \"/full/1000,/0/default.jpg\"}/>\n           )\n           }\n         )\n\n       }\n     }\n     const manifestations = [{\n         manifestation: \"http://scta.info/resource/l1-cpspfs/reims\",\n         manifestationTitle: \"reims\",\n         transcription: \"\"\n       },\n       {\n         manifestation: \"http://scta.info/resource/l1-cpspfs/svict\",\n         manifestationTitle: \"svict\",\n         transcription: \"\"\n       },\n     ]\n     return(\n       <div className=\"images\">\n       <Surface3Wrapper\n        manifestations={manifestations}\n        focusedManifestation={\"http://scta.info/l1-cpspfs/reims\"}\n      />\n         {showImages()}\n       </div>\n     )\n   }\n }\n//module.exports = BarChart;\n\nexport default connect(\n\t(state) => {\n\t\treturn state\n\t}\n)(Images);\n","import React, { Component } from 'react'\nimport $ from 'jquery';\nimport cetei from \"../vendor/CETEI\"\nvar {connect} = require('react-redux');\nvar actions = require('../actions/actions');\n\n//var cetei = require(\"../vendor/CETEI\");\n\n\nclass FullText extends React.Component {\n   constructor(props){\n      super(props)\n      this.handleToggleFullText = this.handleToggleFullText.bind(this)\n\n  }\n  componentDidUpdate() {\n    var _this = this;\n\t\tconst htmlText = new cetei()\n\t\tif (this.props.fullText.textInfo.text){\n\t\t\thtmlText.makeHTML5(this.props.fullText.textInfo.text, function(data){\n\t\t\t\t// get id of quote\n\t\t\t\tconst quoteid = _this.props.focusedQuotation.id.split(\"/\").pop();\n        const sourceid = _this.props.focusedQuotation.source.split(\"/\").pop();\n\n\t\t\t\t//load text in div\n\t\t\t\t_this.refs.text.replaceChild(data, _this.refs.text.childNodes[0]);\n        let selfTopPos = \"\"\n        try{\n          // find quote in text if there and change class to highlighted\n  \t\t\t\tif (data.querySelector(\"#\" + quoteid)){\n  \t\t\t\t\tdata.querySelector(\"#\" + quoteid).setAttribute(\"class\", \"highlighted\");\n  \t\t\t\t}\n          selfTopPos = document.getElementById(quoteid).offsetTop;\n        }\n        catch(e){\n          // find quote in text if there and change class to highlighted\n  \t\t\t\tif (data.querySelector(\"#\" + sourceid)){\n  \t\t\t\t\tdata.querySelector(\"#\" + sourceid).setAttribute(\"class\", \"highlighted\");\n  \t\t\t\t}\n          selfTopPos = document.getElementById(sourceid).offsetTop;\n        }\n\n        console.log(\"scroll\", selfTopPos);\n        $(\".full-text-wrapper\").animate({ scrollTop: selfTopPos-100 }, 400);\n\n\t\t\t});\n\t\t}\n\n\n  }\n  handleToggleFullText(e){\n    e.preventDefault();\n    var {dispatch} = this.props;\n \t\tdispatch(actions.toggleFullTextDisplay(this.props.fullText.visible));\n\n  }\n  render(){\n     var _this = this;\n\n     return(\n       <div className=\"full-text-wrapper\">\n         <div id=\"text-tool-bar\">\n           <button id=\"hide-full-text\" onClick={this.handleToggleFullText}>Hide Text</button>\n         </div>\n         <div id=\"text\" ref=\"text\"><div/>\n       </div>\n\n       </div>\n     )\n   }\n }\n\n//module.exports = BarChart;\n\nexport default connect(\n\t(state) => {\n\t\treturn state\n\t}\n)(FullText);\n","import React from 'react';\nimport {connect} from 'react-redux';\n\n\n\n\n\n//var actions = require('actions');\nimport Search from \"./Search\";\nimport QuotationList from \"./QuotationList\";\nimport FocusedQuotation from \"./FocusedQuotation\";\nimport CanonicalQuotation from \"./CanonicalQuotation\";\nimport CanonicalQuotationList from \"./CanonicalQuotationList\";\nimport ManifestationQuotationList from \"./ManifestationQuotationList\";\nimport Paragraph from \"./Paragraph\";\nimport BarChart from \"./BarChart\";\nimport Images from \"./Images\";\nimport FullText from \"./FullText\";\n\nclass TodoApp extends React.Component{\n\trender(){\n\t\tvar _this = this;\n\t\tfunction barGraphDisplay(){\n\t\t\tif (_this.props.chart.visible){\n\t\t\t\treturn(\n\t\t\t\t\t<div className=\"chart\">\n\t\t\t\t\t\t<BarChart size={[500,500]}/>\n\t\t\t\t\t</div>\n\t\t\t\t)\n\t\t\t}\n    }\n\t\tfunction imagesDisplay(){\n\t\t\tif (_this.props.images.visible){\n\t\t\t\treturn(\n\t\t\t\t\t<div>\n\t\t\t\t\t<Images/>\n\t\t\t\t\t\t<div className=\"column5\">\n\t\t\t\t\t\t\t<Paragraph/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t)\n\t\t\t}\n    }\n\t\tfunction fullTextDisplay(){\n\t\t\tif (_this.props.fullText.visible){\n\t\t\t\treturn(\n\t\t\t\t\t<FullText/>\n\t\t\t\t)\n\t\t\t}\n    }\n\t\tfunction quotationDisplay(){\n\t\t\tif (!_this.props.chart.visible && !_this.props.images.visible && !_this.props.fullText.visible){\n\t\t\t\treturn(\n\t\t\t\t\t<div>\n\t\t\t\t\t<div id=\"quotationsList\" className=\"column2\">\n\t\t\t\t\t\t<QuotationList/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div id=\"ManifestationQuotationsList\" className=\"column3\">\n\t\t\t\t\t\t<ManifestationQuotationList/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"column4\">\n\t\t\t\t\t\t<Paragraph/>\n\t\t\t\t\t\t{/* <FocusedQuotation/>\n\t\t\t\t\t\t<CanonicalQuotation/> */}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"column5\">\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t//<CanonicalQuotationList/>\n\t\t\t\t\t\t\t<Paragraph type=\"source\"/>\n\t\t\t\t\t\t}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t)\n\t\t\t}\n    }\n\t\treturn (\n\t\t\t<div>\n\t\t\t\t<div className=\"wrapper\">\n\t\t\t\t\t<div className='search column1'>\n\t\t\t\t\t\t<Search/>\n\t\t\t\t\t</div>\n\t\t\t\t\t{quotationDisplay()}\n\t\t\t\t\t{barGraphDisplay()}\n\t\t\t\t\t{imagesDisplay()}\n\t\t\t\t\t{fullTextDisplay()}\n\n\t\t\t\t</div>\n\n\t\t\t</div>\n\t\t)\n\t}\n}\n\n//module.exports = ;\nexport default connect(\n  (state) => {\n\t\treturn state\n\t}\n)(TodoApp);\n","import React from \"react\";\nimport TodoApp from \"./TodoApp\";\n\nvar Main = (props) => {\n\treturn(\n\t\t\t<div>\n        <h3 className='page-title'><em>Ad fontes</em>: A Scholastic Quotation Explorer</h3>\n\t\t\t\t<div className='page-header'>\n\t\t\t\t\t<p>A <a href=\"http://lombardpress.org\">LombardPress</a> Publication</p>\n\t\t\t\t\t<p>Powerd by Data from the <a href=\"https://scta.info\">Scholastic Commentaries and Text Archive</a></p>\n\t\t\t\t\t<p>Designed by <a href=\"http://jeffreycwitt.com\">Jeffrey C. Witt</a></p>\n        </div>\n        <TodoApp/>\n\t\t\t</div>\n\t\t);\n}\n\nexport default Main;\n","import React from \"react\"\nimport ReactDOM from \"react-dom\"\nimport {Provider} from \"react-redux\"\n//import {Route, Router, IndexRoute, hashHistory} from \"react-router\"\n\nimport TodoApp from \"./components/TodoApp\"\n//var BarChart = require(\"BarChart\");\nimport BarChart from './components/BarChart'\nimport Main from './components/Main'\n\nimport {setSearchParameters, fetchQuotationAuthors, fetchExpressionAuthors, fetchSearchWorksList, fetchExpressionTypes, fetchQuotationExpressionTypes, fetchQuotationWorksList, fetchWorkGroups, fetchAuthorTypes, fetchChart} from './actions/actions'\nimport 'bootstrap/dist/css/bootstrap.css'\nimport './styles/app.scss';\nvar store = require(\"./store/configureStore\").configure();\n\n\n\nstore.subscribe(() => {\n\tvar state = store.getState();\n\n});\n\n//var state = store.getState();\n\nstore.dispatch(setSearchParameters({}));\n//store.dispatch(actions.fetchCanonicalQuotations());\nstore.dispatch(fetchQuotationAuthors());\nstore.dispatch(fetchExpressionAuthors());\nstore.dispatch(fetchSearchWorksList());\nstore.dispatch(fetchExpressionTypes());\nstore.dispatch(fetchQuotationExpressionTypes());\nstore.dispatch(fetchQuotationWorksList());\nstore.dispatch(fetchWorkGroups());\nstore.dispatch(fetchAuthorTypes());\nstore.dispatch(fetchChart());\n\n\n\n\n// load foundation\n//$(document).foundation();\n\n// App css\n\n//require('style!css!sass!applicationStyles')\n//$(document).foundation();\n\nReactDOM.render(\n\t<Provider store={store}>\n\t\t<Main/>\n\t</Provider>,\n\tdocument.getElementById('root')\n);\n","export var searchReducer = (state = {}, action) => {\n  switch (action.type){\n    case 'CLEAR_SEARCH_PARAMETERS':\n      return {\n        ...state,\n        searchParameters: []\n        }\n    case 'SET_SEARCH_PARAMETERS':\n      return {\n        ...state,\n        searchParameters: action.searchParameters\n        }\n    case 'START_SEARCH_WORKS_FETCH':\n        return {\n          ...state,\n          searchWorks: []\n        }\n    case 'COMPLETE_SEARCH_WORKS_FETCH':\n      return {\n        ...state,\n        searchWorks: action.listOfWorks\n      }\n    case 'START_QUOTATION_AUTHORS_FETCH':\n        return {\n          ...state,\n          quotationAuthors: []\n        }\n    case 'COMPLETE_QUOTATION_AUTHORS_FETCH':\n      return {\n        ...state,\n        quotationAuthors: action.authors\n      }\n    case 'START_EXPRESSION_AUTHORS_FETCH':\n        return {\n          ...state,\n          expressionAuthors: []\n        }\n    case 'COMPLETE_EXPRESSION_AUTHORS_FETCH':\n      return {\n        ...state,\n        expressionAuthors: action.authors\n      }\n    case 'START_QUOTATION_WORKS_LIST_FETCH':\n        return {\n          ...state,\n          quotationWorksList: []\n        }\n    case 'COMPLETE_QUOTATION_WORKS_LIST_FETCH':\n      return {\n        ...state,\n        quotationWorksList: action.quotationWorksList\n      }\n    case 'START_QUOTATION_WORK_PARTS_FETCH':\n      return {\n        ...state,\n        quotationWorkParts: []\n      }\n    case 'COMPLETE_QUOTATION_WORK_PARTS_FETCH':\n      return {\n        ...state,\n        quotationWorkParts: action.parts\n      }\n    case 'START_EXPRESSION_PARTS_FETCH':\n      return {\n        ...state,\n        expressionParts: []\n      }\n    case 'COMPLETE_EXPRESSION_PARTS_FETCH':\n      return {\n        ...state,\n        expressionParts: action.parts\n      }\n    case 'START_EXPRESSION_TYPE_FETCH':\n        return {\n          ...state,\n          expressionTypes: []\n        }\n    case 'COMPLETE_EXPRESSION_TYPE_FETCH':\n      return {\n        ...state,\n        expressionTypes: action.expressionTypes\n      }\n    case 'START_QUOTATION_EXPRESSION_TYPE_FETCH':\n        return {\n          ...state,\n          quotationExpressionTypes: []\n        }\n    case 'COMPLETE_QUOTATION_EXPRESSION_TYPE_FETCH':\n      return {\n        ...state,\n        quotationExpressionTypes: action.quotationExpressionTypes\n      }\n    case 'START_WORK_GROUPS_FETCH':\n        return {\n          ...state,\n          workGroups: []\n        }\n    case 'COMPLETE_WORK_GROUPS_FETCH':\n      return {\n        ...state,\n        workGroups: action.workGroups\n      }\n    case 'START_AUTHOR_TYPES_FETCH':\n        return {\n          ...state,\n          authorTypes: []\n        }\n    case 'COMPLETE_AUTHOR_TYPES_FETCH':\n      return {\n        ...state,\n        authorTypes: action.authorTypes\n      }\n    default:\n      return state\n  };\n};\n","export var chartReducer = (state = {}, action) => {\n  switch (action.type){\n    case 'TOGGLE_GRAPH_DISPLAY':\n        return {\n          ...state,\n          visible: !action.current\n        }\n    case 'START_CHART_FETCH':\n        return {\n          ...state,\n          count: []\n        }\n    case 'COMPLETE_CHART_FETCH':\n      return {\n        ...state,\n        count: action.count\n      }\n    default:\n      return state\n  };\n};\n","export var imagesReducer = (state = {}, action) => {\n  switch (action.type){\n    case 'TOGGLE_IMAGES_DISPLAY':\n        return {\n          ...state,\n          visible: !action.current\n        }\n    // case 'TOGGLE_GRAPH_DISPLAY':\n    //   return {\n    //     ...state,\n    //     visible: false\n    //   }\n    case 'START_IMAGES_FETCH':\n        return {\n          ...state,\n          images: []\n        }\n    case 'COMPLETE_IMAGES_FETCH':\n      return {\n        ...state,\n        images: action.images\n      }\n    default:\n      return state\n  };\n};\n","export var quotationsReducer = (state = [], action) => {\n  switch (action.type){\n    case 'ADD_QUOTATIONS':\n      return [\n        ...state,\n        ...action.quotations\n      ];\n    case 'ADD_QUOTATIONS':\n      return [\n        ...state,\n        ...action.quotations\n      ];\n    case 'CLEAR_QUOTATIONS':\n      return [];\n    case 'START_QUOTATIONS_FETCH':\n      //return [];\n      return \"fetching\";\n    case 'COMPLETE_QUOTATIONS_FETCH':\n      return action.quotations.map((quotation)=>{\n        return {\n          id: quotation.quotation.value,\n          quotation: quotation.quotation_text.value,\n          title: quotation.toplevel_expression_title.value,\n          author: quotation.author_title.value,\n          focused: false,\n          isInstanceOf: quotation.isInstanceOf ? quotation.isInstanceOf.value : null,\n          source: quotation.source ? quotation.source.value : null,\n          citation: quotation.citation ? quotation.citation.value : null,\n          refText: quotation.refText ? quotation.refText.value : null,\n          refType: quotation.refType ? quotation.refType.value.split(\"/resource/\").reverse()[0] : null,\n        }\n      });\n    case 'CHANGE_QUOTATIONS_FOCUS':\n      var updatedState = state.map((quotation) =>{\n        if (quotation.id === action.id){\n          return{\n            ...quotation,\n            focused: true\n          }\n        }\n        else{\n          return{\n            ...quotation,\n            focused: false\n          }\n        }\n      });\n      return [\n        ...updatedState,\n      ];\n    default:\n      return state;\n  };\n};\n","export var focusedQuotationReducer = (state = {}, action) => {\n  switch (action.type){\n    case 'CREATE_FOCUSED_QUOTATION':\n      return action.quotation;\n    case 'CLEAR_FOCUSED_QUOTATION':\n      return {}\n    default:\n      return state;\n  };\n};\n","export var canonicalQuotationReducer = (state = {}, action) => {\n  switch (action.type){\n    case 'CREATE_CANONICAL_QUOTATION':\n      return action.quotation;\n    case 'CLEAR_CANONICAL_QUOTATION':\n      return null;\n    default:\n      return state;\n  };\n};\n","export var canonicalQuotationsReducer = (state = [], action) => {\n  switch (action.type){\n    case 'ADD_CANONICAL_QUOTATIONS':\n      return [\n        ...state,\n        ...action.quotations\n      ];\n    case 'CLEAR_CANONICAL_QUOTATIONS':\n      return []\n    case 'START_CANONICAL_QUOTATIONS_FETCH':\n      return []\n    case 'COMPLETE_CANONICAL_QUOTATIONS_FETCH':\n\n      return action.canonicalQuotations.map((quotation) => {\n        return {\n          id: quotation.quotation.value,\n          quotation: quotation.quotation_text.value,\n          citation: quotation.citation ? quotation.citation.value : \"citation not yet recorded\",\n          focused: false,\n        }\n      });\n    case 'CLEAR_CANONICAL_QUOTATIONS_FOCUS':\n      return state.map((quotation) => {\n        return{\n          ...quotation,\n          focused: false\n        }\n      });\n    case 'CHANGE_CANONICAL_QUOTATIONS_FOCUS':\n      var updatedState = state.map((quotation) =>{\n        if (quotation.id === action.id){\n          return{\n            ...quotation,\n            focused: true\n          }\n        }\n        else{\n          return{\n            ...quotation,\n            focused: false\n          }\n        }\n      });\n      return [\n        ...updatedState,\n      ];\n    default:\n      return state;\n  };\n};\n","/// manifestation quotations reducer\nexport var manifestationQuotationsReducer = (state = [], action) => {\n  switch (action.type){\n    case 'ADD_MANIFESTATION_QUOTATIONS':\n      return [\n        ...state,\n        ...action.quotations\n      ];\n    case 'CLEAR_MANIFESTATION_QUOTATIONS':\n      return []\n    case 'START_MANIFESTATION_QUOTATIONS_FETCH':\n      return []\n    case 'COMPLETE_MANIFESTATION_QUOTATIONS_FETCH':\n\n      return action.manifestationQuotations.map((quotation) => {\n        return {\n          id: quotation.quotation.value,\n          quotation: quotation.quotation_text.value,\n          focused: false,\n          isManifestationOf: quotation.isManifestationOf ? quotation.isManifestationOf.value : null,\n          canonicalTranscription: quotation.canonicalTranscription ? quotation.canonicalTranscription.value : null\n        }\n      });\n    case 'CLEAR_MANIFESTATION_QUOTATIONS_FOCUS':\n      return state.map((quotation) => {\n        return{\n          ...quotation,\n          focused: false\n        }\n      });\n    case 'CHANGE_MANIFESTATION_QUOTATIONS_FOCUS':\n      var updatedState = state.map((quotation) =>{\n        if (quotation.id === action.id){\n          return{\n            ...quotation,\n            focused: true\n          }\n        }\n        else{\n          return{\n            ...quotation,\n            focused: false\n          }\n        }\n      });\n      return [\n        ...updatedState,\n      ];\n    default:\n      return state;\n  };\n};\n","export var paragraphReducer = (state = {}, action) => {\n  switch (action.type){\n    case 'ADD_PARAGRAPH':\n      return action.paragraph;\n    case 'CLEAR_PARAGRAPH':\n      return {}\n    case 'START_PARAGRAPH_FETCH':\n      return {}\n    case 'COMPLETE_PARAGRAPH_FETCH':\n      return action.paragraph\n    case 'START_REVIEW_FETCH':\n      return state\n    case 'COMPLETE_REVIEW_FETCH':\n      return {\n        ...state,\n        review: action.review\n      }\n    default:\n      return state;\n  }\n};\n","export var sourceParagraphReducer = (state = {}, action) => {\n  switch (action.type){\n    case 'ADD_SOURCE_PARAGRAPH':\n      return action.sourceParagraph;\n    case 'CLEAR_SOURCE_PARAGRAPH':\n      return {}\n    case 'START_SOURCE_PARAGRAPH_FETCH':\n      return {}\n    case 'COMPLETE_SOURCE_PARAGRAPH_FETCH':\n      return action.sourceParagraph\n    case 'START_SOURCE_PARAGRAPH_REVIEW_FETCH':\n      return state\n    case 'COMPLETE_SOURCE_PARAGRAPH_REVIEW_FETCH':\n      return {\n        ...state,\n        review: action.review\n      }\n    default:\n      return state;\n  }\n};\n","// paragraphReducer\nexport var fullTextReducer = (state = {}, action) => {\n  switch (action.type){\n    case 'TOGGLE_FULL_TEXT_DISPLAY':\n      return {\n        ...state,\n        visible: !action.current\n      }\n    case 'ADD_FULL_TEXT':\n      return {\n        ...state,\n        textInfo: action.text\n      }\n    case 'CLEAR_FULL_TEXT':\n      return {\n        ...state,\n        textInfo: {}\n      }\n    case 'START_FULL_TEXT_FETCH':\n      return {\n        ...state,\n        textInfo: {}\n      }\n    case 'COMPLETE_FULL_TEXT_FETCH':\n      return {\n        ...state,\n        textInfo: action.text\n      }\n    default:\n      return state;\n  }\n};\n","\n\n\nimport {searchReducer} from '../reducers/searchReducer';\nimport {chartReducer} from \"../reducers/chartReducer\";\nimport {imagesReducer} from \"../reducers/imagesReducer\";\nimport {quotationsReducer} from \"../reducers/quotationsReducer\";\nimport {focusedQuotationReducer} from \"../reducers/focusedQuotationReducer\";\nimport {canonicalQuotationReducer} from \"../reducers/canonicalQuotationReducer\";\nimport {canonicalQuotationsReducer} from \"../reducers/canonicalQuotationsReducer\";\nimport {manifestationQuotationsReducer} from \"../reducers/manifestationQuotationsReducer\";\nimport {paragraphReducer} from \"../reducers/paragraphReducer\";\nimport {sourceParagraphReducer} from \"../reducers/sourceParagraphReducer\";\nimport {fullTextReducer} from \"../reducers/fullTextReducer\";\n\nvar redux = require('redux')\nvar thunk = require('redux-thunk').default;\n\nexport var configure = (initialState = {}) => {\n  var reducer = redux.combineReducers({\n    search: searchReducer,\n    quotations: quotationsReducer,\n    focusedQuotation: focusedQuotationReducer,\n    canonicalQuotation: canonicalQuotationReducer,\n    canonicalQuotations: canonicalQuotationsReducer,\n    manifestationQuotations: manifestationQuotationsReducer,\n    paragraph: paragraphReducer,\n    sourceParagraph: sourceParagraphReducer,\n    chart: chartReducer,\n    images: imagesReducer,\n    fullText: fullTextReducer,\n\n  })\n\n  var store = redux.createStore(reducer, initialState, redux.compose(\n    redux.applyMiddleware(thunk),\n    window.devToolsExtension ?window.devToolsExtension() : f => f\n  ));\n  return store;\n}\n","var behaviors = require('./behaviors');\nclass CETEI {\n\n    constructor(base){\n        this.els = [];\n        this.behaviors = [];\n        this.hasStyle = false;\n        this.prefixes = [];\n        if (base) {\n          this.base = base;\n        } else {\n          try {\n            if (window) {\n              this.base = window.location.href.replace(/\\/[^\\/]*$/, \"/\");\n            }\n          } catch (e) {\n            this.base = \"\";\n          }\n        }\n        this.behaviors.push(behaviors);\n        //this.shadowCSS;\n        this.supportsShadowDom = document.head.createShadowRoot || document.head.attachShadow;\n    }\n\n    // public method\n    /* Returns a Promise that fetches a TEI source document from the URL\n       provided in the first parameter and then calls the makeHTML5 method\n       on the returned document.\n     */\n    getHTML5(TEI_url, callback, perElementFn){\n        if (window.location.href.startsWith(this.base) && (TEI_url.indexOf(\"/\") >= 0)) {\n          this.base = TEI_url.replace(/\\/[^\\/]*$/, \"/\");\n        }\n        // Get TEI from TEI_url and create a promise\n        let promise = new Promise( function (resolve, reject) {\n            let client = new XMLHttpRequest();\n\n            client.open('GET', TEI_url);\n            client.send();\n\n            client.onload = function () {\n              if (this.status >= 200 && this.status < 300) {\n                resolve(this.response);\n              } else {\n                reject(this.statusText);\n              }\n            };\n            client.onerror = function () {\n              reject(this.statusText);\n            };\n        })\n        .catch( function(reason) {\n            // TODO: better error handling?\n            console.log(reason);\n        });\n\n        return promise.then((TEI) => {\n            return this.makeHTML5(TEI, callback, perElementFn);\n        });\n\n    }\n\n    /* Converts the supplied TEI string into HTML5 Custom Elements. If a callback\n       function is supplied, calls it on the result.\n     */\n    makeHTML5(TEI, callback, perElementFn){\n      // TEI is assumed to be a string\n      let TEI_dom = ( new DOMParser() ).parseFromString(TEI, \"text/xml\");\n      var doc = this.domToHTML5(TEI_dom, callback, perElementFn);\n      return this.registerTEIElements(doc, callback);\n\n    }\n\n    /* Converts the supplied TEI DOM into HTML5 Custom Elements. If a callback\n       function is supplied, calls it on the result.\n    */\n    domToHTML5(TEI_dom, callback, perElementFn){\n\n      this._fromTEI(TEI_dom);\n\n      let convertEl = (el) => {\n          // Create new element. TEI elements get prefixed with 'tei-',\n          // TEI example elements with 'teieg-'. All others keep\n          // their namespaces and are copied as-is.\n          let newElement;\n          let copy = false;\n          switch (el.namespaceURI) {\n            case \"http://www.tei-c.org/ns/1.0\":\n              newElement = document.createElement(\"tei-\" + el.tagName);\n              break;\n            case \"http://www.tei-c.org/ns/Examples\":\n              if (el.tagName == \"egXML\") {\n                newElement = document.createElement(\"teieg-\" + el.tagName);\n                break;\n              }\n            case \"http://relaxng.org/ns/structure/1.0\":\n              newElement = document.createElement(\"rng-\" + el.tagName);\n              break;\n            default:\n              newElement = document.importNode(el, false);\n              copy = true;\n          }\n          // Copy attributes; @xmlns, @xml:id, @xml:lang, and\n          // @rendition get special handling.\n          for (let att of Array.from(el.attributes)) {\n              if (!att.name.startsWith(\"xmlns\") || copy) {\n                newElement.setAttribute(att.name, att.value);\n              } else {\n                if (att.name == \"xmlns\")\n                newElement.setAttribute(\"data-xmlns\", att.value); //Strip default namespaces, but hang on to the values\n              }\n              if (att.name == \"xml:id\" && !copy) {\n                newElement.setAttribute(\"id\", att.value);\n              }\n              if (att.name == \"xml:lang\" && !copy) {\n                newElement.setAttribute(\"lang\", att.value);\n              }\n              if (att.name == \"rendition\") {\n                newElement.setAttribute(\"class\", att.value.replace(/#/g, \"\"));\n              }\n          }\n          // Preserve element name so we can use it later\n          newElement.setAttribute(\"data-teiname\", el.localName);\n          // If element is empty, flag it\n          if (el.childNodes.length == 0) {\n            newElement.setAttribute(\"data-empty\", \"\");\n          }\n          // Turn <rendition scheme=\"css\"> elements into HTML styles\n          if (el.localName == \"tagsDecl\") {\n            let style = document.createElement(\"style\");\n            for (let node of Array.from(el.childNodes)){\n              if (node.nodeType == Node.ELEMENT_NODE && node.localName == \"rendition\" && node.getAttribute(\"scheme\") == \"css\") {\n                let rule = \"\";\n                if (node.hasAttribute(\"selector\")) {\n                  //rewrite element names in selectors\n                  rule += node.getAttribute(\"selector\").replace(/([^#, >]+\\w*)/g, \"tei-$1\").replace(/#tei-/g, \"#\") + \"{\\n\";\n                  rule += node.textContent;\n                } else {\n                  rule += \".\" + node.getAttribute(\"xml:id\") + \"{\\n\";\n                  rule += node.textContent;\n                }\n                rule += \"\\n}\\n\";\n                style.appendChild(document.createTextNode(rule));\n              }\n            }\n            if (style.childNodes.length > 0) {\n              newElement.appendChild(style);\n              this.hasStyle = true;\n            }\n          }\n          // Get prefix definitions\n          if (el.localName == \"prefixDef\") {\n            this.prefixes.push(el.getAttribute(\"ident\"));\n            this.prefixes[el.getAttribute(\"ident\")] =\n              {\"matchPattern\": el.getAttribute(\"matchPattern\"),\n              \"replacementPattern\": el.getAttribute(\"replacementPattern\")};\n          }\n          for (let node of Array.from(el.childNodes)){\n              if (node.nodeType == Node.ELEMENT_NODE) {\n                  newElement.appendChild(  convertEl(node)  );\n              }\n              else {\n                  newElement.appendChild(node.cloneNode());\n              }\n          }\n          if (perElementFn) {\n            perElementFn(newElement);\n          }\n          return newElement;\n      }\n\n      return this.dom = convertEl(TEI_dom.documentElement);\n\n\n    }\n\n    registerTEIElements(doc, callback){\n\n      if (doc.registerElement) {\n        this.registerAll(this.els);\n      } else {\n        this.fallback(this.els);\n      }\n      this.done = true;\n      if (callback) {\n          callback(this.dom, this);\n      }\n      else {\n          return this.dom;\n      }\n\n    }\n\n    /* If the TEI document defines CSS styles in its tagsDecl, this method\n       copies them into the wrapper HTML document's head.\n     */\n    addStyle(doc, data) {\n      if (this.hasStyle) {\n        doc.getElementsByTagName(\"head\").item(0).appendChild(data.getElementsByTagName(\"style\").item(0).cloneNode(true));\n      }\n    }\n\n    /* If a URL where CSS for styling Shadow DOM elements lives has been defined,\n       insert it into the Shadow DOM.\n     */\n    addShadowStyle(shadow) {\n      if (this.shadowCSS) {\n        shadow.innerHTML = \"<style>\" + \"@import url(\\\"\" + this.shadowCSS + \"\\\");</style>\" + shadow.innerHTML;\n      }\n    }\n\n    /* Add a user-defined set of behaviors to CETEIcean's processing\n       workflow. Added behaviors will override predefined behaviors with the\n       same name.\n    */\n    addBehaviors(bhvs){\n      if (bhvs[\"handlers\"] || bhvs [\"fallbacks\"]) {\n        this.behaviors.push(bhvs);\n      } else {\n        console.log(\"No handlers or fallback methods found.\");\n      }\n    }\n\n    /* Sets the base URL for the document. Used to rewrite relative links in the\n       XML source (which may be in a completely different location from the HTML\n       wrapper).\n     */\n    setBaseUrl(base) {\n      this.base = base;\n    }\n\n    // \"private\" method\n    _fromTEI(TEI_dom) {\n        let root_el = TEI_dom.documentElement;\n        this.els = new Set( Array.from(root_el.getElementsByTagNameNS(\"http://www.tei-c.org/ns/1.0\", \"*\"), x => x.tagName) );\n        this.els.add(\"egXML\"); // Special casenot in TEI namespace, but needs to be handled\n        this.els.add(root_el.tagName); // Add the root element to the array\n    }\n\n    // private method\n    _insert(elt, strings) {\n      let span = document.createElement(\"span\");\n      if (strings.length > 1) {\n        if (strings[0].includes(\"<\") && strings[1].includes(\"</\")) {\n          span.innerHTML = strings[0] + elt.innerHTML + strings[1];\n        } else {\n          span.innerHTML = \"<span>\" + strings[0] + \"</span>\" + elt.innerHTML + \"<span>\" + strings[1] + \"</span>\";\n        }\n      } else {\n        if (strings[0].includes(\"<\")) {\n          span.innerHTML = strings[0] + elt.innerHTML;\n        } else {\n          span.innerHTML = \"<span>\" + strings[0] + \"</span>\" + elt.innerHTML;\n        }\n      }\n      if (span.children.length > 1) {\n        return span;\n      } else {\n        return span.children[0];\n      }\n    }\n\n    // private method\n    _template(str, elt) {\n      let result = str;\n      if (str.search(/$(\\w*)@(\\w+)/)) {\n        let re = /\\$(\\w*)@(\\w+)/g;\n        let replacements;\n        while (replacements = re.exec(str)) {\n          if (elt.hasAttribute(replacements[2])) {\n            if (replacements[1] && this[replacements[1]]) {\n              result = result.replace(replacements[0], this[replacements[1]].call(this, elt.getAttribute(replacements[2])));\n            } else {\n              result = result.replace(replacements[0], elt.getAttribute(replacements[2]));\n            }\n          }\n        }\n      }\n      return result;\n    }\n\n    tagName(name) {\n      if (name == \"egXML\") {\n        return \"teieg-\" + name;\n      } else {\n        return \"tei-\" + name;\n      }\n    }\n\n    /* Takes a template in the form of an array of 1 or 2 strings and\n       returns a closure around a function that can be called as\n       a createdCallback or applied to an individual element.\n       Called by the getHandler() and getFallback() methods\n    */\n    decorator(strings) {\n      let ceteicean = this;\n      return function (elt) {\n        let copy = [];\n        for (let i = 0; i < strings.length; i++) {\n          copy.push(ceteicean._template(strings[i], elt));\n        }\n        return ceteicean._insert(elt, copy);\n      }\n    }\n\n    /* Returns the handler function for the given element name\n       Called by registerAll().\n     */\n    getHandler(fn) {\n      for (let i = this.behaviors.length - 1; i >= 0; i--) {\n        if (this.behaviors[i][\"handlers\"][fn]) {\n          if (Array.isArray(this.behaviors[i][\"handlers\"][fn])) {\n            return this.append(this.decorator(this.behaviors[i][\"handlers\"][fn]));\n          } else {\n            return this.append(this.behaviors[i][\"handlers\"][fn]);\n          }\n        }\n      }\n    }\n\n    /* Returns the fallback function for the given element name.\n       Called by fallback().\n     */\n    getFallback(fn) {\n      for (let i = this.behaviors.length - 1; i >= 0; i--) {\n        if (this.behaviors[i][\"handlers\"][fn]) {\n          if (Array.isArray(this.behaviors[i][\"handlers\"][fn])) {\n            return this.decorator(this.behaviors[i][\"handlers\"][fn]);\n          } else {\n            return this.behaviors[i][\"handlers\"][fn];\n          }\n        }\n      }\n    }\n\n    /* Appends any element returned by the function passed in the first\n     * parameter to the element in the second parameter. If the function\n     * returns nothing, this is a no-op aside from any side effects caused\n     * by the provided function.\n     * called by getHandler() and fallback()\n     */\n    append(fn, elt) {\n      if (elt) {\n        let content = fn.call(this, elt);\n        if (content && !(elt.querySelector(\":scope > \" + content.nodeName))) {\n          if (this.supportsShadowDom) {\n            this._appendShadow(elt, content);\n          } else {\n            this._appendBasic(elt, content);\n          }\n        }\n      } else {\n        let self = this;\n        if (this.supportsShadowDom) {\n          return function() {\n            let content = fn.call(self, this);\n            if (content) {\n              self._appendShadow(this, content);\n            }\n          }\n        } else {\n          return function() {\n            let content = fn.call(self, this);\n            if (content && !(this.querySelector(\":scope > \" + content.nodeName))) {\n              self._appendBasic(this, content);\n            }\n          }\n        }\n      }\n    }\n\n    /* Private method called by append() if the browser supports Shadow DOM\n     */\n    _appendShadow(elt, content) {\n      var shadow = elt.attachShadow({mode:'open'});\n      this.addShadowStyle(shadow);\n      shadow.appendChild(content);\n    }\n\n    /* Private method called by append() if the browser does not support\n     * Shadow DOM\n     */\n    _appendBasic(elt, content) {\n      this.hideContent(elt);\n      elt.appendChild(content);\n    }\n\n    /* Registers the list of elements provided with the browser.\n       Called by makeHTML5(), but can be called independently if, for example,\n       you've created Custom Elements via an XSLT transformation instead.\n     */\n    registerAll(names) {\n      for (let name of names) {\n        let proto = Object.create(HTMLElement.prototype);\n        let fn = this.getHandler(name);\n        if (fn) {\n          proto.createdCallback = fn;\n        }\n        let prefixedName = this.tagName(name);\n        try {\n          document.registerElement(prefixedName, {prototype: proto});\n        } catch (error) {\n          console.log(prefixedName + \" couldn't be registered or is already registered.\");\n          console.log(error);\n        }\n\n      }\n    }\n\n    /* Provides fallback functionality for browsers where Custom Elements\n       are not supported.\n       Like registerAll(), this is called by makeHTML5(), but can be called\n       independently.\n    */\n    fallback(names) {\n      for (let name of names) {\n        let fn = this.getFallback(name);\n        if (fn) {\n          for (let elt of Array.from(this.dom.getElementsByTagName(this.tagName(name)))) {\n            this.append(fn, elt);\n          }\n        }\n      }\n    }\n\n    /**********************\n     * Utility functions  *\n     **********************/\n\n    /* Takes a relative URL and rewrites it based on the base URL of the\n       HTML document */\n    rw(url) {\n      if (!url.match(/^(?:http|mailto|file|\\/|#).*$/)) {\n        return this.base + url;\n      } else {\n        return url;\n      }\n    }\n\n    /* Given a space-separated list of URLs (e.g. in a ref with multiple\n       targets), returns just the first one.\n     */\n    first(urls) {\n      return urls.replace(/ .*$/, \"\");\n    }\n\n    /* Takes an element and serializes it to a string or, if the stripElt\n       parameter is set, serializes the element's content.\n     */\n    serialize(el, stripElt) {\n      let str = \"\";\n      if (!stripElt) {\n        str += \"&lt;\" + el.getAttribute(\"data-teiname\");\n        for (let attr of Array.from(el.attributes)) {\n          if (!attr.name.startsWith(\"data-\") && !([\"id\", \"lang\", \"class\"].includes(attr.name))) {\n            str += \" \" + attr.name + \"=\\\"\" + attr.value + \"\\\"\";\n          }\n          if (attr.name == \"data-xmlns\") {\n            str += \" xmlns=\\\"\" + attr.value +\"\\\"\";\n          }\n        }\n        if (el.childNodes.length > 0) {\n          str += \">\";\n        } else {\n          str += \"/>\";\n        }\n      }\n      for (let node of Array.from(el.childNodes)) {\n        switch (node.nodeType) {\n          case Node.ELEMENT_NODE:\n            str += this.serialize(node);\n            break;\n          case Node.PROCESSING_INSTRUCTION_NODE:\n            str += \"&lt;?\" + node.nodeValue + \"?>\";\n            break;\n          case Node.COMMENT_NODE:\n            str += \"&lt;!--\" + node.nodeValue + \"-->\";\n            break;\n          default:\n            str += node.nodeValue.replace(/</g, \"&lt;\");\n        }\n      }\n      if (!stripElt && el.childNodes.length > 0) {\n        str += \"&lt;/\" + el.getAttribute(\"data-teiname\") + \">\";\n      }\n      return str;\n    }\n\n    /* Wraps the content of the element parameter in a <span class=\"hide\">\n     * with display set to \"none\".\n     */\n    hideContent(elt) {\n      if (elt.childNodes.length > 0) {\n        let content = elt.innerHTML;\n        elt.innerHTML = \"\";\n        let hidden = document.createElement(\"span\");\n        hidden.setAttribute(\"style\", \"display:none;\");\n        hidden.setAttribute(\"class\", \"hide\");\n        hidden.innerHTML = content;\n        elt.appendChild(hidden);\n      }\n    }\n\n    unEscapeEntities(str) {\n      return str.replace(/&gt;/, \">\")\n                .replace(/&quot;/, \"\\\"\")\n                .replace(/&apos;/, \"'\")\n                .replace(/&amp;/, \"&\");\n    }\n\n    savePosition() {\n      localStorage.setItem(\"scroll\",window.scrollY);\n    }\n\n    restorePosition() {\n      if (localStorage.getItem(\"scroll\")) {\n        window.scrollTo(0, localStorage.getItem(\"scroll\"));\n      }\n    }\n\n    // public method\n    fromODD(){\n        // Place holder for ODD-driven setup.\n        // For example:\n        // Create table of elements from ODD\n        //    * default HTML behaviour mapping on/off (eg tei:div to html:div)\n        //    ** phrase level elements behave like span (can I tell this from ODD classes?)\n        //    * optional custom behaviour mapping\n    }\n\n\n\n}\n\n// Make main class available to pre-ES6 browser environments\ntry {\n  if (window) {\n      window.CETEI = CETEI;\n      window.unload = CETEI.savePosition;\n      window.load = CETEI.restorePosition;\n  }\n} catch (e) {\n  // window not defined;\n}\n\n\nexport default CETEI;\n"],"sourceRoot":""}